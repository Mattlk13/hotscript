/*
There should be no reason to edit this file directly.

Press Win-H for the help screen, or right-click the tray icon.

To add user-defined HotKeys,    edit : HotScriptKeys.ahk
To add user-defined HotStrings, edit : HotScriptStrings.ahk
To add user-defined variables,  edit : HotScriptVariables.ahk
To add user-defined functions,  edit : HotScriptFunctions.ahk
To override default settings,   edit : HotScriptUser.ini
To review default settings,     view : HotScriptDefault.ini (do not edit this file as it is often overwritten)

To override any default settings, copy the section header and value(s) from HotScriptDefault.ini to HotScriptUser.ini

For further information, assistance or bug-reporting, contact support at: hotscript.help@gmail.com

HotScript is copyrighted 2013-2019.
*/

#Include %A_ScriptDir%
#Hotstring EndChars `(`)`[`]`{`}`<`>`~`!`@`#`$`%`^`&`*`_`=`+`\`|`;`:`'`"`,`.`/`? `n`t
#MaxHotkeysPerInterval 500
#NoEnv
#SingleInstance force
#UseHook On
#Warn, All
#Warn, UseUnsetGlobal, OutputDebug
#Warn, UseUnsetLocal, OutputDebug
AutoTrim, off
DetectHiddenWindows, On
ListLines, off
SetBatchLines -1
SetKeyDelay, -1
SetTitleMatchMode, Regex
SetWinDelay, 250
StringCaseSense, on

;__________________________________________________
;Initialization
global hs := {}
if (!A_IsAdmin) {
	if (!(A_OSVersion ~= "i)WIN_(2000|2003|XP)")) {
		; possible fix for win10
		; RunWait, %A_WinDir%\System32\schtasks.exe /create /TN [TaskName] /TR [Path\To\MyScript.exe] OR ["c:\program files\AutoHotkey\autohotkey.exe" "PathTo\MyScript.ahk"] /RL HIGHEST /SC ONLOGON
		; https://autohotkey.com/boards/viewtopic.php?f=5&t=21434
		Run, *RunAs "%A_ScriptFullPath%",, UseErrorLevel
		if (!ErrorLevel) {
			MsgBox, 0x40030, % "Startup Error", % "Unable to launch in Admin mode.`nSome features may not work correctly..."
		}
	}
}
global $ := ""

#Include *i HotScriptVariables.ahk
#Include *i HotScriptFunctions.ahk
init()
#Include *i HotScriptStrings.ahk
#Include *i HotScriptKeys.ahk
#Include *i HotScriptIncludes.ahk
if (IsFunc("userInit")) {
	Func("userInit").()
}

;__________________________________________________
;wrapper functions
ClipWait(seconds:=0.1, mode:="1") {
	ClipWait, %seconds%, %mode%
}

ControlGet(cmd, value:="", control:="", winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	ControlGet, v, %cmd%, %value%, %control%, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

ControlGetFocus(winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	ControlGetFocus, v, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

ControlGetText(control:="", winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	ControlGetText, v, %control%, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

CoordMode(param1, param2:="") {
	CoordMode, %param1%, %param2%
}

DriveGet(cmd, value:="") {
	DriveGet, v, %cmd%, %value%
	return v
}

DriveSpaceFree(path) {
	DriveSpaceFree, v, %path%
	return v
}

EnvGet(envVarName) {
	EnvGet, v, %envVarName%
	return v
}

FileAppend(text, file, encoding:="") {
	FileAppend, %text%, %file%, %encoding%
}

FileCreateShortCut(target, lnkFile, workDir:="", args:="", desc:="", iconFile:="", shortcut:="", iconNum:="", runState:="") {
	FileCreateShortcut, %target%, %lnkFile%, %workDir%, %args%, %desc%, %iconFile%, %shortcut%, %iconNum%, %runState%
}

FileDelete(FilePattern:="") {
	FileDelete, %FilePattern%
}

FileGetAttrib(filename:="") {
	FileGetAttrib, v, %filename%
	return v
}

FileGetShortcut(linkFile, ByRef outTarget:="", ByRef outDir:="", ByRef outArgs:="", ByRef outDescription:="", ByRef outIcon:="", ByRef outIconNum:="", ByRef outRunState:="") {
	FileGetShortcut, %linkFile%, outTarget, outDir, outArgs, outDescription, outIcon, outIconNum, outRunState
}

FileGetSize(filename:="", units:="") {
	FileGetSize, v, %filename%, %units%
	return v
}

FileGetTime(filename:="", whichTime:="") {
	FileGetTime, v, %filename%, %whichTime%
	return v
}

FileGetVersion(filename:="") {
	FileGetVersion, v, %filename%
	return v
}

FileMove(sourcePattern, destPattern, flag:="") {
	FileMove, %sourcePattern%, %destPattern%, %flag%
}

FileRead(filename, options:="") {
	param := (options == "" ? "" : options . " ") . filename
	FileRead, v, %param%
	return v
}

FileReadLine(filename, lineNum) {
	FileReadLine, v, %filename%, %lineNum%
	return v
}

FileSelectFile(options:="", rootDir:="", prompt:="", filter:="") {
	FileSelectFile, v, %options%, %rootDir%, %prompt%, %filter%
	return v
}

FileSelectFolder(startingFolder:="", options:="", prompt:="") {
	FileSelectFolder, v, %startingFolder%, %options%, %prompt%
	return v
}

FormatTime(YYYYMMDDHH24MISS:="", format:="") {
	FormatTime, v, %YYYYMMDDHH24MISS%, %format%
	return v
}

GroupActivate(groupName, R:="R") {
	GroupActivate, %groupName%, %R%
}

GuiControlGet(subCommand:="", controlID:="", param4:="") {
	GuiControlGet, v, %subcommand%, %controlID%, %param4%
	return v
}

ImageSearch(ByRef outputX, ByRef outputY, x1, y1, x2, y2, imageFile) {
	ImageSearch, outputX, outputY, %x1%, %y1%, %x2%, %y2%, %imageFile%
}

IniDelete(filename, section, key:="") {
	IniDelete, %filename%, %section%, %key%
}

IniRead(filename, section:="", key:="", default:="") {
	IniRead, v, %filename%, %section%, %key%, %default%
	return v
}

IniWrite(filename, section, key, value) {
	IniWrite, %value%, %filename%, %section%, %key%
}

Input(options:="", endKeys:="", matchList:="") {
	Input, v, %options%, %endKeys%, %matchList%
	return v
}

InputBox(title:="", prompt:="", hide:="", width:="", height:="", x:="", y:="", font:="", timeout:="", default:="") {
	InputBox, v, %title%, %prompt%, %hide%, %width%, %height%, %x%, %y%, , %timeout%, %default%
	v := (ErrorLevel == 1 ? "" : v)
	return v
}

KeyWait(key) {
	KeyWait, %key%
}

MouseClickDrag(button, x1, y1, x2, y2, speed, relative:=true) {
	R := (relative ? "R" : "")
	MouseClickDrag, %button%, %x1%, %y1%, %x2%, %y2%, %speed%, %R%
}

MouseGetPos(ByRef outputX:="", ByRef outputY:="", ByRef outputWin:="", ByRef outputControl:="", mode:="") {
	MouseGetPos, outputX, outputY, outputWin, outputControl, %mode%
}

MouseMove(x, y, speed:=0, relative:=false) {
	R := (relative ? "R" : "")
	MouseMove, %x%, %y%, %speed%, %R%
}

PixelGetColor(x, y, rgb:="") {
	PixelGetColor, v, %x%, %y%, %rgb%
	return v
}

PixelSearch(ByRef outputX, ByRef outputY, x1, y1, x2, y2, colorID, variation:="", mode:="") {
	PixelSearch, outputX, outputY, %x1%, %y1%, %x2%, %y2%, %colorID%, %variation%, %mode%
}

Process(cmd, pidOrName, param3:="") {
	Process, %cmd%, %pidOrName%, %param3%
}

Progress(param1, subText:="", mainText:="", winTitle:="", fontName:="") {
	Progress, %param1%, %subText%, %mainText%, %winTitle%, %fontName%
}

Random(min:="", max:="") {
	Random, v, %min%, %max%
	return v
}

RegRead(keyName, valueName:="") {
	RegRead, v, %keyName%, %valueName%
	return v
}

RegWrite(keyName, valueName:="", value:="", valueType:="REG_SZ") {
	RegWrite, %valueType%, %keyName%, %valueName%, %value%
}

Run(target, workingDir:="", mode:="") {
	Run, %target%, %workingDir%, %mode%, pid
	WinWaitActive, ahk_pid %pid%,, 2
	if (pid != "") {
		hWnd := getHwnd("ahk_pid " . pid)
		WinActivate, ahk_id %hWnd%
	}
	return pid
}

SetTimer(label:="", mode:="", priority:=0) {
	SetTimer, %label%, %mode%, %priority%
}

Sleep(millis:=0) {
	Sleep, %millis%
}

Sort(ByRef VarName, Options) {
	Sort, VarName, %Options%
}

SoundGet(componentType:="", controlType:="", deviceNumber:="") {
	SoundGet, v, %componentType%, %controlType%, %deviceNumber%
	return v
}

SoundGetWaveVolume(deviceNumber:="") {
	SoundGetWaveVolume, v, %deviceNumber%
	return v
}

SplitPath(inputVar, ByRef outFileName:="", ByRef outDir:="", ByRef outExtension:="", ByRef outNameNoExt:="", ByRef outDrive:="") {
	SplitPath, inputVar, outFileName, outDir, outExtension, outNameNoExt, outDrive
}

StatusBarGetText(part:="", winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	StatusBarGetText, v, %part%, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

StringGetPos(inputVar, searchText, mode:="", offset:="") {
	StringGetPos, v, inputVar, %searchText%, %mode%, %offset%
	return v
}

StringLeft(inputVar, count) {
	StringLeft, v, inputVar, %count%
	return v
}

StringLen(inputVar) {
	StringLen, v, inputVar
	return v
}

StringMid(inputVar, startChar, count , l:="") {
	StringMid, v, inputVar, %startChar%, %count%, %l%
	return v
}

StringRight(inputVar, count) {
	StringRight, v, inputVar, %count%
	return v
}

StringTrimLeft(inputVar, count) {
	StringTrimLeft, v, inputVar, %count%
	return v
}

StringTrimRight(inputVar, count) {
	StringTrimRight, v, inputVar, %count%
	return v
}

Transform(cmd, value1, value2:="") {
	Transform, v, %cmd%, %value1%, %value2%
	return v
}

TrayTip(text, title:="", options:=0) {
	if (title == "") {
		title := hs.TITLE
	}
	TrayTip, % title, % text, 0, % options
}

WinGet(cmd:="", winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	WinGet, v, %cmd%, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

WinGetActiveTitle() {
	WinGetActiveTitle, v
	return v
}

WinGetClass(winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	WinGetClass, v, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

WinGetText(winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	WinGetText, v, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

WinGetTitle(winTitle:="", winText:="", excludeTitle:="", excludeText:="") {
	WinGetTitle, v, %winTitle%, %winText%, %excludeTitle%, %excludeText%
	return v
}

;__________________________________________________
;HotKey functions
hkAutomationCalculator() {
	findOrRunByExe("calc")
}

hkAutomationCharacterMap() {
	findAndRun("charmap.exe")
}

hkAutomationControlPanel() {
	runTarget("Control Panel")
}

hkAutomationDosPrompt() {
	runDos()
}

hkAutomationDosPromptInExplorer() {
	runDos(getExplorerPath())
}

hkAutomationEditor() {
	runEditor()
}

hkAutomationGoogleSearch() {
	runSelectedText()
}

hkAutomationQuickLookup() {
	runQuickLookup()
}

hkAutomationStartupFolder() {
	runTarget("explore " . A_Startup)
}

hkAutomationTempFolder() {
	runTarget("explore " . A_Temp)
}

hkAutomationUserMenu() {
	static cancelEntry := ""
	if (cancelEntry == "") {
		cancelEntry := {
			(LTrim Join Comments
				text: "&Cancel",
				iconFile: "imageres.dll",
				iconNumber: 236
			)}
	}
	userMenu := Func("userMenu").()
	userMenu.name := "InternalUserMenu"
	userMenu.entries.push("")
	userMenu.entries.push(cancelEntry)
	menuBuilder(userMenu)
}

hkAutomationWindowsExplorer() {
	hWnd := getHwnd(group("Explorer"))
	if (hWnd && !isActiveExplorer()) {
		WinActivate, ahk_id %hWnd%
	}
	else {
		runTarget("explore " . EnvGet("SystemDrive") . "\")
	}
}

hkAutomationWindowsServices() {
	runServices()
}

hkAutomationWindowsSnip() {
	findAndRun("SnippingTool.exe")
}

hkClipboardClear() {
	clipClear()
}

hkClipboardClearAll() {
	clipClearAll()
}

hkClipboardCopyAppend() {
	clipAppend()
}

hkClipboardCopyToNumClip() {
	clipSave()
	setActiveClipboard("NumClip #" . extractNumClip(), false)
	Sleep(30)
	Send, ^c
	Sleep(100)
	clipRestore()
}

hkClipboardCutAppend() {
	clipAppend(true)
}

hkClipboardPaste() {
	clipPaste()
}

hkClipboardPasteAll() {
	clipPasteAll()
}

hkClipboardPasteAsText() {
	clipPasteAsText()
}

hkClipboardPasteNumClip() {
	clipPasteNumClip()
}

hkClipboardPasteNumClipAsText() {
	clipPasteNumClip(true)
}

hkClipboardPasteEnter() {
	sendText(hs.const.EOL_WIN)
}

hkClipboardPasteTab() {
	sendText(A_Tab)
}

hkClipboardPreview() {
	clipPreview()
}

hkClipboardSwapToClipboard() {
	clipSwap()
}

hkClipboardToggleQueue() {
	clipToggleQueue()
}

hkClipboardUseMultiClip() {
	setActiveClipboard("MultiClip " . whichMultiClip())
}

hkClipboardUseNumClip() {
	setActiveClipboard("NumClip #" . extractNumClip())
}

hkClipboardUseWindowsClipboard() {
	setActiveClipboard("Windows")
}

hkCommandLineCdParent() {
	SendInput, cd ..{Enter}
}

hkCommandLineClear() {
	command := (isActiveDos() || isActivePowerShell() ? "{Escape}" : "^a^k")
	SendInput, %command%
}

hkCommandLineCopy() {
	command := (isActiveNix() ? "cp" : "copy")
	SendInput, %command%{Space}
}

hkCommandLineDownloads() {
	if (isActiveUbuntu() || isActiveSsh()) {
		; TODO: need pass-thru here
		return
	}
	else if (isActiveShell()) {
		command := "cd"
		dir := "$USERPROFILE/"
	}
	else {
		command := "pushd"
		dir := (isActivePowerShell() ? "$Env:USERPROFILE" : "%USERPROFILE%") . "\"
	}
	SendInput, %command% %dir%Downloads{Enter}
}

hkCommandLineExit() {
	SendInput, exit{Enter}
}

hkCommandLineMove() {
	command := (isActiveNix() ? "mv" : isActivePowerShell() ? "Move-Item" : "move")
	SendInput, %command%{Space}
}

hkCommandLinePopd() {
	if (isActiveShell()) {
		; TODO: need pass-thru here
		return
	}
	else {
		SendInput, popd{Enter}
	}
}

hkCommandLinePushd() {
	if (isActiveShell()) {
		; TODO: need pass-thru here
		return
	}
	else {
		SendInput, pushd{Space}
	}
}

hkCommandLineRoot() {
	slash := (isActiveNix() ? "/" : "\")
	SendInput, cd %slash%{Enter}
}

hkCommandLineScrollBottom() {
	SendInput, {Space}{Backspace}
}

hkCommandLineScrollDown() {
	scrollWindow("down")
}

hkCommandLineScrollPageDown() {
	scrollWindow("pgdn")
}

hkCommandLineScrollPageUp() {
	scrollWindow("pgup")
}

hkCommandLineScrollTop() {
	scrollWindow("top")
}

hkCommandLineScrollUp() {
	scrollWindow("up")
}

hkCommandLineStart() {
	if (isActiveDosLike()) {
		SendInput, start .{Enter}
	}
	else {
		; TODO: need pass-thru here
	}
}

hkCommandLineType() {
	command := (isActiveNix() ? "cat" : "type")
	SendInput, %command%{Space}
}

hkEppDeleteToEol() {
	SendInput, ^+{Delete}
}

hkEppGoToLine() {
	SendInput, !g
}

hkEppNextFile() {
	SendInput, {F6}
}

hkEppPrevFile() {
	SendInput, +{F6}
}

hkHotScriptEditDefaultIni() {
	runEditor(hs.config.default.file)
}

hkHotScriptEditHotScript() {
	runEditor(A_ScriptFullPath)
}

hkHotScriptEditUserFunctions() {
	runEditor(hs.file.USER_FUNCTIONS)
}

hkHotScriptEditUserIncludes() {
	runEditor(hs.file.USER_INCLUDES)
}

hkHotScriptEditUserIni() {
	runEditor(hs.config.user.file)
}

hkHotScriptEditUserKeys() {
	runEditor(hs.file.USER_KEYS)
}

hkHotScriptEditUserStrings() {
	runEditor(hs.file.USER_STRINGS)
}

hkHotScriptEditUserVariables() {
	runEditor(hs.file.USER_VARIABLES)
}

hkHotScriptMenu(name:="") {
	if (name != "Tray") {
		centerMouse("screen", false)
		; current menu is 218x264, so move by half so the menu itself is centered
		MouseMove(-109, -132, 0, "R")
	}

	menuEdit := {
		(LTrim Join Comments
			color: getMenuColor("green"),
			text: "&Edit",
			iconFile: "imageres.dll",
			iconNumber: 247,
			entries: [
				{
					handler: "hkHotScriptEditUserKeys",
					text: "Hot&Keys",
					iconFile: "msctf.dll",
					iconNumber: 24
				},
				{
					handler: "hkHotScriptEditUserStrings",
					text: "Hot&Strings",
					iconFile: "msctf.dll",
					iconNumber: 19
				},
				{
					handler: "hkHotScriptEditUserVariables",
					text: "&Variables",
					iconFile: "wscript.exe",
					iconNumber: 3
				},
				{
					handler: "hkHotScriptEditUserFunctions",
					text: "&Functions",
					iconFile: "wscript.exe",
					iconNumber: 4
				},
				{
					handler: "hkHotScriptEditUserIncludes",
					text: "&Includes",
					iconFile: "wscript.exe",
					iconNumber: 2
				},
				{
					handler: "hkHotScriptEditHotScript",
					text: "&" . hs.TITLE,
					iconFile: hs.file.ICON
				},
				"",
				{
					handler: "hkHotScriptEditUserIni",
					text: "&User configuration",
					iconFile: "imageres.dll",
					iconNumber: 170
				},
				{
					handler: "hkHotScriptEditDefaultIni",
					text: "&Default configuration",
					iconFile: "imageres.dll",
					iconNumber: 245
				}
			]
		)}

	menuHS := {
		(LTrim Join Comments
			color: getMenuColor("red"),
			text: "&" . hs.TITLE,
			iconFile: hs.file.ICON,
			entries: [
				{
					handler: "runUserManual",
					text: "&User Manual",
					iconFile: "imageres.dll",
					iconNumber: 125
				},
				{
					handler: "runHistory",
					text: "Historical &Changes",
					iconFile: "shell32.dll",
					iconNumber: 266
				},
				{
					handler: "runHomePage",
					text: "Launch &Homepage",
					iconFile: "ieframe.dll",
					iconNumber: 0
				},
				{
					handler: "runForum",
					text: "Foru&ms",
					iconFile: "imageres.dll",
					iconNumber: 75
				},
				{
					handler: "checkVersionsForce",
					text: "Check for &new version",
					iconFile: "shell32.dll",
					iconNumber: 298
				},
				"",
				{
					handler: "stop",
					text: "E&xit " . hs.TITLE,
					iconFile: "shell32.dll",
					iconNumber: 216
				}
			]
		)}

	hsMenu := {
		(LTrim Join Comments
			name: (name == "" ? "hsMenu" : name),
			entries: [
				{
					handler: "selfReload",
					text: "&Reload " . hs.TITLE,
					iconFile: "shell32.dll",
					iconNumber: 239
				},
				"",
				{
					handler: "hkHotScriptPauseHotScript",
					text: "Toggle " . hs.TITLE . "`t[" . getPauseTriState(hs.internal.hotScriptPaused, hs.internal.hotKeysPaused || hs.internal.hotStringsPaused) . "]",
					iconFile: "ActionCenterCPL.dll",
					iconNumber: (hs.internal.hotScriptPaused ? 4 : (hs.internal.hotKeysPaused || hs.internal.hotStringsPaused) ? 3 : 2)
				},
				{
					handler: "hkHotScriptPauseHotKeys",
					text: "Toggle Hot&Keys`t[" . getPauseState(hs.internal.hotKeysPaused) . "]",
					iconFile: "ActionCenterCPL.dll",
					iconNumber: (hs.internal.hotKeysPaused ? 4 : 2)
				},
				{
					handler: "hkHotScriptPauseHotStrings",
					text: "Toggle Hot&Strings`t[" . getPauseState(hs.internal.hotStringsPaused) . "]",
					iconFile: "ActionCenterCPL.dll",
					iconNumber: (hs.internal.hotStringsPaused ? 4 : 2)
				},
				"",
				{
					handler: "runHotScriptFolder",
					text: "E&xplore " hs.TITLE . " folder",
					iconFile: "shell32.dll",
					iconNumber: 127
				},
				"",
				{
					handler: "hkHotScriptShowVariable",
					text: "Show &Variable",
					iconFile: "imageres.dll",
					iconNumber: 169
				},
				;{
				;	handler: "hkHotScriptSetVariable"
				;	text: "&Set Variable"
				;},
				{
					handler: "hkHotScriptRunFunction",
					text: "Run &Function",
					iconFile: "imageres.dll",
					iconNumber: 302
				},
				{
					handler: "hkHotScriptRunDebugView",
					text: "Run &Debugger",
					iconFile: "scrobj.dll",
					iconNumber: 0
				},
				{
					handler: "runWindowSpy",
					text: "&Window Spy",
					iconFile: "imageres.dll",
					iconNumber: 140
				},
				"",
				menuHS,
				menuEdit,
				"",
				{
					handler: "showQuickHelp",
					text: "&Help screen",
					iconFile: "ieframe.dll",
					iconNumber: 87
				},
				{
					handler: "runAhkHelp",
					text: "&AutoHotkey help",
					iconFile: A_AhkPath,
					iconNumber: 0
				},
				"",
				{
					text: "&Cancel",
					iconFile: "imageres.dll",
					iconNumber: 236
				},
				"",
				{
					disabled: true,
					text: hs.TITLE . " v" . hs.VERSION . "`tAHK v" . A_AhkVersion
				}
			]
		)}
	if (IsFunc("userMenu")) {
		hsMenu.entries.InsertAt(hsMenu.entries.Length() - 3, Func("userMenu").())
	}
	menuBuilder(hsMenu)
}

hkHotScriptPauseHotKeys() {
	hs.internal.hotKeysPaused := !hs.internal.hotKeysPaused
	hkHotScriptPauseHotScript(false)
	splash("HotKeys are " . RegexReplace(getPauseState(hs.internal.hotKeysPaused), "", "") . "...")
}

hkHotScriptPauseHotScript(show:=true) {
	if (show) {
		hs.internal.hotScriptPaused := !hs.internal.hotScriptPaused
	}
	state := getPauseTriState(hs.internal.hotScriptPaused, hs.internal.hotKeysPaused || hs.internal.hotStringsPaused)
	tip := SubStr(A_IconTip, 1, InStr(A_IconTip, "-") + 1) . state
	if (show) {
		splash(hs.TITLE . " is " . state . "...")
	}
	Menu, Tray, Tip, % tip
	hkHotScriptMenu("Tray")
}

hkHotScriptPauseHotStrings() {
	hs.internal.hotStringsPaused := !hs.internal.hotStringsPaused
	if (!hs.internal.hotStringsPaused) {
		hotStringDo(hs.const.REPLACE_MODE.Reset)
	}
	hkHotScriptPauseHotScript(false)
	splash("HotStrings are " . getPauseState(hs.internal.hotStringsPaused) . "...")
}

hkHotScriptQuickHelp() {
	showQuickHelp()
}

hkHotScriptRunDebugView() {
	exe := "DbgView.exe"
	exeStr := "ahk_exe i)" . exe
	hWnd := getHwnd(exeStr)
	if (hWnd && !WinActive(exeStr)) {
		WinActivate, ahk_id %hWnd%
	}
	else {
		dvExe := findOnPath(exe)
		if (dvExe == "") {
			msg := "Unable to locate DebugView on the PATH.`n`nDebugView displays Windows debug messages, which HotScript`n(and many other programs) can generate.`n`nClick the 'Download' button to go to the website for DebugView."
			SetTimer("ChangeButtons", 30)
			; 1 + 48 + 256 = 305
			if (message(msg, "File Not Found", 305) == "OK") {
				Run("https://technet.microsoft.com/en-us/sysinternals/debugview.aspx")
			}
			return

			ChangeButtons:
				IfWinNotExist, File Not Found
					return ; keep waiting
				SetTimer("ChangeButtons", off)
				WinActivate
				ControlSetText, Button1, &Download
				ControlSetText, Button2, &Close
				return
		}
		else {
			Run(dvExe)
		}
	}
}

hkHotScriptRunFunction() {
	runFunction()
}

hkHotScriptShowVariable() {
	showVariable()
}

hkMiscCreateFile() {
	if (isActiveExplorer()) {
		createNewInExplorer("file")
	}
	else if (isActiveDesktop()) {
		createNewOnDesktop("file")
	}
	else {
		SendInput, %A_ThisHotKey%
	}
}

hkMiscCreateFolder() {
	if (isActiveExplorer()) {
		createNewInExplorer("folder")
	}
	else if (isActiveDesktop()) {
		createNewOnDesktop("folder")
	}
	else {
		SendInput, %A_ThisHotKey%
	}
}

hkMiscExplorerBack() {
	SendInput, !{Left}
}

hkMiscExplorerUpOneLevel() {
	SendInput, !{Up}
}

hkMiscMouseBack() {
	; this is temporary until HotKey() can be refactored to support multiple actions for the same HotKey but for different active windows
	if (isActiveDialog()) {
		SendInput, !{Up}
	}
	else if (isActiveExplorer()) {
		hkMiscExplorerUpOneLevel()
	}
	else if (isActiveEditPad()) {
		hkEppPrevFile()
	}
	else if (isActiveCommandLine()) {
		hkCommandLineCdParent()
	}
	else {
		SendInput, {XButton1}
	}
}

hkMiscMouseForward() {
	; this is temporary until HotKey() can be refactored to support multiple actions for the same HotKey but for different active windows
	if (isActiveDialog()) {
		SendInput, !{Left}
	}
	else if (isActiveExplorer()) {
		hkMiscExplorerBack()
	}
	else if (isActiveEditPad()) {
		hkEppNextFile()
	}
	else {
		SendInput, {XButton2}
	}
}

hkMiscToggleDesktop() {
	static shell := ComObjCreate("Shell.Application")
	shell.ToggleDesktop()
}

hkMiscToggleDesktopIcons() {
	toggleDesktopIcons()
}

hkMouseCenterMouseScreen() {
	centerMouse("screen")
}

hkMouseCenterMouseWindow() {
	if (isActiveRdp()) {
		win := getWindowInfo()
		mon := hs.vars.monitors[win.monitor]
		if (win.width != mon.width && win.height != mon.height) {
			centerMouse("window")
		}
	}
	else {
		centerMouse("window")
	}
}

hkMouseDragDown() {
	MouseClickDrag("Left", 0, 0, 0, 1, 0)
}

hkMouseDragLeft() {
	MouseClickDrag("Left", 0, 0, -1, 0, 0)
}

hkMouseDragRight() {
	MouseClickDrag("Left", 0, 0, 1, 0, 0)
}

hkMouseDragUp() {
	MouseClickDrag("Left", 0, 0, 0, -1, 0)
}

hkMouseMoveDown() {
	MouseMove(0, 1,, true)
}

hkMouseMoveLeft() {
	MouseMove(-1, 0,, true)
}

hkMouseMoveRight() {
	MouseMove(1, 0,, true)
}

hkMouseMoveUp() {
	MouseMove(0, -1,, true)
}

hkTextDeleteBlankLines() {
	deleteBlankLines()
}

hkTextDeleteCurrentLine() {
	if (isActiveEditPad()) {
		SendInput, ^!y
	}
	else if (isActiveDos() || isActivePowerShell()) {
		Send, {Esc}
	}
	else if (isActiveNix()) {
		Send, ^a^{Del}
	}
	else {
		deleteCurrentLine()
	}
}

hkTextDeleteToEol() {
	if (hs.config.user.enableHkEpp && isActiveEditPad()) {
		hkEppDeleteToEol()
	}
	else if (isActiveDos() || isActivePowerShell()) {
		SendInput, ^{End}
	}
	else if (isActiveNix()) {
		SendInput, ^k
	}
	else {
		SendInput, +{End}
		if (isActiveMSWord()) {
			SendInput, +{Left}
		}
		SendInput, {Delete}
	}
}

hkTextDeleteToSol() {
	if (isActiveDos() || isActivePowerShell()) {
		SendInput, ^{Home}
	}
	else if (isActiveNix()) {
		SendInput, ^u
	}
	else {
		SendInput, +{Home}{Delete}
	}
}

hkTextDeleteNextWord() {
	if (isActiveEditPad()) {
		SendInput, ^{Delete}
	}
	else if (WinActive("ahk_exe i)(?:p4v|SourceTree)\.exe")) {
		SendInput, ^d
	}
	else if (isActiveDos()) {
		if (isWin10()) {
			origIgnore := hs.internal.clipIgnore
			clipIgnore()
			SendInput, ^+{Right}{Enter}
			clipSleep()
			ClipWait()
			len := StrLen(Clipboard)
			if (len > 0) {
				len++
				SendInput, {Del %len%}
			}
			clipIgnore(origIgnore)
		}
		else {
			; no way to delete before Win10
		}
	}
	else if (isActivePowerShell()) {
		SendInput, ^{Del}{Del}
	}
	else if (isActiveNix()) {
		SendInput, {Esc}d{Del}
	}
	else {
		text := getSelectedText()
		; need to check for Visual Studio Code because Ctrl-C (from getSelectedText) causes the entire line to be copied if there is no selection
		; this is a temporary hack, because if text is already selected, this will not work correctly
		if (WinActive("ahk_exe i)code.exe") || text == "") {
			; this has unusual behavior... Some symbols are treated as "word" characters instead of "breaking" characters,
			; which means that they will be selected and deleted, unless they are the ending character(s).
			; Notepad	:	` ~ @ # ^ & * ) _ = ] ; : ' " , . < > /
			; Notepad++	:	_
			; EditPad	:	_
			; Word	:	'
			; IE	:	'
			; Chrome	:	_ : '
			; Firefox	:	all symbols except ` and ^ are selected, but this will not be an issue because of the handling below
			SendInput, ^+{Right}
			text := getSelectedText()
			; disabled 09/03/2017 - is this handling really needed?
			/*
			; if last char is not a word char, select one less character from the right
			while (text != "" && !isWord(SubStr(text, 0))) {
				text := SubStr(text, 1, -1)
				SendInput, +{Left}
			}
			*/
		}
		if (text != "") {
			SendInput, {Delete}
		}
	}
}

hkTextDeletePrevWord() {
	if (isActiveDos()) {
		if (isWin10()) {
			/*
			origIgnore := hs.internal.clipIgnore
			clipIgnore()
			SendInput, ^+{Left}{Enter}
			clipSleep()
			ClipWait()
			len := StrLen(Clipboard)
			if (len > 0) {
				len--
				SendInput, {Backspace %len%}
			}
			clipIgnore(origIgnore)
			*/
			; latest versions of Win10 seem to handle this correctly, so just pass-thru
			SendInput, ^{Backspace}
		}
		else {
			; no way to delete before Win10
		}
	}
	else if (isActivePowerShell()) {
		SendInput, ^{Backspace}
	}
	else if (isActiveNix()) {
		; TBD - SendInput, {Esc}d{Del}
	}
	else {
		text := getSelectedText()
		; need to check for Visual Studio Code because Ctrl-C (from getSelectedText) causes the entire line to be copied if there is no selection
		; this is a temporary hack, because if text is already selected, this will not work correctly
		if (WinActive("ahk_exe i)code.exe") || text == "") {
			; this has unusual behavior... Some symbols are treated as "word" characters instead of "breaking" characters,
			; which means that they will be selected and deleted, unless they are the ending character(s).
			; Notepad	:	` ~ @ # ^ & * ) _ = ] ; : ' " , . < > /
			; Notepad++	:	_
			; EditPad	:	_
			; Word		:	'
			; IE		:	'
			; Chrome	:	_ : '
			; Firefox	:	all symbols except ` and ^ are selected, but this will not be an issue because of the handling below
			SendInput, ^+{Left}
			text := getSelectedText()
			; disabled 09/03/2017 - is this handling really needed?
			/*
			; if first char is not a word char, select one less character from the right
			while (text != "" && !isWord(SubStr(text, 1, 1))) {
				text := SubStr(text, 2)
				SendInput, +{Right}
			}
			*/
		}
		if (text != "") {
			SendInput, {Delete}
		}
	}
}

hkTextDuplicateCurrentLineDown() {
	if (isActiveEditPad()) {
		SendInput, ^+{Up}
	}
	else {
		duplicateCurrentLine()
		SendInput, {Down}
	}
}

hkTextDuplicateCurrentLineUp() {
	if (isActiveEditPad()) {
		SendInput, ^+{Up}{Up}
	}
	else {
		duplicateCurrentLine()
	}
}

hkTextEndBackspaceDown() {
	SendInput, {End}{Backspace}{Down}
}

hkTextMoveCurrentLineDown() {
	if (isActiveEditPad()) {
		SendInput, ^!+{Down}
	}
	else if (isActiveExplorer()) {
		SendInput, !{Down}
	}
	else {
		moveCurrentLineDown()
	}
}

hkTextMoveCurrentLineUp() {
	if (isActiveEditPad()) {
		SendInput, ^!+{Up}
	}
	else if (isActiveCommandLine()) {
		hkCommandLineCdParent()
	}
	else if (isActiveExplorer()) {
		SendInput, !{Up}
	}
	else {
		moveCurrentLineUp()
	}
}

hkTextTrimLines() {
	if (isActiveEditPad()) {
		SendInput, ^!.
	}
	else {
		trimLines()
	}
}

hkTextUpEndDelete() {
	SendInput, {Up}{End}{Delete}
}

hkTransformCurlyQuotes() {
	selText := getSelectedText()
	if (selText != "") {
		replaceSelected(replaceCurlyQuotes(selText))
	}
}

hkTransformEncrypt() {
	if (isActiveExplorer()) {
		Send, ^+e
	}
	else {
		cryptSelected()
	}
}

hkTransformEscape() {
	escapeText()
}

hkTransformInvertCase() {
	transformSelected("I")
}

hkTransformLowerCase() {
	if (isActiveEditPad()) {
		SendInput, ^+l
	}
	else {
		transformSelected("L")
	}
}

hkTransformMySqlUpper() {
	upperCaseMySql()
}

hkTransformNumberPrepend() {
	if (isActiveExplorer() || isActiveBrowser()) {
		SendInput, ^+n
	}
	else {
		numberSelected()
	}
}

hkTransformNumberPrependPrompt() {
	numberSelectedPrompt()
}

hkTransformNumberStrip() {
	numberRemoveSelected()
}

hkTransformOracleUpper() {
	upperCaseOracle()
}

hkTransformReverseText() {
	transformSelected("R")
}

hkTransformSentenceCase() {
	transformSelected("S")
}

hkTransformSortAscending() {
	sortSelected("a")
}

hkTransformSortDescending() {
	sortSelected("d")
}

hkTransformSortToggleCase() {
	hs.config.user.sortCase := !hs.config.user.sortCase
	splash("Sort with Case-Sensitivity: " . (hs.config.user.sortCase ? "Yes" : "No"))
	IniWrite(hs.config.user.file, "config", "sortCase", boolToStr(hs.config.user.sortCase))
}

hkTransformSortToggleType() {
	if (isSortNatural()) {
		hs.config.user.sortType := "ASCII"
	}
	else if (isSortASCII()) {
		hs.config.user.sortType := "Random"
	}
	else {
		hs.config.user.sortType := "Natural"
	}
	splash("Sort Type: " . hs.config.user.sortType)
	IniWrite(hs.config.user.file, "config", "sortType", hs.config.user.sortType)
}

hkTransformTagify() {
	tagifySelected()
}

hkTransformTitleCase() {
	if (isActiveBrowser()) {
		SendInput, ^+t
	}
	else {
		transformSelected("T")
	}
}

hkTransformUnwrapText() {
	lineUnwrapSelected()
}

hkTransformUpperCase() {
	if (isActiveEditPad()) {
		SendInput, ^+u
	}
	else {
		transformSelected("U")
	}
}

hkTransformWrap() {
	myKey := RegexReplace(A_ThisHotKey, "[!+^#*]", "")
	isAlt := GetKeyState("Alt", "p")
	isShift := GetKeyState("Shift", "p")
	if (myKey == "9" || myKey == "0") {
		s1 := "("
		s2 := ")"
	}
	else if (myKey == "[" || myKey == "]") {
		if (isShift) {
			s1 := "{"
			s2 := "}"
		}
		else {
			s1 := "["
			s2 := "]"
		}
	}
	else if (myKey == "," || myKey == ".") {
		if (isShift) {
			s1 := "<"
			s2 := ">"
		}
		else {
			s1 := myKey
			s2 := s1
		}
	}
	else {
		if (myKey == "``") {
			s1 := (isShift ? "~" : "``")
		}
		else if (myKey == "1") {
			s1 := "!"
		}
		else if (myKey == "2") {
			s1 := "@"
		}
		else if (myKey == "3") {
			s1 := "#"
		}
		else if (myKey == "4") {
			s1 := "$"
		}
		else if (myKey == "5") {
			s1 := "%"
		}
		else if (myKey == "6") {
			s1 := "^"
		}
		else if (myKey == "7") {
			s1 := "&"
		}
		else if (myKey == "8") {
			s1 := "*"
		}
		else if (isShift) {
			if (myKey == "-") {
				s1 := "_"
			}
			else if (myKey == "=") {
				s1 := "+"
			}
			else if (myKey == "\") {
				s1 := "|"
			}
			else if (myKey == ";") {
				s1 := ":"
			}
			else if (myKey == "'") {
				s1 := """"
			}
			else if (myKey == "/") {
				s1 := "?"
			}
		}
		else {
			s1 := myKey
		}
		s2 := s1
	}
	if (isAlt) {
		wrapSelectedEach(s1, s2)
	}
	else {
		wrapSelected(s1, s2)
	}
}

hkTransformWrapText() {
	lineWrapSelected()
}

hkWindowAlwaysOnTop() {
	toggleAlwaysOnTop()
}

hkWindowCenter() {
	centerWindow()
}

hkWindowClickThrough() {
	toggleClickThrough()
}

hkWindowDecreaseTransparency() {
	setTransparency(false)
}

hkWindowHide() {
	hideWindow()
}

hkWindowHorizontalScrollLeft() {
	horizontalScroll("left")
}

hkWindowHorizontalScrollRight() {
	horizontalScroll("right")
}

hkWindowIncreaseTransparency() {
	setTransparency(true)
}

hkWindowLeft() {
	moveWindowNextPrevMonitor("", -1)
}

hkWindowMaximize() {
	maximize()
}

hkWindowMinimize() {
	minimize()
}

hkWindowMoveToEdgeBottom() {
	moveToEdge("B")
}

hkWindowMoveToEdgeLeft() {
	moveToEdge("L")
}

hkWindowMoveToEdgeRight() {
	moveToEdge("R")
}

hkWindowMoveToEdgeTop() {
	moveToEdge("T")
}

hkWindowPageDown() {
	SendInput, {PgDn}
}

hkWindowPageUp() {
	SendInput, {PgUp}
}

hkWindowResizeTo3x3_01() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_02() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_03() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_04() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_05() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_06() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_07() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_08() {
	extractLocationAndResize()
}

hkWindowResizeTo3x3_09() {
	extractLocationAndResize()
}

hkWindowResizeToAnchor() {
	isUp := GetKeyState("Up", "p")
	isDown := GetKeyState("Down", "p")
	isLeft := GetKeyState("Left", "p")
	isRight := GetKeyState("Right", "p")
	direction := (isUp ? "T" : "") . (isDown ? "B" : "") . (isLeft ? "L" : "") . (isRight ? "R" : "")
	if (direction == "B") {
		resizeTo1x2_01()
	}
	else if (direction == "T") {
		resizeTo1x2_02()
	}
	else if (direction == "L") {
		resizeTo2x1_01()
	}
	else if (direction == "R") {
		resizeTo2x1_02()
	}
	else if (direction == "BL") {
		resizeTo2x2_01()
	}
	else if (direction == "BR") {
		resizeTo2x2_02()
	}
	else if (direction == "TL") {
		resizeTo2x2_03()
	}
	else if (direction == "TR") {
		resizeTo2x2_04()
	}
}

hkWindowResizeWindowMenu() {
	moveMouseForMonitor(200, 200)
	align := "`t      "
	menu1x := {
		(LTrim Join Comments
			text: "&1 column  " . Chr(215) . " (2-4) rows",
			iconFile: "shell32.dll",
			iconNumber: 35,
			entries: [
				{
					text: "1 " . Chr(215) . " &2 grid" . align . "[100% width, 50% height]   ",
					entries: [
						{
							handler: "resizeTo1x2_02",
							text: "&2`t[Top]"
						},
						{
							handler: "resizeTo1x2_01",
							text: "&1`t[Bottom]"
						}
					]
				},
				{
					text: "1 " . Chr(215) . " &3 grid" . align . "[100% width, 33% height]   ",
					entries: [
						{
							handler: "resizeTo1x3_03",
							text: "&3`t[Top]"
						},
						{
							handler: "resizeTo1x3_02",
							text: "&2`t[Middle]"
						},
						{
							handler: "resizeTo1x3_01",
							text: "&1`t[Bottom]"
						}
					]
				},
				{
					text: "1 " . Chr(215) . " &4 grid" . align . "[100% width, 25% height]   ",
					entries: [
						{
							handler: "resizeTo1x4_04",
							text: "&4`t[Top]"
						},
						{
							handler: "resizeTo1x4_03",
							text: "&3`t[Upper-Middle]"
						},
						{
							handler: "resizeTo1x4_02",
							text: "&2`t[Lower-Middle]"
						},
						{
							handler: "resizeTo1x4_01",
							text: "&1`t[Bottom]"
						}
					]
				}
			]
		)}

	menu2x := {
		(LTrim Join Comments
			text: "&2 columns " . Chr(215) . " (1-4) rows",
			iconFile: "shell32.dll",
			iconNumber: 90,
			entries: [
				{
					text: "2 " . Chr(215) . " &1 grid" . align . "[50% width, 100% height]   ",
					entries: [
						{
							handler: "resizeTo2x1_01",
							text: "&1" . align . "[Left]"
						},
						{
							handler: "resizeTo2x1_02",
							options: "BarBreak",
							text: "&2" . align . "[Right]"
						}
					]
				},
				{
					text: "2 " . Chr(215) . " &2 grid" . align . "[50% width,   50% height]   ",
					entries: [
						{
							handler: "resizeTo2x2_03",
							text: "&3" . align . "      [Top-Left]"
						},
						{
							handler: "resizeTo2x2_01",
							text: "&1" . align . "[Bottom-Left]"
						},
						{
							handler: "resizeTo2x2_04",
							options: "BarBreak",
							text: "&4" . align . "      [Top-Right]"
						},
						{
							handler: "resizeTo2x2_02",
							text: "&2" . align . "[Bottom-Right]"
						}
					]
				},
				{
					text: "2 " . Chr(215) . " &3 grid" . align . "[50% width,   33% height]   ",
					entries: [
						{
							handler: "resizeTo2x3_05",
							text: "&5" . align . "      [Top-Left]"
						},
						{
							handler: "resizeTo2x3_03",
							text: "&3" . align . " [Middle-Left]"
						},
						{
							handler: "resizeTo2x3_01",
							text: "&1" . align . "[Bottom-Left]"
						},
						{
							handler: "resizeTo2x3_06",
							options: "BarBreak",
							text: "&6" . align . "      [Top-Right]"
						},
						{
							handler: "resizeTo2x3_04",
							text: "&4" . align . " [Middle-Right]"
						},
						{
							handler: "resizeTo2x3_02",
							text: "&2" . align . "[Bottom-Right]"
						}
					]
				},
				{
					text: "2 " . Chr(215) . " &4 grid" . align . "[50% width,   25% height]   ",
					entries: [
						{
							handler: "resizeTo2x4_07",
							text: "&7" . align . "                 [Top-Left]"
						},
						{
							handler: "resizeTo2x4_05",
							text: "&5" . align . "[Upper-Middle-Left]"
						},
						{
							handler: "resizeTo2x4_03",
							text: "&3" . align . "[Lower-Middle-Left]"
						},
						{
							handler: "resizeTo2x4_01",
							text: "&1" . align . "           [Bottom-Left]"
						},
						{
							handler: "resizeTo2x4_08",
							options: "BarBreak",
							text: "&8" . align . "                 [Top-Right]"
						},
						{
							handler: "resizeTo2x4_06",
							text: "&6" . align . "[Upper-Middle-Right]"
						},
						{
							handler: "resizeTo2x4_04",
							text: "&4" . align . "[Lower-Middle-Right]"
						},
						{
							handler: "resizeTo2x4_02",
							text: "&2" . align . "           [Bottom-Right]"
						}
					]
				}
			]
		)}

	menu3x1 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo3x1_01",
					text: "&1" . align . "[Left]"
				},
				{
					handler: "resizeTo3x1_02",
					options: "BarBreak",
					text: "&2" . align . "[Center]"
				},
				{
					handler: "resizeTo3x1_03",
					options: "BarBreak",
					text: "&3" . align . "[Right]"
				}
			]
		)}

	menu3x2 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo3x2_04",
					text: "&4" . align . "      [Top-Left]"
				},
				{
					handler: "resizeTo3x2_01",
					text: "&1" . align . "[Bottom-Left]"
				},
				{
					handler: "resizeTo3x2_05",
					options: "BarBreak",
					text: "&5" . align . "      [Top-Center]"
				},
				{
					handler: "resizeTo3x2_02",
					text: "&2" . align . "[Bottom-Center]"
				},
				{
					handler: "resizeTo3x2_06",
					options: "BarBreak",
					text: "&6" . align . "      [Top-Right]"
				},
				{
					handler: "resizeTo3x2_03",
					text: "&3" . align . "[Bottom-Right]"
				}
			]
		)}

	menu3x3 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo3x3_07",
					text: "&7" . align . "      [Top-Left]"
				},
				{
					handler: "resizeTo3x3_04",
					text: "&4" . align . "[Middle-Left]"
				},
				{
					handler: "resizeTo3x3_01",
					text: "&1" . align . "[Bottom-Left]"
				},
				{
					handler: "resizeTo3x3_08",
					options: "BarBreak",
					text: "&8" . align . "      [Top-Center]"
				},
				{
					handler: "resizeTo3x3_05",
					text: "&5" . align . "[Middle-Center]"
				},
				{
					handler: "resizeTo3x3_02",
					text: "&2" . align . "[Bottom-Center]"
				},
				{
					handler: "resizeTo3x3_09",
					options: "BarBreak",
					text: "&9" . align . "      [Top-Right]"
				},
				{
					handler: "resizeTo3x3_06",
					text: "&6" . align . "[Middle-Right]"
				},
				{
					handler: "resizeTo3x3_03",
					text: "&3" . align . "[Bottom-Right]"
				}
			]
		)}

	menu3x4 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo3x4_10",
					text: "1&0" . align . "               [Top-Left]"
				},
				{
					handler: "resizeTo3x4_07",
					text: "&7" . align . "[UpperMiddle-Left]"
				},
				{
					handler: "resizeTo3x4_04",
					text: "&4" . align . "[LowerMiddle-Left]"
				},
				{
					handler: "resizeTo3x4_01",
					text: "&1" . align . "         [Bottom-Left]"
				},
				{
					handler: "resizeTo3x4_11",
					options: "BarBreak",
					text: "1&1" . align . "               [Top-Center]"
				},
				{
					handler: "resizeTo3x4_08",
					text: "&8" . align . "[UpperMiddle-Center]"
				},
				{
					handler: "resizeTo3x4_05",
					text: "&5" . align . "[LowerMiddle-Center]"
				},
				{
					handler: "resizeTo3x4_02",
					text: "&2" . align . "         [Bottom-Center]"
				},
				{
					handler: "resizeTo3x4_12",
					options: "BarBreak",
					text: "1&2" . align . "               [Top-Right]"
				},
				{
					handler: "resizeTo3x4_09",
					text: "&9" . align . "[UpperMiddle-Right]"
				},
				{
					handler: "resizeTo3x4_06",
					text: "&6" . align . "[LowerMiddle-Right]"
				},
				{
					handler: "resizeTo3x4_03",
					text: "&3" . align . "         [Bottom-Right]"
				}
			]
		)}

	menu3x := {
		(LTrim Join Comments
			text: "&3 columns " . Chr(215) . " (1-4) rows",
			iconFile: "shell32.dll",
			iconNumber: 19,
			entries: [
				{
					text: "3 " . Chr(215) . " &1 grid" . align . "[33% width, 100% height]   ",
					entries: menu3x1
				},
				{
					text: "3 " . Chr(215) . " &2 grid" . align . "[33% width,   50% height]   ",
					entries: menu3x2
				},
				{
					text: "3 " . Chr(215) . " &3 grid" . align . "[33% width,   33% height]   ",
					entries: menu3x3
				},
				{
					text: "3 " . Chr(215) . " &4 grid" . align . "[33% width,   25% height]   ",
					entries: menu3x4
				}
			]
		)}

	menu4x1 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo4x1_01",
					text: "&1" . align . "[Left]"
				},
				{
					handler: "resizeTo4x1_02",
					options: "BarBreak",
					text: "&2" . align . "[CenterLeft]"
				},
				{
					handler: "resizeTo4x1_03",
					options: "BarBreak",
					text: "&3" . align . "[CenterRight]"
				},
				{
					handler: "resizeTo4x1_04",
					options: "BarBreak",
					text: "&4" . align . "[Right]"
				}
			]
		)}

	menu4x2 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo4x2_05",
					text: "&5" . align . "      [Top-Left]"
				},
				{
					handler: "resizeTo4x2_01",
					text: "&1" . align . "[Bottom-Left]"
				},
				{
					handler: "resizeTo4x2_06",
					options: "BarBreak",
					text: "&6" . align . "      [Top-CenterLeft]"
				},
				{
					handler: "resizeTo4x2_02",
					text: "&2" . align . "[Bottom-CenterLeft]"
				},
				{
					handler: "resizeTo4x2_07",
					options: "BarBreak",
					text: "&7" . align . "      [Top-CenterRight]"
				},
				{
					handler: "resizeTo4x2_03",
					text: "&3" . align . "[Bottom-CenterRight]"
				},
				{
					handler: "resizeTo4x2_08",
					options: "BarBreak",
					text: "&8" . align . "      [Top-Right]"
				},
				{
					handler: "resizeTo4x2_04",
					text: "&4" . align . "[Bottom-Right]"
				}
			]
		)}

	menu4x3 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo4x3_09",
					text: "&9" . align . "      [Top-Left]"
				},
				{
					handler: "resizeTo4x3_05",
					text: "&5" . align . " [Middle-Left]"
				},
				{
					handler: "resizeTo4x3_01",
					text: "&1" . align . "[Bottom-Left]"
				},
				{
					handler: "resizeTo4x3_10",
					options: "BarBreak",
					text: "1&0" . align . "      [Top-CenterLeft]"
				},
				{
					handler: "resizeTo4x3_06",
					text: "&6" . align . " [Middle-CenterLeft]"
				},
				{
					handler: "resizeTo4x3_02",
					text: "&2" . align . "[Bottom-CenterLeft]"
				},
				{
					handler: "resizeTo4x3_11",
					options: "BarBreak",
					text: "1&1" . align . "      [Top-CenterRight]"
				},
				{
					handler: "resizeTo4x3_07",
					text: "&7" . align . " [Middle-CenterRight]"
				},
				{
					handler: "resizeTo4x3_03",
					text: "&3" . align . "[Bottom-CenterRight]"
				},
				{
					handler: "resizeTo4x3_12",
					options: "BarBreak",
					text: "1&2" . align . "      [Top-Right]"
				},
				{
					handler: "resizeTo4x3_08",
					text: "&8" . align . " [Middle-Right]"
				},
				{
					handler: "resizeTo4x3_04",
					text: "&4" . align . "[Bottom-Right]"
				}
			]
		)}

	menu4x4 := {
		(LTrim Join Comments
			entries: [
				{
					handler: "resizeTo4x4_13",
					text: "1&3" . align . "                [Top-Left]"
				},
				{
					handler: "resizeTo4x4_09",
					text: "&9" . align . "[UpperMiddle-Left]"
				},
				{
					handler: "resizeTo4x4_05",
					text: "&5" . align . "[LowerMiddle-Left]"
				},
				{
					handler: "resizeTo4x4_01",
					text: "&1" . align . "         [Bottom-Left]"
				},
				{
					handler: "resizeTo4x4_14",
					options: "BarBreak",
					text: "1&4" . align . "                [Top-CenterLeft]"
				},
				{
					handler: "resizeTo4x4_10",
					text: "1&0" . align . "[UpperMiddle-CenterLeft]"
				},
				{
					handler: "resizeTo4x4_06",
					text: "&6" . align . "[LowerMiddle-CenterLeft]"
				},
				{
					handler: "resizeTo4x4_02",
					text: "&2" . align . "         [Bottom-CenterLeft]"
				},
				{
					handler: "resizeTo4x4_15",
					options: "BarBreak",
					text: "1&5" . align . "                [Top-CenterRight]"
				},
				{
					handler: "resizeTo4x4_11",
					text: "1&1" . align . "[UpperMiddle-CenterRight]"
				},
				{
					handler: "resizeTo4x4_07",
					text: "&7" . align . "[LowerMiddle-CenterRight]"
				},
				{
					handler: "resizeTo4x4_03",
					text: "&3" . align . "         [Bottom-CenterRight]"
				},
				{
					handler: "resizeTo4x4_16",
					options: "BarBreak",
					text: "1&6" . align . "               [Top-Right]"
				},
				{
					handler: "resizeTo4x4_12",
					text: "1&2" . align . "[UpperMiddle-Right]"
				},
				{
					handler: "resizeTo4x4_08",
					text: "&8" . align . "[LowerMiddle-Right]"
				},
				{
					handler: "resizeTo4x4_04",
					text: "&4" . align . "         [Bottom-Right]"
				}
			]
		)}

	menu4x := {
		(LTrim Join Comments
			text: "&4 columns " . Chr(215) . " (1-4) rows",
			iconFile: "shell32.dll",
			iconNumber: 277,
			entries: [
				{
					text: "4 " . Chr(215) . " &1 grid" . align . "[25% width, 100% height]   ",
					entries: menu4x1
				},
				{
					text: "4 " . Chr(215) . " &2 grid" . align . "[25% width,   50% height]   ",
					entries: menu4x2
				},
				{
					text: "4 " . Chr(215) . " &3 grid" . align . "[25% width,   33% height]   ",
					entries: menu4x3
				},
				{
					text: "4 " . Chr(215) . " &4 grid" . align . "[25% width,   25% height]   ",
					entries: menu4x4
				}
			]
		)}

	resMenu := {
		(LTrim Join Comments
			handler: "setResolution",
			text: "Set &Resolution",
			entries: deepCopy(hs.config.user.options.resolutions)
		)}
	resMenu.entries.insert("")
	resMenu.entries.insert("&Custom")

	scrollLockStatus := (GetKeyState("ScrollLock", "T") ? "on  (move only)" : "off  (move + resize)")
	resizeMenu := {
		(LTrim Join Comments
			name: "resizeMenu",
			entries: [
				{
					disabled: true,
					text: "ScrollLock: " . scrollLockStatus
				},
				"",
				menu1x,
				menu2x,
				menu3x,
				menu4x,
				"",
				{
					text: "&Move to Edge",
					entries: [
						{
							disabled: true,
							text: " "
						},
						{
							handler: "hkWindowMoveToEdgeLeft",
							text: "&Left"
						},
						{
							handler: "hkWindowMoveToEdgeTop",
							options: "BarBreak",
							text: "   &Top"
						},
						{
							handler: "hkWindowCenter",
							text: " &Center"
						},
						{
							handler: "hkWindowMoveToEdgeBottom",
							text: "&Bottom"
						},
						{
							disabled: true,
							options: "BarBreak",
							text: "  "
						},
						{
							handler: "hkWindowMoveToEdgeRight",
							text: "&Right"
						}
					]
				},
				{
					text: "&Stretch to Edge",
					entries: [
						{
							disabled: true,
							text: " "
						},
						{
							handler: "hkWindowStretchToEdgeLeft",
							text: "&Left"
						},
						{
							handler: "hkWindowStretchToEdgeTop",
							options: "BarBreak",
							text: "   &Top"
						},
						{
							disabled: true,
							text: "  "
						},
						{
							handler: "hkWindowStretchToEdgeBottom",
							text: "&Bottom"
						},
						{
							disabled: true,
							options: "BarBreak",
							text: "   "
						},
						{
							handler: "hkWindowStretchToEdgeRight",
							text: "&Right"
						}
					]
				},
				"",
				{
					handler: "resizeToHeight",
					text: "Max &Height"
				},
				{
					handler: "resizeToWidth",
					text: "Max &Width"
				},
				"",
				resMenu,
				"",
				"&Cancel"
			]
		)}
	menuBuilder(resizeMenu)
}

hkWindowRestoreHidden() {
	restoreHiddenWindows()
}

hkWindowRight() {
	moveWindowNextPrevMonitor("", 1)
}

hkWindowShiftWindowDown() {
	shiftWindow("down")
}

hkWindowShiftWindowLeft() {
	shiftWindow("left")
}

hkWindowShiftWindowRight() {
	shiftWindow("right")
}

hkWindowShiftWindowUp() {
	shiftWindow("up")
}

hkWindowShowInfo() {
	showWindowInfo()
}

hkWindowStretchToEdgeBottom() {
	stretchToEdge("bottom")
}

hkWindowStretchToEdgeLeft() {
	stretchToEdge("left")
}

hkWindowStretchToEdgeRight() {
	stretchToEdge("right")
}

hkWindowStretchToEdgeTop() {
	stretchToEdge("top")
}

hkWindowToggleMinimized() {
	toggleMinimized()
}

hkWindowToggleTransparency() {
	toggleTransparency()
}

hkWindowZoomWindow() {
	zoomStart()
}

;__________________________________________________
;HotString functions
hsAliasBackInX() {
	sendText("Back in " . $.value(1) . " minutes...")
}

hsCodeBlock() {
	SendInput, ^{Left}
	; TODO - in Eclipse, this really doesn't work right (and not just Eclipse, other editors like IntelliJ and VS Code)
	; need to debug what indent and indent1 are...
	; why doesn't "text" get pasted?
;	text := getSelectedText()
;	if (StrLen(text) == 1) {
;		SendInput, ^{Left}
;	}
	indent := getIndent()
	indent1 := getIndent1(indent)
	text =
	(LTrim
		`) {
		%indent%%indent1%
		%indent%}
	)
	sendText(text, "{Up 2}{End}{Left 3}")
;	sendText(text, "")
}

hsCodeElseIf() {
	indent := getIndent()
	indent1 := getIndent1(indent)
	text =
	(LTrim
		else if `(`) {
		%indent%%indent1%
		%indent%}
	)
	sendText(text, "{Up 2}{End}{Left 3}")
}

hsCodeFunction() {
	trigger := StrReplace($.value(0), "func", "function")
	indent := getIndent()
	indent1 := getIndent1(indent)
	text =
	(LTrim
		%trigger%`) {
		%indent%%indent1%
		%indent%}
	)
	sendText(text, "{Up 2}{End}{Left 3}")
}

hsCodeIfElse() {
	indent := getIndent()
	indent1 := getIndent1(indent)
	text =
	(LTrim
		if `(`) {
		%indent%%indent1%
		%indent%}
		%indent%else {
		%indent%%indent1%
		%indent%}
	)
	sendText(text, "{Up 5}{End}{Left 3}")
}

hsCodeStringFormat() {
	sendText("String.format("""", );", "{Left 5}")
}

hsCodeSwitch() {
	SendInput, ^{Left}
	indent := getIndent()
	indent1 := getIndent1(indent)
	text =
	(LTrim
		`) {
		%indent%%indent1%case x:
		%indent%%indent1%%indent1%break;
		%indent%%indent1%default:
		%indent%%indent1%%indent1%break;
		%indent%}
	)
	sendText(text, "{Up 5}{End}{Left 3}")
}

hsCodeSysOut() {
	sendText("System.out.println("""");", "{Left 3}")
}

hsCodeToken() {
	sendText("}", "{Left}")
}

hsCommandLineCd() {
	if (isActiveDos()) {
		pasteText("/d ")
	}
	else if (isActivePowerShell()) {
		SendInput, {Backspace 3}
		pasteText("Set-Location ")
	}
}

hsCommandLineRd() {
	if (isActiveDos()) {
		pasteText("/s ")
	}
	else if (isActivePowerShell()) {
		SendInput, {Backspace 3}
		pasteText("Remove-Item -Recurse ")
	}
	else if (isActiveNix()) {
		SendInput, {Backspace 2}
		pasteText("m -rf ")
	}
}

hsCommentHeaderPerl() {
	line := hs.const.COMMENT_HEADER_LINE
	indent := getIndent()
	text =
	(LTrim
		# %line%
		%indent%#%indent1%
		%indent%# %line%
	)
	sendText(text, "{Up}{End}")
}

hsCommentHeaderSql() {
	line := hs.const.COMMENT_HEADER_LINE
	indent := getIndent()
	text =
	(LTrim
		-- %line%
		%indent%--%indent1%
		%indent%-- %line%
	)
	sendText(text, "{Up}{End}")
}

hsDivPercent() {
	sendText(Round(($.value(1) / $.value(2)) * 100) . "%")
}

hsFraction() {
	n := $.value(1)
	d := $.value(2)
	if (n == 1 && d == 8) {
		frac := Chr(0x215B)
	}
	else if (n == 1 && d == 6) {
		frac := Chr(0x2159)
	}
	else if (n == 1 && d == 5) {
		frac := Chr(0x2155)
	}
	else if (n == 1 && d == 4) {
		frac := Chr(0x00BC)
	}
	else if (n == 1 && d == 3) {
		frac := Chr(0x2153)
	}
	else if (n == 3 && d == 8) {
		frac := Chr(0x215C)
	}
	else if (n == 2 && d == 5) {
		frac := Chr(0x2156)
	}
	else if (n == 1 && d == 2) {
		frac := Chr(0x00BD)
	}
	else if (n == 5 && d == 8) {
		frac := Chr(0x215D)
	}
	else if (n == 3 && d == 5) {
		frac := Chr(0x2157)
	}
	else if (n == 2 && d == 3) {
		frac := Chr(0x2154)
	}
	else if (n == 3 && d == 4) {
		frac := Chr(0x00BE)
	}
	else if (n == 4 && d == 5) {
		frac := Chr(0x2158)
	}
	else if (n == 5 && d == 6) {
		frac := Chr(0x215A)
	}
	else if (n == 7 && d == 8) {
		frac := Chr(0x215E)
	}
	else {
		frac := "<sup>" . n . "</sup>&frasl;<sub>" . d . "</sub>"
	}
	sendText(frac . $.value(3))
}

hsJiraCode(type) {
	if (startsWith(type, "{")) {
		type := SubStr(type, 2)
	}
	type1 := setCase(type, "L")
	type2 := setCase(type, "S")
	if (type == "code") {
		type1 := ""
	}
	else if (type == "js") {
		type2 := "JavaScript"
		type1 := setCase(type2, "L")
	}
	else if (type == "py") {
		type2 := "Python"
		type1 := setCase(type2, "L")
	}
	else if (type == "sql" || type == "xml") {
		type2 := setCase(type2, "U")
	}
	text = `
	(Join`r`n
		{code:${type1}title=${type2} snippet|${format}}
		{code}
	)
	tokens := {type1:type1 . (type1 == "" ? "" : "|"), type2:type2, format:hs.config.user.jiraPanels.format}
	pasteTemplate(new Template().text(text).trimLeft().tokens(tokens).keys("{Home}"))
}

hsJiraColor() {
	sendText(":}{color}", "{Left 8}")
}

hsJiraNoFormat() {
	text =
	(LTrim
		ormat}
		{noformat}
	)
	sendText(text, "{Home}")
}

hsJiraPanel(type) {
	if (startsWith(type, "{")) {
		type := SubStr(type, 2)
	}
	if (type == "pan") {
		panelFormat := hs.config.user.jiraPanels.format
	}
	else {
		color := SubStr(type, 1, 1)
		if (color == "b") {
			color := "Blue"
		}
		else if (color == "g") {
			color := "Green"
		}
		else if (color == "r") {
			color := "Red"
		}
		else if (color == "y") {
			color := "Yellow"
		}
		panel := "format" . color
		panelFormat := hs.config.user.jiraPanels[panel]
	}
	text = `
	(Join`r`n
		{panel:title=Title|${format}}
		{panel}
	)
	tokens := {format:panelFormat}
	pasteTemplate(new Template().text(text).trimLeft().tokens(tokens).keys("{Home}"))
}

hsJiraQuote() {
	text =
	(LTrim
		te}
		{quote}
	)
	sendText(text, "{Home}")
}

hsJiraSpecialPanel(type) {
	if (startsWith(type, "{")) {
		type := SubStr(type, 2)
	}
	text = `
	(Join`r`n
		:title=${title} Title}
		{${type}}
	)
	tokens := {type:type, title:setCase(type, "S")}
	pasteTemplate(new Template().text(text).trimLeft().tokens(tokens).keys("{Home}"))
}

hsJiraTable() {
	text =
	(Join`r`n
		|| Column1 || Column2 || Column3 || Column4 || Column5 ||
		| Row1_1 | Row1_2 | Row1_3 | Row1_4 | Row1_5 |
	)
	text := RegExReplace(text, hs.const.EOL_NIX, hs.const.EOL_WIN)
	pasteTemplate(new Template().text(text).trimLeft().keys("{Home}{Up}{Right 3}^+{Right}"))
}

hsPercentOf() {
	result := ($.value(1) / 100) * $.value(2)
	while (endsWith(result, "0")) {
		result := StringTrimRight(result, 1)
	}
	if (endsWith(result, ".")) {
		result := StringTrimRight(result, 1)
	}
	sendText(result)
}

hsRepeatString($) {
	sendText(repeatStr($.value(1), $.value(2)))
}

hsUnicode() {
	sendText(Chr("0x" . $.value(1)))
}

;__________________________________________________
;internal functions
addHotKey() {
	hs.config.user.hkSessionCount++
	hs.config.user.hkTotalCount++
	IniWrite(hs.config.user.file, "config", "hkTotalCount" . hs.vars.uniqueId, hs.config.user.hkTotalCount)
}

addHotString() {
	hs.config.user.hsSessionCount++
	hs.config.user.hsTotalCount++
	IniWrite(hs.config.user.file, "config", "hsTotalCount" . hs.vars.uniqueId, hs.config.user.hsTotalCount)
}

addMissingVariables() {
	doUpdate := false
	hsVars := FileRead(hs.file.USER_VARIABLES)
	if (contains(hsVars, "MY_ADDRESS")) {
		hsVars := RegexReplace(hsVars, "\bMY_ADDRESS\b", "MY_HOME_ADDRESS")
		doUpdate := true
	}
	if (!endsWith(hsVars, hs.const.EOL_WIN)) {
		hsVars .= hs.const.EOL_WIN
	}
	for key, value in hs.internal.defaultMyVars {
		if (!contains(hsVars, "global MY_" . key)) {
			tmpQ := (contains(value, """") ? "" : """")
			comment := ""
			if (key == "PASSWORD") {
				comment := "  `; this is encrypted using Ctrl-Shift-E (delete this comment after editing the value)"
			}
			hsVars .= "global MY_" . key . " := " . tmpQ . value . tmpQ . comment . hs.const.EOL_WIN
			doUpdate := true
		}
	}
	if (doUpdate) {
		FileDelete(hs.file.USER_VARIABLES)
		FileAppend(hsVars, hs.file.USER_VARIABLES)
		selfReload(true)
	}
}

addQuickLookup(title, action, position:="first") {
	position := setCase(position, "L")
	entry := title . hs.const.EOL_NIX . action . hs.const.EOL_NIX
	if (action == "last") {
		hs.config.user.quickLookupSites .= entry
	}
	else {
		hs.config.user.quickLookupSites := entry . hs.config.user.quickLookupSites
	}
}

arrangeToGrid(winMatch, dimension, sortByTitle:=true) {
	static allPositions := {
		(LTrim Comments Join,
			1x2: [2, 1]
			1x3: [3, 2, 1]
			1x4: [4, 3, 2, 1]
			2x1: [1, 2]
			2x2: [3, 4, 1, 2]
			2x3: [5, 6, 3, 4, 1, 2]
			2x4: [7, 8, 5, 6, 3, 4, 1, 2]
			3x1: [1, 2, 3]
			3x2: [4, 5, 6, 1, 2, 3]
			3x3: [7, 8, 9, 4, 5, 6, 1, 2, 3]
			3x4: [10, 11, 12, 7, 8, 9, 4, 5, 6, 1, 2, 3]
			4x1: [1, 2, 3, 4]
			4x2: [5, 6, 7, 8, 1, 2, 3, 4]
			4x3: [9, 10, 11, 12, 5, 6, 7, 8, 1, 2, 3, 4]
			4x4: [13, 14, 15, 16, 9, 10, 11, 12, 5, 6, 7, 8, 1, 2, 3, 4]
		)}
	if (!RegexMatch(Trim(dimension), "^(\d)x(\d)$", dimCount)) {
		message("The dimension must be in the format of 'CxR' (Columns and Rows).", "Invalid dimension", 48)
	}
	columns := dimCount1
	rows := dimCount2
	if (columns < 1) {
		columns := 1
	}
	else if (columns > 4) {
		columns := 4
	}
	if (rows < 1) {
		rows := 1
	}
	else if (rows > 4) {
		rows := 4
	}
	gridPositions := (columns * rows)
	monitors := hs.vars.monitors.MaxIndex()
	availablePositions := (gridPositions * monitors)
	if (IsObject(winMatch)) {
		winList := winMatch
	}
	else {
		WinGet, matchList, List, % winMatch
		winList := (sortByTitle ? {} : [])
		Loop, % matchList {
			hWnd := matchList%A_Index%
			if (isWindowVisible(hWnd)) {
				WinGetTitle, title, ahk_id %hWnd%
				if (sortByTitle) {
					winList[title] := hWnd
				}
				else {
					winList.push(hWnd)
				}
			}
		}
	}
	winCount := getSize(winList)
	if (winCount > 0) {
		if (winCount == 1) {
			for key, hWnd in winList {
				maximize(hWnd)
			}
		}
		else {
			positions := allPositions[(dimension)]
			curMonitor := 1
			curPosition := 1
			idx := 1
			msg := ""
			for key, hWnd in winList {
				if (idx <= availablePositions) {
					WinActivate, ahk_id %hWnd%
					whichMonitor := getMonitorForWindow(hWnd)
					if (whichMonitor <> curMonitor) {
						moveToMonitor(hWnd, curMonitor)
					}
					func := Func("resizeTo" . dimension . "_" . pad(positions[curPosition], 2, "0", "L"))
					func.call()
					curPosition++
					if (Mod(idx, gridPositions) == 0) {
						curMonitor++
						curPosition := 1
					}
					idx++
				}
				else {
					break
				}
			}
		}
	}
}

arrayToList(arr, delim:=",", trim:="") {
	delim := (delim == "" ? "," : delim)
	arrList := ""
	for key, val in arr {
		arrList .= val . delim
	}
	return StringTrimRight(arrList, 1)
}

ask(title, prompt, width:=250, rows:=1, defaultValue:="") {
	field := new FormField().name("simpleInput").rows(rows).default(defaultValue).label(prompt)
	askForm := new Form().horizontal(false).fields([field]).inputWidth(width).title(title)
	tokens := buildForm(askForm)
	if (tokens) {
		return tokens.simpleInput
	}
}

balloonTipHide(hWnd) {
	DllCall("SendMessage", "Ptr", hWnd, "UInt", hs.const.EM.HIDEBALLOONTIP, "Ptr", 0, "Ptr", 0, "Ptr")
}

balloonTipShow(hWnd, title, text, icon:=0) {
	static icons := {0: 0, 1: 1, 2: 2, 3: 3, NONE: 0, INFO: 1, WARN: 2, WARNING: 2, ERROR: 3}
	NumPut(VarSetCapacity(balloonTip, 4 * A_PtrSize, 0), balloonTip, 0, "UInt")
	icon := (!icons.HasKey(icon) ? 0 : setCase(icon, "U"))
	NumPut(&title, balloonTip, A_PtrSize, "Ptr")
	NumPut(&text, balloonTip, A_PtrSize * 2, "Ptr")
	NumPut(icons[icon], balloonTip, A_PtrSize * 3, "UInt")
	DllCall("SendMessage", "Ptr", hWnd, "UInt", hs.const.EM.SHOWBALLOONTIP, "Ptr", 0, "Ptr", &balloonTip, "Ptr")
}

between(value, low, high) {
	return (value >= low && value <= high)
}

bgr(value) {
	color := "0x" . getHexColor(value, true)
	bgrColor := ((color & 0xFF0000) >> 16) + (color & 0x00FF00) + ((color & 0x0000FF) << 16)
	return "0x" . toHex(bgrColor, 6)
}

binToHex(ByRef bytes, num:=0) {
	result := ""
	len := StrLen(bytes)
	mem := VarSetCapacity(result, len * 2)
	if (num < 1 || num > mem) {
		num := len
	}
	origFormat := A_FormatInteger
	SetFormat, Integer, Hex
	addr := &bytes
	Loop, % num {
		b := *addr
		StringTrimLeft, b, b, 2
		b := "0" . b
		StringRight, b, b, 2
		result .= b
		addr += 2
	}
	SetFormat, Integer, %origFormat%
	return result
}

boolToStr(value) {
	return (toBool(value) ? "true" : "false")
}

buildForm(form) {
	static forms := []
	static callbackForms := []
	static results := []
	static counter := 0
	customHandlers := []
	caller := getSelf(1)
	counter++
	instance := A_ThisFunc . counter
	results[instance] := -1
	form._name := instance
	if (form.__Class != "Form") {
		message(A_ThisFunc . "() must be called with a 'Form' parameter.`n`nActual parameter: " . toString(form) . getStackTraceStr(), "Invalid parameter", 16)
		return
	}
	numFields := getSize(form._fields)
	tokens := {caller: caller, numFields: numFields}
	form._origHwnd := getHwnd()
	activeMon := getMonitorForWindow()
	title := prepText(form._title, tokens)
	if (title == "") {
		title := hs.TITLE . " - Input Prompt"
	}
	lineSepHeaderHwnd := ""
	lineSepFooterHwnd := ""
	lineSepDebugHwnd := ""
	Gui, %instance%: New, % "hwndformHwnd " . form._options, % title
	if (form._color != "") {
		Gui, %instance%: Color, % form._color
	}
	form._hWnd := formHwnd
	toolTips := new GuiControlTips(formHwnd)
	Gui, %instance%: -MaximizeBox -MinimizeBox +LabelbuildForm_
	header := prepText(form._header, tokens)
	footer := prepText(form._footer, tokens)
	headerFont := fontSelect(form._headerFont, form._labelFont)
	footerFont := fontSelect(form._footerFont, form._labelFont)
	buttonFont := fontSelect(form._labelFont)
	hasSelect := false
	for k, field in form._fields {
		if (field._type == "file" || field._type == "folder") {
			hasSelect := true
			break
		}
	}
	inputWidth := getDpiSize(form._inputWidth)
	labelWidth := getDpiSize(form._labelWidth)
	fullWidth := ((form._horizontal ? labelWidth : 0) + inputWidth + 16 + (hasSelect ? 30 : 0))
	if (header != "") {
		buildFormFont(instance, headerFont)
		opts := "hwndheaderHwnd xm y+15 w" . fullWidth . " section " . form._headerAlign
		Gui, %instance%: Add, Text, % opts, % header
		Gui, %instance%: Font
		buildFormSetColor(headerHwnd, form._headerColorFg, form._headerColorBg)
		opts := "x0 y+20 section w" . inputWidth . " h1 0x4 hwndlineSepHeaderHwnd"
		Gui, %instance%: Add, Text, % opts
	}
	focus := ""
	for k, field in form._fields {
		field._formHwnd := formHwnd
		labelFont := fontSelect(field._labelFont, (field._required ? form._requiredLabelFont : ""), form._labelFont)
		inputFont := fontSelect(field._inputFont, (field._required ? form._requiredInputFont : ""), form._inputFont)
		tokens.name := field._name
		label := prepText((field._label != "" ? field._label : (form._horizontal ? setCase(field._name, "T") . ":" : "Enter a value for: ${name}")), tokens)
		if (field._type == "text") {
			buildFormFont(instance, inputFont)
			opts := field._textAlign . " hwnduiField" . A_Index
			if (form._horizontal && !field._textSpan) {
				labelOptions := " w" . labelWidth . " xm right section"
				inputOptions := opts . " w" . inputWidth . " ys"
				Gui, %instance%: Add, Text, % labelOptions, % ""
			}
			else {
				label := Trim(label, " `t`r`n")
				labelOptions := ""
				width := inputWidth + (field._textSpan && form._horizontal ? (labelWidth + 20) : 0)
				inputOptions := opts . " xm w" . width
			}
			Gui, %instance%: Add, Text, % inputOptions, % label
			fieldHwnd := % uiField%A_Index%
			buildFormSetColor(fieldHwnd, form._labelColorFg, form._labelColorBg, field._labelColorFg, field._labelColorBg)
			field._hWnd := fieldHwnd
		}
		else {
			if (form._horizontal) {
				labelOptions := "w" . labelWidth . " xm right section"
				inputOptions := "w" . inputWidth . " ys" . guiRows(field._rows)
			}
			else {
				label := Trim(label, " `t`r`n")
				labelOptions := "xm section"
				inputOptions := "xm w" . inputWidth . guiRows(field._rows)
			}
			labelOptions .= " hwnduiLabel" . A_Index
			; this is the live validate function
			inputOptions .= " gbuildFormValidate hwnduiField" . A_Index . (field._password ? " password" : "")
			inputOptions .= (field._lower ? " lowercase" : "")
			inputOptions .= (field._upper ? " uppercase" : "")
			inputOptions .= (field._sort ? " sort" : "")
			inputOptions .= (field._readOnly ? " readonly" : "")
			inputOptions .= " " . (field._wrap || field._rows == 1 ? "-" : "") . "HScroll"
			if (field._items != "" && field._default != "") {
				field._items := StrReplace(field._items, field._default, field._default . "|")
			}
			if (field._hideLabel) {
				labelText := "hidden"
				labelHwnd := 0
			}
			else {
				labelText := (field._required ? "*" : "") . label
				buildFormFont(instance, labelFont)
				Gui, %instance%: Add, Text, % labelOptions, % (field._type == "checkbox" ? "" : labelText)
				labelHwnd := % uiLabel%A_Index%
			}
			if (field._required) {
				buildFormSetColor(labelHwnd, form._labelColorFg, form._labelColorBg, form._requiredLabelColorFg, form._requiredLabelColorBg, field._labelColorFg, field._labelColorBg)
			}
			else {
				buildFormSetColor(labelHwnd, form._labelColorFg, form._labelColorBg, field._labelColorFg, field._labelColorBg)
			}
			buildFormFont(instance, inputFont)
			if (field._type == "checkbox") {
				cbOptions := (field._horizontal ? inputOptions : StrReplace(inputOptions, "xm", "xm ys"))
				buildFormFont(instance, labelFont)
				Gui, %instance%: Add, CheckBox, % cbOptions, % RegexReplace(labelText, ":$", "")
			}
			else if (field._type == "combobox") {
				Gui, %instance%: Add, ComboBox, % inputOptions, % field._items
			}
			else if (field._type == "dropdown") {
				Gui, %instance%: Add, DropDownList, % inputOptions, % field._items
			}
			else if (field._type == "edit" || field._type == "number") {
				Gui, %instance%: Add, Edit, % inputOptions
				fieldHwnd := % uiField%A_Index%
				if (field._max != "") {
					static EM_EXLIMITTEXT = 53, WM_USER = 0x400
					SendMessage, WM_USER | EM_EXLIMITTEXT, 0, % field._max,, ahk_id %fieldHwnd%
				}
				if (field._default != "") {
					GuiControl,, % fieldHwnd, % field._default
				}
			}
			else if (field._type == "listbox") {
				inputOptions .= (field._multi ? " multi" : "")
				Gui, %instance%: Add, ListBox, % inputOptions, % field._items
			}
			else if (field._type == "updown") {
				Gui, %instance%: Add, Edit, % inputOptions
				if (field._min == "") {
					; 1 less than max because of a bug with wrap
					field._min := -2147483647
				}
				if (field._max == "") {
					field._max := 2147483647
				}
				udOptions := "Range" . field._min . "-" . field._max . " wrap 0x80"
				value := (field._default != "" ? field._default : field._min <= 0 ? 0 : field._min)
				Gui, %instance%: Add, UpDown, % udOptions, % value
			}
			else if (field._type == "file" || field._type == "folder") {
				hasSelect := true
				if (field._multi && field._rows == 1) {
					inputOptions := StrReplace(inputOptions, " r1 ", " r3 ")
				}
				inputOptions .= (field._select._readOnly ? " readonly" : "")
				Gui, %instance%: Add, Edit, % inputOptions, % field._default
				if (field._type == "file") {
					dll := (field._multi ? "shell32" : "imageres")
					icon := (field._multi ? 243 : 102)
				}
				else {
					dll := "imageres"
					icon := 4
				}
				selectOptions := "x+wp yp-1 Icon-" . icon . " hwnduiSelect" . A_Index
				Gui, %instance%: Add, Picture, %selectOptions%, %dll%.dll
			}
			Gui, %instance%: Font
			fieldHwnd := % uiField%A_Index%
			if (field._required) {
				buildFormSetColor(fieldHwnd, form._inputColorFg, form._inputColorBg, form._requiredInputColorFg, form._requiredInputColorBg, field._inputColorFg, field._inputColorBg)
			}
			else {
				buildFormSetColor(fieldHwnd, form._inputColorFg, form._inputColorBg, field._inputColorFg, field._inputColorBg)
			}
			field._hWnd := fieldHwnd
			; this is the non-live validatation, different than the "g" one set above
			validateFunc := Func("buildFormValidate").Bind(form._fields[A_Index])
			GuiControl, %instance%: +g, % field._hWnd, %validateFunc%
			if (field._type == "file" || field._type == "folder") {
				selectHwnd := % uiSelect%A_Index%
				doPrompt := ObjBindMethod(field._select, "prompt", fieldHwnd, field._multi)
				GuiControl, %instance%: +g, % selectHwnd, % doPrompt
			}
			if (field._cue != "") {
				setInputCue(field._hWnd, field._cue, field._cueOnFocus)
			}
			if (field._toolTip != "") {
				toolTips.Attach(field._hWnd, field._toolTip)
			}
			if (form._focus == A_Index) {
				focus := field._hWnd
			}
		}
	}
	hasButtons := (form.buttonCount() > 0)
	if (numFields > 1 && hasButtons) {
		opts := "x0 y+20 section w" . inputWidth . " h1 0x4 hwndlineSepFooterHwnd"
		Gui, %instance%: Add, Text, % opts
	}
	if (footer != "") {
		buildFormFont(instance, footerFont)
		opts := "hwndFooterHwnd xm w" . fullWidth . " section " . form._footerAlign
		Gui, %instance%: Add, Text, % opts, % footer
		buildFormSetColor(footerHwnd, form._footerColorFg, form._footerColorBg)
	}
	if (form._debug) {
		Gui, %instance%: Font
		opts := "x0 y+20 section w" . inputWidth . " h1 0x4 hwndlineSepDebugHwnd"
		Gui, %instance%: Add, Text, % opts
		opts := "xm w" . fullWidth . " section"
		calledBy := "Instance: " . instance . " (" . form._hWnd . ")`t" . prepText("Called by: ${caller}()", tokens)
		Gui, %instance%: Font, s10 bold cFFFFFF
		Gui, Add, Progress, % opts . " BackgroundFF3333"
		Gui, Add, Text, % opts . " BackgroundTrans xp yp", % calledBy
		Gui, %instance%: Font, norm cBlue, Consolas
		fieldList := ""
		Loop, % numFields {
			fieldList .= "Field " A_Index . " - ${" . form._fields[A_Index]._name . "}`n"
		}
		opts .= " w" . fullWidth . " r" . (numFields > 8 ? 8 : numFields) . " readonly"
		Gui, %instance%: Add, Edit, % opts, % Trim(fieldList, "`n")
	}
	if (hasButtons) {
		buildFormFont(instance, buttonFont)
		buttonHwnds := []
		if (form._showOK) {
			Gui, %instance%: Add, Button, section xm y+15 hwndokButtonHwnd gbuildForm_OK default, &OK
			buttonHwnds.push(okButtonHwnd)
		}
		Loop, % form._buttons.MaxIndex() {
			if (!Mod(A_Index, 2)) {
				continue
			}
			name := form._buttons[A_Index]
			handler := form._buttons[A_Index + 1]
			customhandlers[name] := handler
			options := (!form._showOK && A_Index == 1 ? "section xm y+15 default" : "ys")
			Gui, %instance%: Add, Button, %options% hwndButton%A_Index%Hwnd gbuildForm_Custom, %name%
			btnHwnd := % Button%A_Index%Hwnd
			buttonHwnds.push(btnHWnd)
		}
		if (form._showCancel) {
			Gui, %instance%: Add, Button, ys hwndcancelButtonHwnd gbuildForm_Escape, &Cancel
			buttonHwnds.push(cancelButtonHwnd)
		}
		centerControls(title, instance,,,, buttonHwnds*)
	}
	Gui, %instance%: Font
	Gui, %instance%: Show, autosize center
	centerWindow(, activeMon)
	WinGetPos, winX, winY, winW, winH, %title%
	if (lineSepHeaderHwnd != "") {
		GuiControl, Move, %lineSepHeaderHwnd%, x0 w%winW%
	}
	if (lineSepFooterHwnd != "") {
		GuiControl, Move, %lineSepFooterHwnd%, x0 w%winW%
	}
	if (lineSepDebugHwnd != "") {
		GuiControl, Move, %lineSepDebugHwnd%, x0 w%winW%
	}
	if (focus != "") {
		ControlFocus,, ahk_id %focus%
		Send, ^a
	}
	if (form._keys != "") {
		; Send instead of SendInput because the input field does not get colored correctly using CtrlColors
		Send, % form._keys
	}
	if (!hasButtons) {
		; Send instead of SendInput because the input field does not get colored correctly using CtrlColors
		Send, ^{Home}
		callbackForms[instance] := form
	}
	else {
		forms[instance] := form
	}
	showFunc := form._onShow
	if (showFunc != "" && IsFunc(showFunc)) {
		if (!IsObject(showFunc)) {
			showFunc := Func(showFunc).Bind(form)
		}
		showFunc.call()
	}
	if (!hasButtons) {
		return
	}
	while (results[instance] == -1) {
		Sleep(100)
	}
	WinActivate, % "ahk_id " . form._origHwnd
	if (results[instance]) {
		result := {}
		for k, field in form._fields {
			ctrlHwnd := field._hWnd
			toolTips.Detach(ctrlHwnd)
			if (field._type == "edit" && field._rows > 1) {
				ControlGetText, value,, ahk_id %ctrlHwnd%
			}
			else {
				GuiControlGet, value,, %ctrlHwnd%
			}
			if (field._type == "checkbox") {
				value := boolToStr(value)
			}
			else if (field._type == "file" || field._type == "folder") {
				value := field._select.getValue(ctrlHwnd)
			}
			result[field._name] := value
		}
		submitFunc := form._onSubmit
		if (submitFunc != "" && IsFunc(submitFunc)) {
			if (!IsObject(submitFunc)) {
				submitFunc := Func(submitFunc).Bind(form, result)
			}
			submitFunc.call()
		}
		ErrorLevel := 0
	}
	else {
		cancelFunc := form._onCancel
		if (cancelFunc != "" && IsFunc(cancelFunc)) {
			if (!IsObject(cancelFunc)) {
				cancelFunc := Func(cancelFunc).Bind(form)
			}
			cancelFunc.call()
		}
		result := false
		ErrorLevel := 1
	}
	for k, v in results {
		if (k == instance) {
			results.Delete(k)
			break
		}
	}
	for k, field in form._fields {
		CtrlColors.detach(field._hWnd)
	}
	for k, v in forms {
		if (k == instance) {
			forms.Delete(k)
			break
		}
	}
	Gui, %instance%: Destroy
	return result

	buildForm_Close:
	buildForm_Escape:
		buildFormClose(A_Gui, callbackForms[A_Gui], results)
		for k, v in callbackForms {
			if (k == A_Gui) {
				callbackForms.Delete(k)
				break
			}
		}
		return

	buildForm_OK:
		buildFormOK(A_Gui, forms[A_Gui], results)
		return

	buildForm_Custom:
		handler := customHandlers[A_GuiControl]
		; the user can do validation in the same manner as is done within buildFormOK; just iterate over the form.fields
		buildFormCustom(handler, A_Gui, forms[A_Gui], results)
		return
}

buildFormClose(gui, theForm, results) {
	Gui, %gui%: Cancel
	if (IsObject(theForm)) {
		cancelFunc := theForm._onCancel
		if (cancelFunc != "" && IsFunc(cancelFunc)) {
			if (!IsObject(cancelFunc)) {
				cancelFunc := Func(cancelFunc).Bind(theForm)
			}
			cancelFunc.call()
		}
		for k, field in theForm._fields {
			CtrlColors.detach(field._hWnd)
		}
	}
	else {
		results[gui] := false
	}
}

buildFormCustom(handler, gui, theForm, results) {
	if (handler != "" && IsFunc(handler)) {
		if (!IsObject(handler)) {
			handler := Func(handler).Bind(theForm)
		}
		result := handler.call()
		if (result) {
			buildFormOK(gui, theForm, results, false)
		}
	}
}

buildFormOK(gui, theForm, results, doValidate:=true) {
	if (doValidate) {
		for k, field in theForm._fields {
			ctrlHwnd := field._hWnd
			if (!field.validate(false)) {
				return
			}
		}
	}
	Gui, %gui%: Cancel
	results[gui] := true
}

buildFormFont(instance, font) {
	Gui, %instance%: Font
	if (font) {
		fontOpts := font.getOptions()
		if (fontOpts != "") {
			Gui, %instance%: Font, % fontOpts
		}
		if (font._name != "") {
			Gui, %instance%: Font,, % font._name
		}
	}
}

buildFormSetColor(hWnd, fg1, bg1, fg2:="", bg2:="", fg3:="", bg3:="") {
	fg := (fg3 != "" ? fg3 : fg2 != "" ? fg2 : fg1)
	bg := (bg3 != "" ? bg3 : bg2 != "" ? bg2 : bg1)
	if (fg != "" || bg != "") {
		CtrlColors.attach(hWnd, bg, fg)
	}
}

buildFormValidate(field) {
	; this is bound to the control and fired when the value changes
	field.validate()
}

centerControls(title, guiName, hPadding:=10, vPadding:=5, spaceBetween:=30, ctrlHwnds*) {
	Gui, %guiName%: Show, Hide
	oldMode := A_TitleMatchMode
	SetTitleMatchMode, 2
	WinGetPos,,, winW,, %title%
	SetTitleMatchMode, %oldMode%
	if (winW == "") {
		splash("Unable to find window for: '" . title . "'`n`nCannot center controls...", 2000)
		return
	}
	maxWidth := 0
	maxHeight := 0
	for idx, ctrlHwnd in ctrlHwnds {
		GuiControlGet, ctrlPos, Pos, %ctrlHwnd%
		if (ctrlPosW > maxWidth) {
			maxWidth := ctrlPosW
		}
		if (ctrlPosH > maxHeight) {
			maxHeight := ctrlPosH
		}
	}
	dpiFactor := getDpiFactor()
	hPadding *= dpiFactor
	vPadding *= dpiFactor
	spaceBetween *= dpiFactor
	newWidth := maxWidth + hPadding
	newHeight := maxHeight + vPadding
	winW := (winW / dpiFactor)
	ctrlCount := ctrlHwnds.MaxIndex()
	nextPos := (winW - (newWidth * ctrlCount) - (spaceBetween * (ctrlCount - 1))) // 2
	if (isWin10()) {
		nextPos -= 3
	}
	for idx, ctrlHwnd in ctrlHwnds {
		if (idx > 1) {
			nextPos += (newWidth + spaceBetween)
		}
		newPos := "x" . nextPos . " w" . newWidth . " h" . newHeight
		GuiControl, Move, %ctrlHWnd%, %newPos%
	}
}

centerMouse(mode:="screen", animate:=true) {
	animate := toBool(animate)
	origMode := A_CoordModeMouse
	mode := setCase(mode, "L")
	if (mode == "window") {
		hWnd := getHwnd()
		win := getWindowInfo(hWnd)
		newX := (win.width / 2)
		newY := (win.height / 2)
	}
	else {
		mode := "screen"
		curMon := hs.vars.monitors[getMonitorForWindow()]
		newX := curMon.workLeft + (curMon.workWidth / 2)
		newY := curMon.workTop + (curMon.workHeight / 2)
	}
	CoordMode("Mouse", mode)
	if (animate) {
		MouseMove(newX, newY, 5)
		MouseMove(10, 0, 50, "R")
		MouseMove(-20, 0, 50, "R")
		MouseMove(10, 0, 50, "R")
	}
	else {
		MouseMove(newX, newY, 0)
	}
	Sleep(100)
	CoordMode("Mouse", origMode)
}

centerWindow(title:="A", monitor:="") {
	origDelay := A_WinDelay
	SetWinDelay, 0
	if (monitor == "" || equalsIgnoreCase(monitor, "A")) {
		monitor := getMonitorForWindow()
	}
	WinGetPos, winX, winY, winW, winH, %title%
	coord := getCenter(winW, winH, monitor)
	WinMove, %title%,, coord.x, coord.y
	SetWinDelay, %origDelay%
}

checkVersions(forceCheck:=false) {
	today := prepText("${A_YYYY}${A_MM}${A_DD}")
	forum := hs.vars.url[hs.TITLE].forum
	if (forceCheck || (hs.config.user.enableVersionCheck && hs.config.user.lastUpdateCheck < today)) {
		ahkAvailable := urlToVar(hs.vars.url.ahk.version)
		Sleep(1000)
		if (ahkAvailable == "") {
			message("Unable to obtain AutoHotkey version information from:`n    " . hs.vars.url.ahk.version)
			return
		}
		else {
			if (StrLen(ahkAvailable) > 20) {
				msg =
				(LTrim Join`r`n
					An unexpected response occurred while checking for a new version of AutoHotkey.

					Please consider posting a message (with the response below) to the forums at: %forum%

					Response:
					%ahkAvailable%
				)
				output(msg)
			}
			else if (ahkAvailable > A_AhkVersion) {
				doUpdate := false
				if (hs.config.user.enableAutoUpdate) {
					doUpdate := true
					splash("Updating AutoHotkey to version: " . ahkAvailable, 2000)
				}
				else {
					msg =
						(LTrim
							The version of AutoHotkey in use is out-dated.

							%A_Tab%Current`t: %A_AhkVersion%
							%A_Tab%Latest`t: %ahkAvailable%

							Would you like to download the new version and install it?
						)
					if (message(msg, hs.TITLE . ": New AHK version available", 36, 30) == "Yes") {
						doUpdate := true
					}
				}
				if (doUpdate) {
					dlFile := hs.vars.url.ahk.install
					fullPath := A_ScriptDir . "\AutoHotkey_" . ahkAvailable . "_Setup.exe"
					UrlDownloadToFile, % dlFile, % fullPath
					if (ErrorLevel == 0) {
						size := FileGetSize(fullPath, "M")
						header := FileRead(fullPath, "*m1024")
						if (size < 2 || containsIgnoreCase(header, "<html", "<body", "<div", "error")) {
							message("The downloaded AutoHotkey update file is not valid.`n`nReview: " . fullPath)
							return
						}
						else {
							Run(fullPath)
						}

					}
					else {
						message("Failed to download AutoHotkey installer from:`n" . dlFile . "`n`nError: " . ErrorLevel)
						return
					}
				}
			}
		}
		hsAvailable := urlToVar(hs.vars.url[hs.TITLE].version)
		Sleep(1000)
		if (hsAvailable == "") {
			message("Unable to obtain " . hs.TITLE . " version information from:`n    " . hs.vars.url[hs.TITLE].version)
			return
		}
		else {
			if (StrLen(hsAvailable) > 20) {
				title := hs.TITLE
				msg =
				(LTrim Join`r`n
					An unexpected response occurred while checking for a new version of %title%.

					Please consider posting a message (with the response below) to the forums at: %forum%

					Response:
					%hsAvailable%
				)
				output(msg)
			}
			else if (hsAvailable > hs.VERSION) {
				doUpdate := false
				if (hs.config.user.enableAutoUpdate) {
					doUpdate := true
					splash("Updating " . hs.TITLE . " to version: " . hsAvailable, 2000)
				}
				else {
					msg := "
						(LTrim
							The version of " . hs.TITLE . " in use is out-dated.

							" . A_Tab . "Current`t: " . hs.VERSION . "
							" . A_Tab . "Latest`t: " . hsAvailable . "

							Would you like to download the new version and install it?
						)"
					if (message(msg, hs.TITLE . ": New version available", 36, 30) == "Yes") {
						doUpdate := true
					}
				}
				if (doUpdate) {
					ver := RegexReplace(ahkAvailable, "\.", "")
					dlFile := hs.vars.url[hs.TITLE].download
					newPath := A_ScriptFullPath . ".new"
					UrlDownloadToFile, % dlFile, % newPath
					if (ErrorLevel == 0) {
						header := FileRead(newPath, "*m1024")
						if (contains(header, "There should be no reason to edit this file directly.")) {
							FileMove(newPath, A_ScriptFullPath, true)
							setLastUpdateCheck(today)
							output := "last: " . hs.VERSION . "`nnew: " . hsAvailable . "`n"
							FileDelete(hs.file.UPDATE)
							FileAppend(output, hs.file.UPDATE)
							selfReload()
						}
						else {
							message("The downloaded " . hs.TITLE . " update file is not valid.`n`nReview: " . newPath)
							return
						}
					}
					else {
						message("Failed to download " . hs.TITLE . " from:`n`n" . dlFile . "`n`nError: " . ErrorLevel)
						return
					}
				}
			}
			else {
				setLastUpdateCheck(today)
				if (forceCheck) {
					splash(hs.TITLE . " is already running the latest version.", 2000)
				}
			}
		}
	}
	else {
		setLastUpdateCheck(today)
	}
	path := A_ScriptDir . "\AutoHotkey*.exe"
	Loop, Files, % path
	{
		FileDelete(A_LoopFileLongPath)
	}
}

checkVersionsForce() {
	checkVersions(true)
}

clipAppend(isCut:=false) {
	action := (isCut ? "x" : "c")
	clip := clipCurrent()
	isLoaded := clipLoad(, true)
	if (isLoaded) {
		origClipboard := Clipboard
		origIgnore := hs.internal.clipIgnore
		clipIgnore()
		Clipboard := ""
		clipSleep()
		SendInput, ^%action%
		ClipWait()
		copied := Clipboard
		merged := origClipboard . copied
		clipSleep()
		clipIgnore(false)
		Clipboard := merged
		clipIgnore(origIgnore)
	}
	else {
		SendInput, ^%action%
		ClipWait()
	}
}

clipChange(type) {
	if (hs.internal.clipIgnore) {
		return
	}
	clipName := clipNextName()
	if (hs.internal.isMultiClip) {
		; no need for clipDelete() here because we are appending to the queue/stack, not replacing
		clipPush(clipName)
	}
	else {
		clipDelete()
	}
	if (type != 0) {
		copied := ClipboardAll
		FileAppend(copied, clipName)
		if (hs.internal.clipSaved != "") {
			splash("Copied to " . hs.config.user.clipboard . " clipboard...")
		}
	}
}

clipClear() {
	Clipboard := ""
	clipDelete()
	if (hs.internal.isMultiClip) {
		hs.internal.multiClip := []
		hs.internal.stackNum := 1
	}
	clipSplash("Clearing " . clipCurrent().name . "...", 500)
}

clipClearAll() {
	Clipboard := ""
	attempt := 1
	path := SubStr(hs.internal.clipPath, 1, -1)
	result := FileExist(path)
	while (attempt < 10 && result != "") {
		result := FileExist(path)
		FileRemoveDir, %path%, 1
		attempt++
	}
	Sleep(50)
	result := FileExist(path)
	if (result == "") {
		FileCreateDir, %path%
		hs.internal.multiClip := []
		hs.internal.stackNum := 1
		clipSplash("Clearing all clipboards...", 500)
	}
	else {
		message("Unable to remove the clipboard directory: " . path . "`n`nError: " . ErrorLevel . "`nResult: " . result . "`n`nPossibily locked by Windows Explorer or DOS window.", "Unable to Delete", 16)
	}
}

clipCurrent() {
	current := {}
	if (hs.internal.isMultiClip) {
		current.name := "MultiClip"
		current.file := hs.internal.multiClip[1]
	}
	else if (hs.internal.isNumClip) {
		current.name := "NumClip #" . hs.internal.numClip
		current.file := hs.internal.numClips[hs.internal.numClip]
	}
	else {
		current.name := "Windows Clipboard"
		current.file := hs.internal.clipboard
	}
	return current
}

clipDelete(clip:=0) {
	if (clip != 0) {
		FileDelete(clip)
	}
	else {
		if (hs.internal.isMultiClip) {
			for k, v in hs.internal.multiClip {
				clipDelete(v)
			}
		}
		else if (hs.internal.isNumClip) {
			clipDelete(hs.internal.numClips[hs.internal.numClip])
		}
		else {
			clipDelete(hs.internal.clipboard)
		}
	}
}

clipIgnore(ignore:=true) {
	hs.internal.clipIgnore := toBool(ignore)
}

clipLoad(clip:="", silent:=false) {
	origIgnore := hs.internal.clipIgnore
	current := clipCurrent()
	if (clip == "") {
		clip := current.file
	}
	isLoaded := false
	if (FileExist(clip)) {
		FileGetSize, fileSize, % clip
		if (fileSize == 0) {
			FileDelete(clip)
			if (!silent) {
				message("Clip file is empty for: " . clip, "Empty clip file", 16)
			}
		}
		else {
			clipFile := "*c " . clip
			clipIgnore()
			FileRead, Clipboard, % clipFile
			clipSleep()
			clipIgnore(origIgnore)
			if (ErrorLevel != 0) {
				if (!silent) {
					message("Unable to read clip file: " . clip . "`n`nError: " . A_LastError, "Error reading clip file", 16)
				}
			}
			else {
				isLoaded := true
			}
		}
	}
	else if (!silent) {
		message("Clip file does not exist for: " . current.name, "Missing clip file", 16)
	}
	return isLoaded
}

clipNextName() {
	if (hs.internal.isMultiClip) {
		fileOK := false
		while (!fileOK) {
			hs.internal.stackNum++
			file := hs.internal.clipPath . "multiClip" . hs.internal.stackNum . ".clip"
			fileOK := !FileExist(file)
		}
	}
	else if (hs.internal.isNumClip) {
		file := hs.internal.numClips[hs.internal.numClip]
	}
	else {
		file := hs.internal.clipboard
	}
	return file
}

clipPaste(asText:=false, silent:=false) {
	clip := ""
	current := clipCurrent()
	isMultiClip := (current.name == "MultiClip")
	if (isMultiClip) {
		clip := clipPop()
		if (!clip) {
			return
		}
	}
	clipLoad(clip)
	if (asText || isActiveAltPaste() || isActiveApiPaste()) {
		pasteText(Clipboard)
	}
	else {
		SendInput, ^v
	}
	if (isMultiClip) {
		clipDelete(clip)
		size := getSize(hs.internal.multiClip)
		if (!silent) {
			clipSplash("Entries remaining on the MultiClip: " . size, 500)
		}
		if (size == 0) {
			hs.internal.stackNum := 0
		}
	}
}

clipPasteAll(asText:=false) {
	current := clipCurrent()
	if (current.name == "MultiClip") {
		size := getSize(hs.internal.multiClip)
		Loop, % size {
			clipPaste(asText, (A_Index != size))
		}
	}
	else {
		clipSplash("Paste All is only for MultiClip.`n`nCurrent clipboard is: " . current.name, 2000)
	}
}

clipPasteApi() {
	origMode := A_CoordModeMouse
	CoordMode("Mouse", "screen")
	MouseGetPos(MouseX, MouseY, hWndMouse)
	hWnd := getHwnd()
	if (hWnd == hWndMouse) {
		selText := getSelectedText()
		trimText := Trim(selText, " `t`r`n")
		if (trimText != "") {
			Clipboard := selText
			Sleep(20)
			clipPaste()
		}
		else if (selText == "") {
			clipPaste()
		}
	}
	else {
		Send, {RButton}
	}
	CoordMode("Mouse", origMode)
}

clipPasteAsText() {
	clipPaste(true)
}

clipPasteNumClip(asText:=false) {
	clipSave()
	setActiveClipboard("NumClip #" . extractNumClip(), false)
	Sleep(30)
	clipPaste(asText)
	Sleep(100)
	clipRestore()
}

clipPop() {
	result := ""
	size := getSize(hs.internal.multiClip)
	if (size > 0) {
		result := hs.internal.multiClip.RemoveAt(hs.internal.multiClipQueue ? 1 : size)
	}
	else {
		clipSplash("No entries remaining on the MultiClip...")
		result := false
	}
	return result
}

clipPreview(cancelHwnd:=0) {
	static isShowing := false
	static doInit := true
	static headerFont := ""
	static labelFont := ""
	static inputFont := ""
	static clipHeaderFont := ""
	static complexInput := ""
	static clipInput := ""
	if (doInit) {
		normalFont := new Font().size(10)
		inputFont := normalFont.copy()
		labelFont := inputFont.copy().color("maroon").bold()
		headerFont := inputFont.copy().color("navy").size(11)
		blueFont := new Font().color("blue")
		inputFont.name("Consolas")
		clipInput := new FormField("edit").readOnly()
		complexInput := clipInput.copy().default("{Complex/binary data -- image or advanced formatting}").inputFont(inputFont.copy().italic().color("blue"))
		doInit := false
	}
	if (isShowing) {
		if (!cancelHwnd) {
			KeyWait("v")
			cancelHwnd := getHwnd()
		}
		if (WinExist("ahk_id " . cancelHwnd)) {
			Gui, %cancelHwnd%:Default
			Gui, Hide
			Gui, Destroy
		}
		isShowing := false
		return
	}
	clip := clipCurrent()
	isMultiClip := (clip.name == "MultiClip")
	clipFiles := (isMultiClip ? hs.internal.multiClip : [clip.file])
	numClips := getSize(clipFiles)
	if (isMultiClip && !hs.internal.multiClipQueue) {
		clipFiles := reverse(clipFiles)
	}
	content := ""
	header := "Preview of " . clip.name
	fields := []
	for k, clipFile in clipFiles {
		isComplex := false
		isLoaded := clipLoad(clipFile, true)
		if (isLoaded || clip.name == "Windows Clipboard") {
			clipPreview := ""
			clipSize := StrLen(Clipboard)
			if (A_Index == 1) {
				if (isMultiClip) {
					header .= " - Paste order: " . whichMultiClip()
				}
			}
			if (clipSize == 0) {
				clipSize := VarSetCapacity(clipSource, 0)
				clipSource := ClipboardAll
				clipSize := VarSetCapacity(clipSource)
				if (clipSize == 0) {
					clipPreview := "{Empty}"
				}
				else {
					isComplex := true
				}
			}
			else {
				clipPreview := Clipboard
			}
			labelText := (isMultiClip ? "MultiClip " . A_Index . " of " . numClips : "Size") . ": " . toComma(clipSize) . " character" . (clipSize == 1 ? "" : "s") . " "
			if (isComplex) {
				fields.Push(complexInput.copy().label(labelText))
			}
			else {
				rows := strCount(clipPreview, "\r\n|\n|\r", true) + 1
				if (rows > 30) {
					rows := 30
				}
				fields.Push(clipInput.copy().rows(rows).default(clipPreview).label(labelText).max(clipSize))
			}
		}
		else {
			labelText := (isMultiClip ? "MultiClip " . A_Index . " of " . numClips : "Size") . ": 0 characters "
			fields.Push(clipInput.copy().default("{Empty}").label(labelText).inputFont(new Font().italic()))
		}
	}
	activeMon := getMonitorForWindow()
	preview := new Form()
		.title("Clipboard Preview").vertical().noButtons().noWait().onCancel("clipPreviewCancel")
		.color("EFEFFF").inputColor("black", "FFFEE3")
		.headerFont(headerFont).labelFont(labelFont).inputFont(inputFont)
		.inputWidth(hs.vars.monitors[activeMon].workWidth * 0.9)
		.header(header).fields(fields)
	isShowing := true
	buildForm(preview)
}

clipPreviewCancel(form) {
	clipPreview(form._hWnd)
}

clipPush(clip) {
	hs.internal.multiClip.Push(clip)
	size := getSize(hs.internal.multiClip)
	clipSplash("Entries on the MultiClip: " . size, 500)
	return size
}

clipRestore() {
	setActiveClipboard(hs.internal.clipSaved.name, false)
	hs.internal.clipSaved := ""
	;hs.internal.clipData := ""
}

clipSave() {
	hs.internal.clipSaved := clipCurrent()
	;hs.internal.clipData := ClipboardAll
	Sleep(50)
}

clipSleep() {
	Sleep(hs.internal.clipSleep)
}

clipSplash(msg, timeout:=1000) {
	static last := 0
	static wait := 2000
	if ((last + wait) < A_TickCount || last == 0) {
		splash(msg, timeout)
		last := A_TickCount
	}
}

clipSwap() {
	if (isActiveCommandLine()) {
		clipSplash("Unable to swap highlighted text and clipboard in a command-line window...", 2000)
		return
	}
	clip := clipCurrent()
	SplitPath(clip.file, fileName, dir, ext, nameNoExt, drive)
	swapFile := ""
	if (FileExist(clip.file)) {
		swapFile := dir . "\swap.clip"
		FileMove(clip.file, swapFile, true)
	}
	origIgnore := hs.internal.clipIgnore
	clipIgnore()
	Clipboard := ""
	SendInput, ^x
	ClipWait()
	copied := ClipboardAll
	FileAppend(copied, clip.file)
	if (swapFile != "" && clipLoad(swapFile, true)) {
		clipLoad(swapFile, true)
		SendInput, ^v
		FileDelete(swapFile)
	}
	clipIgnore(origIgnore)
}

clipToggleQueue() {
	hs.internal.multiClipQueue := !hs.internal.multiClipQueue
	clipSplash("MultiClip is now using " . whichMultiClip(), 1500)
}

compareStr(a, b, direction:="A") {
;	var numPatternNegative = /(-?\d+(\.\d+)?|-?\.\d+|[^0-9\-]+|-)/g;
;	var numPatternPositive = /(\d+(\.\d+)?|\.\d+|[^0-9]+)/g;
;	static regexComp := "(-?\d+|[^0-9\-]+|\-)(.*)"
;	static regexComp := "(\d+(?:\.\d+)?|\.\d+|[^0-9]+)(.*)"
	static regexComp := "(\d+(?:\.\d+)?|\.\d+|[^0-9.]+|\.[^0-9.]*)(.*)"
	result := 0
	direction := (setCase(direction, "U") == "D" ? "D" : "A")
	a := stripEol(a)
	b := stripEol(b)
	if (a != b) {
		if (a ~= "\d" && b ~= "\d") {
			if (RegExMatch(a, regexComp, a) + RegExMatch(b, regexComp, b)) {
				aLen := StrLen(a1)
				bLen := StrLen(b1)
				if (a1 == b1) {
					if (aLen != bLen) {
						; this handles 0 vs -0
						a1 := "!" . a1
						b1 := "!" . b1
					}
				}
				result := (a1 > b1 ? 1 : a1 < b1 ? -1 : compareStr(a2, b2, direction))
			}
		}
		else {
			result := (a > b ? 1 : a < b ? -1 : 0)
		}
	}
	if (direction == "D") {
		result *= -1
	}
	return result
}

compareStrAsc(a, b) {
	return compareStr(a, b, "A")
}

compareStrAscNoCase(a, b) {
	a := setCase(a, "L")
	b := setCase(b, "L")
	return compareStrAsc(a, b)
}

compareStrDesc(a, b) {
	return compareStr(a, b, "D")
}

compareStrDescNoCase(a, b) {
	a := setCase(a, "L")
	b := setCase(b, "L")
	return compareStrDesc(a, b)
}

contains(source, items*) {
	result := false
	useCase := toBool(A_StringCaseSense)
	if (isArray(source)) {
		for key, val in source {
			result := contains(val, items*)
			if (result) {
				break
			}
		}
	}
	else if (IsObject(source)) {
		message("contains() for objects has not yet been implemented.")
	}
	else {
		for index, value in items {
			if (IsObject(value)) {
				for key, val in value {
					; TODO - it may make sense to check either key or val here
					; TODO - check whole words or partial?
					if (InStr(source, val, useCase)) {
						result := true
						break
					}
				}
			}
			else {
				; TODO - check whole words or partial?
				if (InStr(source, value, useCase)) {
					result := true
					break
				}
			}
		}
	}
	return result
}

containsEol(text) {
	return (stripEol(text) != text)
}

containsIgnoreCase(source, items*) {
	origCase := A_StringCaseSense
	StringCaseSense, Off
	result := contains(source, items*)
	StringCaseSense, %origCase%
	return result
}

convertToCamelCase(str) {
	str := RegExReplace(str, "i)([a-z])( )", "$1")
	str := RegExReplace(str, "(^.)", "$l1")
	return str
}

convertToWords(str) {
	str := RegExReplace(str, "([a-z])([A-Z])", "$1 $2")
	str := RegExReplace(str, "\b([A-Z]+)([A-Z])([a-z])", "$1 $2$3")
	str := RegExReplace(str, "(^.)", "$u1")
	return str
}

createCustomHelp() {
	file := hs.file.CUSTOM_HELP
	if (FileExist(file) == "") {
		contents := getHelpContentCustom()
		FileAppend(contents, file)
	}
}

createIcon() {
	iconData1 =
	(LTrim Join
		000001000400101000000000200068040000460000002020000000002000A8100000AE040000
		3030000000002000A825000056150000404000000000200028420000FE3A0000280000001000
		0000200000000100200000000000400400000000000000000000000000000000000000000015
		01000B470300288D040029A3030026AF030025B7030024BB030024BD030024BD030024BB0300
		25B7030027AF040029A30400298B01000B430000001304003131070049ED080056FF090058FF
		090058FF090058FF090058FF090058FF090058FF090058FF090058FF090058FF090058FF0800
		55FF070049EB0400302F06004EA908005FFF090067FF090067FF090067FF090067FF090067FF
		090067FF090067FF090067FF090067FF090067FF090067FF090067FF08005FFF06004EA70700
		5CCD080069FF08006BFF08006BFF08006BFF08006BFF08006BFF08006BFF08006BFF08006BFF
		08006BFF08006BFF08006BFF08006BFF080069FF07005CCB070062CD08016EFF454090FF3B35
		8CFF0C0571FF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF
		08016FFF08016EFF070162CB060066CD070172FF7371A2FFF7F7F7FFF0F0F6FFAAA7CDFF5955
		A0FF120C79FF070173FF070174FF070174FF070174FF070174FF070174FF070172FF060166CB
		05016BCD060177FF060178FF514E93FFF3F2F3FFFFFFFFFFFFFFFFFFF7F7FAFFBCBBD9FF7370
		B1FF191482FF060179FF060179FF060179FF060177FF05016BCB04016FCD05027CFF05027EFF
		05027EFF444190FFB8B8CAFFF8F8F8FFFFFFFFFFFFFFFFFFFFFFFFFFEEEDF5FF201D8AFF0502
		7EFF05027EFF05027CFF05016FCB040174CD050281FF050283FF050283FF050283FF413F91FF
		A1A0BEFFF3F3F4FFFFFFFFFFFFFFFFFFFAFAFBFF2D2B94FF050283FF050283FF050281FF0401
		74CB030179CD040287FF040288FF040288FF040288FF040288FF7978AEFF9797C0FFD2D2DCFF
		FDFDFDFFD3D3E3FF6B6AB6FF040288FF040288FF040287FF030179CB03027DCD03038CFF0303
		8DFF03038DFF03038DFF03038DFF07078CFFACACC8FF6767B2FFE7E7EEFF9897BDFF9696BDFF
		3D3DA5FF2A2A97FF03038CFF03027DCB020281CD020391FF020392FF020392FF020392FF0203
		92FF020392FF090A90FF6464ABFF4243A2FF121393FF0A0B8FFF4C4DA2FF4B4CA6FF020390FF
		020281CB010286CD020395FF030497FF020497FF020397FF020397FF020397FF020397FF0203
		97FF020397FF020397FF020397FF030497FF030497FF020395FF010286CB020492C1090B9DFF
		1012A0FF0F11A0FF0E10A0FF0D10A0FF0D10A0FF0D10A0FF0D10A0FF0D10A0FF0D10A0FF0E10
		A0FF0F11A0FF1012A0FF090B9DFF020492BF1C1FA261292CADFF2D30AFFF2A2CADFF282BADFF
		282BADFF282BADFF282BADFF282BADFF282BADFF282BADFF282BADFF2A2DADFF2D30AFFF282B
		ADFF1C1EA25FFFFFFF01494CB8655A5CC1C76062C3D56164C4D56264C4D56264C4D56264C4D5
		6264C4D56264C4D56264C4D56164C4D56062C3D55A5CC0C7494CB863FFFFFF010000FFFF0000
		FFFF0000FFFF0000FFFF0000FFFF0000FFFF0000FFFF0000FFFF0000FFFF0000FFFF0000FFFF
		0000FFFF0000FFFF0000FFFF0000FFFF0000FFFF280000002000000040000000010020000000
		00008010000000000000000000000000000000000000000000070000000D0000001700000023
		00000033000000430000004F0000005B000000650000006D00000075000000790000007D0000
		007F000000810000008100000081000000810000007F0000007D00000079000000730000006D
		00000063000000590000004D0000003F0000002F00000021000000150000000B000000050000
		00150000002B0000004B0200169304002ED3050037EB050038F1050038F3050037F5050037F5
		050037F7050037F7050036F7050036F7050036F7050036F7050036F7050036F7050036F70500
		36F7050037F7050037F7050037F5050037F5050038F3050038F1050037EB04002ED10200168F
		000000470000002900000015000000090000041D050035B5070048FF07004DFF080050FF0800
		51FF080052FF080052FF080052FF080052FF080052FF080052FF080052FF080052FF080052FF
		080052FF080052FF080052FF080052FF080052FF080052FF080052FF080052FF080052FF0800
		51FF080050FF07004DFF070048FD050034B30000021F000000090000000305003D9907004CFF
		080055FF09005BFF09005EFF09005FFF09005FFF09005FFF09005FFF09005FFF09005FFF0900
		5FFF09005FFF09005FFF09005FFF09005FFF09005FFF09005FFF09005FFF09005FFF09005FFF
		09005FFF09005FFF09005FFF09005FFF09005EFF09005BFF080055FF07004CFF05003C930000
		000304002F2D07004EFB080057FF090060FF090065FF090066FF090066FF090066FF090066FF
		090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF0900
		66FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF090065FF
		090060FF080057FF07004DF904002D290600487B070057FF080060FF090066FF090068FF0900
		68FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF
		090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF0900
		68FF090068FF090068FF090068FF090066FF080060FF070057FF060048750700529B08005EFF
		080066FF090069FF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF0900
		6AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF
		09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF090069FF080066FF0800
		5EFF070052950600579D070163FF080169FF08016BFF08016CFF08016CFF08016CFF08016CFF
		08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF0801
		6CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF
		08016CFF08016BFF080169FF070163FF0601579706005A9D070166FF08016BFF08016EFF0801
		6EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF
		08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF0801
		6EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016BFF070166FF0601599706005C9D
		070168FF08016EFF080170FF5F5C9BFFA6A3C9FF8784B8FF55509BFF1A1479FF08016FFF0801
		70FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF
		080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF0801
		6EFF070168FF06015C9705005E9D07016AFF070170FF070172FF7D7C9BFFF2F2F2FFFFFFFFFF
		FFFFFFFFFBFBFDFFC9C7DEFF7D7AB3FF2D2886FF070172FF070172FF070172FF070172FF0701
		72FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF
		070172FF070172FF070172FF070170FF07016AFF06015D970500609D06016CFF070172FF0701
		75FF080373FF565386FFE1E1E1FFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFD3D2E5FF
		8380B8FF322E8BFF080274FF070175FF070175FF070175FF070175FF070175FF070175FF0701
		75FF070175FF070175FF070175FF070175FF070175FF070175FF070172FF06016CFF05016097
		0500619D06016FFF070175FF070177FF070177FF070177FF39357DFFD7D7D8FFFEFEFEFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFE0DFEDFF9C9AC7FF5854A1FF16107EFF
		070177FF070177FF070177FF070177FF070177FF070177FF070177FF070177FF070177FF0701
		77FF070175FF06016FFF050162970401649D050171FF060177FF06017AFF06017AFF06017AFF
		06017AFF2F2C7CFFCFCFD2FFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFF9F9FBFFB6B5D6FF514D9FFF07027AFF06017AFF06017AFF06017AFF
		06017AFF06017AFF06017AFF06017AFF060177FF050171FF040163970401669D050274FF0602
		7AFF06027CFF06027CFF06027CFF06027CFF06027CFF27247CFFC5C4CAFFE6E5EBFFEEEEEEFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBBBA
		D9FF0F0B80FF06027CFF06027CFF06027CFF06027CFF06027CFF06027CFF06027AFF050273FF
		040165970401689D050276FF05027CFF05027FFF05027FFF05027FFF05027FFF05027FFF0502
		7FFF1E1C7DFF9998B1FF7473A0FFE6E6E6FFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6765AEFF05027FFF05027FFF05027FFF05027FFF0502
		7FFF05027FFF05027CFF050276FF0401689703016B9D050278FF05027FFF050281FF050282FF
		050282FF050282FF050282FF050282FF050282FF201D7FFFACACBFFF6D6CA0FFDCDCDEFFFEFE
		FEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFF6261ABFF050282FF
		050282FF050282FF050282FF050282FF050281FF05027FFF050278FF03016A9703016C9D0502
		7BFF050281FF050284FF050284FF050284FF050284FF050284FF050284FF050284FF050284FF
		323084FFD0D0DAFF6A69A3FFD0D0D4FFFDFDFDFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFEDEDF2FF49479EFF050284FF050284FF050284FF050284FF050284FF050284FF050281FF
		05027BFF03016C9703016E9D04027DFF040284FF040287FF040287FF040287FF040287FF0402
		87FF040287FF040287FF040287FF040287FF5F5E94FFE9E9EFFF6363A4FFB0B0BDFFFAFAFAFF
		FFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFAEAECCFFD8D8E6FF040286FF040287FF040287FF0402
		87FF040287FF040287FF040284FF04027DFF03016E970301719D040280FF040287FF040289FF
		040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF060587FF9595
		AEFFF4F4F8FF5654A5FF73729BFFDEDEDEFFFAFAFAFFFFFFFFFFE8E8F0FFB9B9D3FFCECEE5FF
		040289FF040289FF040289FF040289FF040289FF040289FF040287FF04027FFF030170970302
		739D030382FF030389FF03038CFF03038CFF03038CFF03038CFF03038CFF03038CFF03038CFF
		03038CFF03038CFF03038CFF141487FFC4C4CBFFF6F6FAFF4242A6FF1B1B85FFD1D1DBFFFEFE
		FEFFACABCBFFAEAEC1FFD8D8E1FF3838A1FF03038CFF03038CFF04038CFF04048CFF03038CFF
		030389FF030382FF030273970202759D030384FF03038CFF03038EFF03038FFF03038FFF0303
		8FFF03038FFF03038FFF03038FFF03038FFF03038FFF03038FFF03038FFF28288AFFCECED2FF
		E2E2F0FF5E5EABFFFCFCFCFFD1D1E1FFACACCBFF59599DFF7D7D9FFFCACAD4FFA6A6D3FF4A4A
		ACFF5E5EB0FF424294FF03038EFF03038CFF030384FF020275970202769D030386FF03038EFF
		030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF0303
		91FF030391FF030391FF20208BFFA1A1B3FFD8D8DEFFC2C2D2FF3F3F95FF404096FF05058FFF
		04048EFF232389FF6E6F9FFFBEBEC4FFCBCBCFFF5E5EA5FF030390FF03038EFF030386FF0202
		77970102789D020389FF020391FF020393FF020393FF020393FF020393FF020393FF020393FF
		020393FF020393FF020393FF020393FF020393FF020393FF020393FF030491FF14148BFF0607
		90FF020393FF020393FF020393FF020393FF020393FF020393FF020391FF020391FF020393FF
		020393FF020391FF020389FF0102799701027B9D02038BFF020393FF020395FF020395FF0203
		95FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF
		020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF0203
		95FF020395FF020395FF020395FF020395FF020393FF02038BFF01027A9701027E9D02038EFF
		020395FF020498FF040599FF050699FF040599FF030498FF020498FF020498FF020398FF0204
		98FF020498FF020498FF020498FF020498FF020498FF020498FF020498FF020498FF020498FF
		020398FF020498FF020498FF030498FF040599FF050699FF040599FF020398FF020395FF0203
		8EFF01027E9700028497010393FF020499FF090A9DFF0B0D9EFF0C0E9EFF0B0D9EFF0A0C9DFF
		090B9DFF090B9DFF090B9DFF090B9DFF090B9DFF090B9DFF090B9DFF090B9DFF090B9DFF090B
		9DFF090B9DFF090B9DFF090B9DFF090B9DFF090B9DFF090B9DFF0A0C9DFF0B0D9EFF0C0E9EFF
		0B0D9EFF080A9DFF010399FF010393FF0102849101048C6F04069CFF080B9EFF1315A3FF1417
		A3FF1417A3FF1416A3FF1315A3FF1215A2FF1214A2FF1214A2FF1214A2FF1214A2FF1214A2FF
		1214A2FF1214A2FF1214A2FF1214A2FF1214A2FF1214A2FF1214A2FF1214A2FF1214A2FF1315
		A2FF1315A3FF1416A3FF1417A3FF1417A3FF1215A3FF070A9EFF04069CFF01048C690A0D7E1B
		171AA5F51A1CA7FF2225AAFF2225AAFF2023A9FF1F21A9FF1E20A8FF1D20A8FF1D1FA8FF1D1F
		A8FF1D1FA8FF1D1FA8FF1D1FA8FF1D1FA8FF1D1FA8FF1D1FA8FF1D1FA8FF1D1FA8FF1D1FA8FF
		1D1FA8FF1D1FA8FF1D1FA8FF1D20A8FF1E20A8FF1F21A9FF2023A9FF2224AAFF2124AAFF191C
		A7FF171AA4F30A0C7919FFFFFF012A2CA5733234B2FF373AB4FF3C3FB5FF383BB4FF3539B3FF
		3438B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437
		B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437B3FF3437B3FF3438B3FF3639B3FF
		383BB4FF3B3EB5FF3538B3FF3234B2FF292CA46FFFFFFF01FFFFFF01FFFFFF014245B2794C4F
		BCF95557C0FF5B5DC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF
		5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5EC2FF5B5E
		C2FF5B5EC2FF5B5EC2FF5B5EC2FF5A5DC2FF5456BFFF4C4FBCF74144B175FFFFFF01FFFFFF01
		FFFFFF01FFFFFF01FFFFFF015154B1215C5EBF796163C2A56668C4AB696BC5AB6B6DC6AB6B6E
		C6AB6B6EC6AB6B6EC6AB6B6EC6AB6B6EC6AB6B6EC6AB6B6EC6AB6B6EC6AB6B6EC6AB6B6EC6AB
		6B6EC6AB6B6EC6AB6B6EC6AB6B6DC6AB6B6DC6AB696BC5AB6568C4AB6063C2A55C5EBF795153
		B01FFFFFFF01FFFFFF01FFFFFF01000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000028000000300000006000
		0000010020000000000080250000000000000000000000000000000000000000000500000007
		0000000B00000011000000150000001B000000250000002D000000330000003B000000410000
		00470000004F00000053000000570000005D0000005F00000063000000670000006700000069
		0000006B0000006B0000006B0000006B0000006B000000690000006900000067000000650000
		00630000005F0000005B00000057000000510000004D000000450000003F000000390000002F
		000000290000002100000019000000130000000D0000000900000007000000030000000F0000
		001700000021000000310000003F00000053000006750100138F020019A102001AAB020019B3
		020018B7020017BD020017C1020016C5020016C9020015CB020015CB020015CF020015CF0200
		15CF020015D1020015D1020015D1020015D1020015D1020015D1020015CF020015CF020015CF
		020015CB020015CB020016C9020016C5020017C1020017BD020018B7020019B102001AAB0200
		199F0100138D000006710000004F0000003B0000002D0000001D000000150000000D00000015
		00000021000000310000004901000875030022B7050038E506003DF106003FF506003FF70600
		3FF9060040F9060040F906003FFB06003FFB06003FFB06003FFB06003FFB06003FFB06003FFB
		06003FFB06003FFB06003FFB06003FFB06003FFB06003FFB06003FFB06003FFB06003FFB0600
		3FFB06003FFB06003FFB06003FFB06003FFB06003FFB060040F9060040F906003FF906003FF7
		06003FF506003DF1050039E5030022B300000771000000450000002D0000001F000000130000
		000B00000011000002230300258506003EE7070047FF07004BFF07004DFF08004EFF08004FFF
		080050FF080050FF080050FF080050FF080050FF080050FF080050FF080050FF080050FF0800
		50FF080050FF080050FF080050FF080050FF080050FF080050FF080050FF080050FF080050FF
		080050FF080050FF080050FF080050FF080050FF080050FF080050FF080050FF080050FF0800
		4FFF08004EFF07004DFF07004BFF070047FF06003DE50300258300000123000000110000000B
		000000030000010B04002F61060044ED07004BFF07004FFF080054FF080056FF080058FF0900
		59FF090059FF090059FF090059FF090059FF090059FF090059FF090059FF090059FF090059FF
		090059FF090059FF090059FF090059FF090059FF090059FF090059FF080059FF090059FF0900
		59FF080059FF090059FF090059FF080059FF090059FF090059FF080059FF090059FF090059FF
		080059FF080058FF080056FF080054FF07004FFF07004BFF060044EB04002D5D000000090000
		00030000000304002D39060044CF07004CFF080052FF080058FF09005CFF09005FFF090060FF
		090060FF090060FF090060FF090060FF090060FF090060FF090060FF090060FF090060FF0900
		60FF090060FF090060FF090060FF090060FF090060FF090060FF090060FF090060FF090060FF
		090060FF090060FF090060FF090060FF090060FF090060FF090060FF090060FF090060FF0900
		60FF090060FF090060FF09005EFF09005CFF080057FF080052FF07004CFF060043CB04002B35
		00000003030025110600429B07004DFD080054FF08005BFF090060FF090064FF090065FF0900
		65FF090065FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF
		090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF0900
		66FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF090066FF
		090066FF090065FF090065FF090065FF090064FF090060FF08005BFF080054FF06004DFB0600
		42970300231104003B3106004BD3070053FF08005AFF080061FF080064FF090067FF090067FF
		090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF0900
		67FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF080067FF
		090067FF090067FF080067FF090067FF090067FF080067FF090067FF090067FF080067FF0900
		67FF090067FF080067FF090067FF090067FF080067FF090064FF080061FF08005AFF070053FF
		06004BCF05003B2D0500404F070053F5070059FF080060FF080065FF090067FF090068FF0900
		68FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF
		090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF0900
		68FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF
		090068FF090068FF090068FF090068FF090068FF090068FF090067FF080064FF080060FF0700
		58FF070053F1050040490600486708005AFF08005EFF080064FF090068FF090069FF09006AFF
		09006AFF09006AFF09006AFF09006AFF09006AFF090069FF09006AFF09006AFF090069FF0900
		6AFF09006AFF090069FF09006AFF09006AFF090069FF09006AFF09006AFF09006AFF080069FF
		09006AFF09006AFF080069FF09006AFF09006AFF080069FF09006AFF09006AFF080069FF0900
		6AFF09006AFF080069FF09006AFF09006AFF080069FF09006AFF090069FF080068FF080064FF
		08005EFF08005AFD0600476106004C6B08015EFF080162FF090167FF09016AFF08016AFF0901
		6BFF09016AFF09016BFF09016BFF09016AFF09016BFF09016BFF09016BFF09016BFF09016BFF
		09016BFF09016BFF09016BFF09016BFF09016BFF09016BFF09016BFF09016BFF09016AFF0901
		6BFF08016BFF09016AFF09016BFF08016BFF09016AFF09016BFF08016BFF09016AFF09016BFF
		08016BFF09016AFF09016BFF08016BFF09016AFF09016BFF08016BFF09016AFF090169FF0801
		67FF080162FF08015EFF06004B6506004E6B070161FF070164FF080169FF08016BFF08016BFF
		08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016BFF08016CFF0801
		6CFF08016BFF08016CFF08016CFF08016BFF08016CFF08016CFF08016BFF08016CFF08016CFF
		08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF0801
		6CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016BFF08016BFF
	)

	iconData2 =
	(LTrim Join
		080169FF070164FF070160FF06014E650500506B070163FF070166FF08016AFF08016DFF0801
		6EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF
		08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF0801
		6EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF
		08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF0801
		6DFF08016AFF070166FF060162FF05014F650500516B070164FF070168FF08016CFF08016EFF
		08016FFF0E0771FF26207EFF282280FF140E75FF09026FFF08016EFF08016FFF08016FFF0801
		6FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF
		08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF0801
		6FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF
		08016EFF08016CFF070167FF070164FF050151650500526B070165FF070169FF08016EFF0801
		70FF080170FF5F5C97FFCAC9DCFFD1D0E3FFC3C1DAFFA3A1C8FF706CAAFF2D2884FF0B0571FF
		08016FFF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF0801
		70FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF
		080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF0801
		70FF080170FF08016EFF070169FF070165FF050152650500536B060167FF07016BFF07016FFF
		070171FF070171FF757395FFE0E0E1FFFAFAFAFFFFFFFFFFFFFFFFFFFFFFFFFFFCFCFDFFDEDE
		EBFFA09EC6FF534F9AFF2E2986FF150F79FF070172FF070172FF070172FF070172FF070172FF
		070172FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF0701
		72FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF070172FF
		070172FF070171FF07016FFF07016BFF060166FF050153650400556B050168FF06016CFF0601
		70FF070173FF060174FF211D74FF717093FFCACACEFFFAFAFAFFFFFFFFFFFEFEFEFFFFFFFFFF
		FFFFFFFFFEFEFEFFF7F6FAFFD1D0E3FF9E9BC6FF615EA4FF2F2A88FF0C0675FF060173FF0701
		73FF060174FF070174FF070174FF060174FF070174FF070174FF060174FF070174FF070174FF
		060174FF070174FF070174FF060174FF070174FF070174FF060174FF070174FF070174FF0601
		74FF070174FF070173FF060171FF06016CFF050168FF040154650400566B050169FF06016DFF
		060172FF070174FF060175FF070175FF120D74FF49467FFFC8C8C8FFF7F7F7FFFEFEFEFFFFFF
		FFFFFEFEFEFFFFFFFFFFFFFFFFFFFEFEFEFFFEFEFEFFEEEDF5FFD4D3E6FFACAACFFF57539FFF
		1A157DFF070174FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF0701
		75FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF
		070175FF070175FF070174FF070172FF06016DFF060169FF040155650400576B05016BFF0601
		6FFF070174FF070176FF070177FF070177FF070177FF070176FF353179FFA6A5B3FFEEEEEEFF
		FEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFE
		FEFFF4F3F8FFC4C3DDFF7976B3FF464297FF2B2689FF120C7CFF070177FF070177FF070177FF
		060177FF070177FF070177FF060177FF070177FF070177FF060177FF070177FF070177FF0601
		77FF070177FF070177FF060176FF070174FF06016FFF05016BFF040157650400586B05016DFF
		060171FF060176FF060178FF060178FF060178FF060179FF060179FF090477FF332F7CFF9E9D
		AEFFF3F3F3FFFEFEFEFFFEFEFEFFFFFFFFFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFFFEFEFEFF
		FFFFFFFFFFFFFFFFFEFEFEFFFEFEFEFFF0F0F6FFCBCAE1FF9593C3FF6562A9FF2F2B8CFF0702
		78FF060178FF060179FF060179FF060178FF060179FF060179FF060178FF060179FF060179FF
		060178FF060179FF060179FF060178FF060175FF060170FF05016DFF040158650401596B0501
		6EFF050172FF060177FF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF080479FF
		28247AFFADACB4FFF1F1F1FFFEFEFEFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFFFEFEFEFFFFFF
		FFFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDFDFDFFEFEFF6FFD4D4E7FF
		8B88BEFF2A268BFF06027AFF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF0601
		7AFF06017AFF06017AFF06017AFF06017AFF060177FF050172FF05016EFF0401586504015B6B
		050270FF050274FF060279FF06027BFF06027CFF06027CFF06027CFF06027CFF06027CFF0602
		7CFF06027CFF221F7AFF8E8DA4FFE4E4E5FFF6F6F7FFE9E9EBFFF9F9F9FFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFFFEFEFEFFFFFF
		FFFFFFFFFFFFEEEDF5FF7F7DB9FF0C087FFF05027CFF06027CFF06027CFF05027CFF06027CFF
		06027CFF05027CFF06027CFF06027CFF05027BFF060279FF050274FF05026FFF04015A650401
		5C6B050272FF050276FF05027AFF05027DFF05027EFF05027DFF06027EFF05027EFF05027DFF
		06027EFF05027EFF06027CFF23207CFF82829EFFCCCCD7FF8D8CAFFFC9C8CFFFFAFAFAFFFFFF
		FFFFFEFEFEFFFFFFFFFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFF
		FEFEFEFFFFFFFFFFFFFFFFFFF7F7FAFF504EA1FF05027DFF05027EFF05027EFF05027DFF0502
		7EFF05027EFF05027DFF05027EFF05027EFF05027DFF05027BFF050275FF050271FF04015B65
		03015D6B040273FF050277FF05027CFF05027FFF05027FFF05027FFF05027FFF05027FFF0502
		7FFF05027FFF05027FFF05027FFF05027EFF18167CFF89899FFF908FB6FF666598FFD1D1D2FF
		F8F8F8FFFEFEFEFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA1A0CBFF06037FFF05027FFF05027FFF05027FFF
		05027FFF05027FFF05027FFF05027FFF05027FFF05027FFF05027CFF050277FF040273FF0301
		5D6503015F6B040275FF050279FF05027EFF050280FF050281FF050281FF050281FF050281FF
		050281FF050281FF050281FF050281FF050281FF050281FF19177EFF8686A1FFA5A4C5FF615F
		98FFB4B4C0FFF0F0F0FFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFF9C9BC7FF050280FF050281FF050281FF0502
		81FF050281FF050281FF050281FF050281FF050281FF050280FF05027EFF050279FF040274FF
		03015E650301606B040276FF05027BFF040280FF050282FF050283FF050283FF050283FF0502
		83FF050283FF050283FF050283FF050283FF040283FF050283FF050282FF252381FF9A9AAEFF
		AFAECFFF6B6AA1FFA9A8B9FFF3F3F3FFFEFEFEFFFFFFFFFFFEFEFEFFFFFFFFFFFFFFFFFFFEFE
		FEFFFFFFFFFFFFFFFFFFFEFEFEFFFFFFFFFFFBFBFBFF5A58A5FF050282FF050283FF040283FF
		050283FF050283FF040283FF050283FF050283FF040283FF050282FF050280FF04027AFF0402
		76FF03015F650301616B040278FF05027CFF050281FF040284FF050284FF050284FF050284FF
		050284FF050284FF050284FF050284FF040284FF050284FF050284FF040284FF060383FF312F
		81FFC8C8CBFFBFBEDAFF59589CFFB1B1BAFFEEEEEEFFFEFEFEFFFFFFFFFFFEFEFEFFFEFEFEFF
		FFFFFFFFFEFEFEFFFEFEFEFFFFFFFFFFFEFEFEFFDBDBE6FF6D6BACFF1B198EFF040284FF0502
		84FF050284FF040284FF050284FF050284FF040284FF050284FF050284FF040281FF05027CFF
		040277FF030160650301636B040279FF04027EFF040283FF040285FF040287FF040287FF0402
		87FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF
		040286FF53528CFFD3D3D6FFE1E1EEFF54539DFF8383A2FFD7D6DAFFFBFBFBFFFEFEFEFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFF1F1F5FF9897C0FFE0E0E9FF5E5DAEFF040286FF
		040287FF040287FF040287FF040287FF040287FF040287FF040287FF040285FF040283FF0402
		7EFF040279FF030162650301636B04027AFF04027FFF040285FF040287FF040288FF040288FF
		040288FF040288FF040288FF040288FF040288FF040288FF040288FF040288FF040288FF0402
		88FF040288FF131185FF7A7AA0FFE6E6E7FFD0CFE6FF5D5CA4FF636195FFC9C9CCFFF2F2F2FF
		FDFDFDFFFEFEFEFFFFFFFFFFFFFFFFFFFDFDFDFFC3C2DAFFB5B4CEFFECECF3FF5F5EAFFF0402
		88FF040288FF040288FF040288FF040288FF040288FF040288FF040288FF040287FF040285FF
		04027FFF04027BFF030163650301656B04027CFF040281FF040287FF040289FF040289FF0402
		89FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF
		040289FF040289FF040289FF232286FFA0A0B2FFF8F8F9FFD3D3E9FF4A48A1FF403F8AFF9A99
		A9FFD8D8D8FFF4F4F4FFFDFDFDFFFEFEFEFFEFEFF4FFA8A7C9FFDCDCE7FFE4E4F1FF4C4BA8FF
		040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF0402
		86FF040280FF04027CFF030164650302666B03037EFF030383FF030388FF03038BFF03038CFF
		03038CFF03038CFF03038CFF03038CFF03038CFF03038CFF03038CFF03038CFF03038CFF0303
		8CFF03038CFF03038CFF03038CFF03038BFF292983FFC4C4C9FFF9F9F9FFECECF5FF3C3BA2FF
		0C0B86FF2E2E82FFB2B2C4FFFBFBFBFFFEFEFEFFC8C8DCFFA1A1C3FFCACAD3FFE2E2E9FF7B7B
		BEFF151492FF03038CFF03038CFF03038CFF03038CFF04038CFF04038CFF03038CFF03038BFF
		030388FF030382FF03037EFF030265650202686B02027FFF030384FF03038AFF03038DFF0303
		8DFF03038DFF03038DFF03038DFF03038DFF03038DFF03038DFF03038DFF02028DFF03038DFF
		03038DFF02028DFF03038DFF03038DFF02028DFF03038CFF595992FFCECED1FFFAFAFAFFC4C4
		E2FF2C2C9DFF2F2F97FFE5E5EBFFFEFEFEFFF3F3F4FF9494BFFF7B7BB3FF515197FF9B9BB7FF
		C9C9D8FF9999CBFF3B3BA4FF0A0A8FFF03038DFF09098EFF2A2A92FF20208EFF02028DFF0303
		8DFF03038AFF020284FF030380FF020267650202696B030381FF030385FF03038BFF03038EFF
		03038FFF03038FFF03038FFF03038FFF03038FFF03038FFF03038FFF02028FFF03038FFF0303
		8FFF02028FFF03038FFF03038FFF02028FFF03038FFF03038FFF0F0F8BFF626295FFD0D0D3FF
		F5F5F8FF8383C4FF9595C1FFFCFCFCFFF9F9F9FFA8A8CBFFB7B7D0FF9D9DBEFF6C6C9CFF7777
		96FF9898ABFFC6C6D1FFD3D3E6FFA3A3D3FF6060B5FF6A6AB7FF7171B5FF414193FF03038EFF
		02028EFF03038BFF030385FF020281FF0202686502026A6B030382FF030387FF03038DFF0303
		8FFF030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF
		030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF06068DFF4141
		88FFB1B1BEFFD3D3DCFFE8E8ECFFE4E4E9FF9393BEFF585894FF6C6C9EFF262690FF05058FFF
		03038EFF121287FF3D3D86FF8686A5FFBDBDC9FFDDDDDEFFE4E4E5FFBEBED2FF6565A7FF0303
		8FFF03038FFF03038DFF030387FF030382FF0202696502026B6B020284FF020389FF02038FFF
		020391FF020392FF020392FF020392FF020392FF020392FF020392FF020392FF020392FF0202
		92FF020392FF020392FF020292FF020392FF020392FF020292FF020392FF020392FF020292FF
		030490FF2A2A8AFF5E5E9AFF7C7CA8FF5B5CA2FF1A1A94FF05068EFF030490FF020392FF0203
		92FF020292FF020392FF020391FF0E0F8BFF2D2E8CFF4C4C95FF53549AFF383895FF0D0D91FF
		020292FF020391FF02038FFF020288FF020384FF01026A6501026C6B020385FF02038AFF0203
		90FF020393FF020393FF020393FF020393FF020393FF020393FF020393FF020393FF020293FF
		020393FF020393FF020293FF020393FF020393FF020293FF020393FF020393FF020293FF0203
		93FF020393FF020393FF060790FF0B0C8FFF040591FF020293FF020393FF020393FF020293FF
		020393FF020393FF020293FF020393FF020393FF020293FF020392FF020392FF020293FF0203
		93FF020393FF020293FF020390FF02038AFF020285FF01026B6501026E6B020387FF02038CFF
		020392FF020394FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF0203
		95FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF
		020395FF020395FF020395FF020295FF020395FF020395FF020295FF020395FF020395FF0202
		95FF020395FF020395FF020295FF020395FF020395FF020395FF020395FF020395FF020395FF
		020395FF020395FF020294FF020392FF02038CFF020286FF01026D6501026F6B020289FF0203
		8DFF020393FF020396FF020396FF020396FF030497FF030497FF020396FF020397FF020397FF
		020397FF020397FF020397FF020397FF020397FF020397FF020397FF020397FF020397FF0203
		97FF020397FF020397FF020397FF020397FF020397FF020397FF020397FF020397FF020397FF
		020397FF020397FF020397FF020397FF020397FF020397FF020397FF030497FF030497FF0304
		97FF020397FF020396FF020395FF020393FF02038DFF020388FF01026E650102726B02028BFF
		02038FFF020395FF020397FF030499FF040699FF050699FF050699FF040699FF040599FF0304
		98FF020498FF020498FF020498FF020398FF020498FF020498FF020498FF020498FF020498FF
		020498FF020498FF020498FF020498FF020498FF020498FF020498FF020498FF020498FF0204
		98FF020498FF020398FF020498FF020498FF020498FF030498FF040599FF040699FF050699FF
		050699FF040699FF030498FF020397FF020395FF02038FFF02028BFF01027065000276670103
		8FFF010393FF010398FF04069AFF080A9CFF0A0C9DFF0B0D9DFF0B0D9DFF0A0C9DFF090B9DFF
		090B9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A
		9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF
		080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF080A9CFF090B9CFF090B9DFF0A0C9DFF0B0D
		9DFF0B0D9DFF0A0C9DFF080A9CFF03059AFF010398FF010393FF01028FFD0102756100027B53
		010294F9010398FF02059BFF090B9EFF0E10A0FF0F11A0FF1012A1FF1012A1FF0F11A0FF0F11
		A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF
		0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10
		A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0F11A0FF0F12A0FF
		1012A1FF1012A1FF0F11A0FF0D0FA0FF080A9EFF02049BFF010398FF010394F700027B4F0204
		8537030698E305089DFF080B9FFF1012A1FF1517A4FF1518A4FF1518A4FF1518A4FF1517A4FF
		1417A3FF1416A3FF1316A3FF1316A3FF1315A3FF1315A3FF1315A3FF1315A3FF1315A3FF1315
		A3FF1315A3FF1315A3FF1315A3FF1315A3FF1315A3FF1315A3FF1315A3FF1315A3FF1315A3FF
		1315A3FF1315A3FF1315A3FF1315A3FF1315A3FF1316A3FF1416A3FF1416A3FF1417A3FF1517
		A4FF1518A4FF1518A4FF1518A4FF1417A4FF0E11A1FF080B9FFF05089DFF030697DF02048733
		0A0D841311149BA11619A4FD1619A5FF1B1EA7FF2023A9FF2023A9FF1F21A9FF1E21A8FF1D1F
		A8FF1C1FA7FF1C1EA7FF1B1DA7FF1B1DA7FF1B1DA7FF1A1DA7FF1B1DA7FF1A1DA7FF1A1DA7FF
		1B1DA7FF1A1DA7FF1A1DA7FF1B1DA7FF1A1DA7FF1B1DA7FF1A1DA7FF1B1DA7FF1B1DA7FF1A1D
		A7FF1B1DA7FF1B1DA7FF1A1DA7FF1B1DA7FF1B1DA7FF1B1DA7FF1B1EA7FF1C1EA7FF1C1FA7FF
		1D1FA8FF1E21A8FF1F21A8FF2022A9FF1F22A9FF1A1CA7FF1619A5FF1618A4FD11149B9B0A0C
		7F1108093C031B1D9A4D2326A9E32628ACFF272AADFF2D30AFFF2E31AFFF2C2FAFFF2A2DAEFF
		282BADFF282BADFF272AADFF262AACFF2729ADFF2729ADFF2629ACFF2729ADFF2729ADFF2629
		ACFF2729ADFF2729ADFF2629ACFF2729ADFF2729ADFF2729ADFF2729ACFF2729ADFF2729ADFF
		2729ACFF2729ADFF2729ADFF2729ACFF2729ADFF2729ADFF2729ACFF272AADFF272AADFF282B
		ADFF292BADFF2A2DAEFF2C2FAFFF2D30AFFF2C2EAFFF2729ADFF2528ACFF2326A9E11B1D9949
		06072C03FFFFFF011D1E860B2C2FA67F3538B3FF3638B3FF3B3EB5FF3F42B7FF3E41B6FF3B3E
		B5FF393DB5FF383CB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF
		383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383B
		B4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF383BB4FF
		393CB4FF393DB5FF3B3EB5FF3E41B6FF3E41B7FF393CB5FF3538B3FF3538B3FF2C2EA5791C1E
		820BFFFFFF01FFFFFF01FFFFFF01121339033F42B081474AB9E74B4DBBFD5254BFFF5659C0FF
		5759C0FF5659C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558
		C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF
		5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558C0FF5558
		C0FF5658C0FF5659C0FF5759C0FF5558C0FF5153BEFF494CBCFD4749B9E53E41AF7D0D0E2903
		FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF013F42A00D4B4EB5535356BCA9595CC1ED5F61
		C4FD6365C5FF6769C7FF696BC7FF6A6CC8FF6B6DC8FF6B6EC8FF6B6EC9FF6B6EC9FF6B6EC8FF
		6B6EC9FF6B6EC9FF6B6EC8FF6B6EC9FF6B6EC9FF6B6EC8FF6B6EC9FF6B6EC9FF6B6EC8FF6B6E
		C9FF6B6EC9FF6B6EC8FF6B6EC9FF6B6EC9FF6B6EC8FF6B6EC9FF6B6EC9FF6B6DC8FF6B6DC8FF
		6A6CC8FF686BC7FF6669C7FF6265C5FF5E60C3FD585BC0EB5355BCA74B4EB4513E419D0DFFFF
		FF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF013C3F89035255B417595CBB3D
		5D5FBD616062BF7B6365C1836466C1836668C2836769C2836769C283676AC283676AC283676A
		C283676AC283676AC283676AC283676AC283676AC283676AC283676AC283676AC283676AC283
		676AC283676AC283676AC283676AC283676AC283676AC283676AC2836769C2836769C2836769
		C2836668C2836466C1836365C1836062BF7B5D5FBD61595CBA3D5254B4173B3D8403FFFFFF01
		FFFFFF01FFFFFF01FFFFFF01000000000000FFFF000000000000FFFF000000000000FFFF0000
		00000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF
		000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000
		FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF00000000
		0000FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF0000
		00000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF
		000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000
		FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF00000000
		0000FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF0000
		00000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF000000000000FFFF
		000000000000FFFF000000000000FFFF28000000400000008000000001002000000000000042
		0000000000000000000000000000000000000000000300000005000000050000000700000009
		0000000D0000000F00000013000000170000001B0000001F00000023000000270000002B0000
		002F00000033000000370000003B0000003F000000410000004500000047000000490000004D
		0000004F0000004F000000510000005100000053000000530000005300000053000000530000
		00530000005300000051000000510000004F0000004F0000004D0000004B0000004900000047
		00000043000000410000003D0000003900000035000000310000002D00000029000000230000
		001F0000001B0000001700000013000000110000000D00000009000000070000000500000005
		00000003FFFFFF01000000090000000D00000013000000190000002100000029000000310000
		003B00000047000000530000005F0000006B000000730000007B00000083000000890000008F
		00000095000000990000009D000000A1000000A5000000A7000000A9000000AB000000AD0000
		00AF000000AF000000B1000000B1000000B1000000B1000000B1000000B1000000B1000000B1
		000000AF000000AF000000AD000000AB000000A9000000A7000000A5000000A10000009D0000
	)

	iconData3 =
	(LTrim Join
		0099000000930000008F00000089000000810000007900000071000000670000005B0000004F
		00000041000000370000002D000000250000001D00000015000000110000000B000000090000
		001100000019000000230000002F0000003B0000004B0000005B0000007500000497020016BB
		030022D3040027DD040028E1040027E5040027E7040026E9040026E9040026EB040026ED0400
		26ED040025EF040025EF040025EF040025EF040025F1040025F1040025F1040025F1040025F1
		040025F1040025F1040025F1040025F1040025F1040025F1040025F1040025F1040025F10400
		25F1040025F1040025EF040025EF040025EF040025EF040026ED040026ED040026EB040026EB
		040026E9040027E7040027E5040028E1040027DD030022D1020016B900000495000000710000
		005700000045000000370000002900000021000000170000000F000000130000001B00000027
		0000003500000045000000610200109F05002FDF070042FB070046FF070047FF070047FF0700
		47FF070047FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF
		070048FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF0700
		48FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF
		070048FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF070048FF0700
		47FF070047FF070047FF070047FF070046FF070042FB05002FDD01000F9B0000005F00000041
		00000033000000270000001B000000130000000B0000001100000017000000230000024D0400
		2CBF070045FD070047FF070049FF07004AFF08004CFF08004DFF08004DFF08004EFF08004EFF
		08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF0800
		4EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF
		08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF0800
		4EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004EFF08004DFF08004DFF
		08004CFF07004AFF070049FF070047FF070044FB04002BBB0000014B00000025000000190000
		00110000000B0000000300000005000000090100093506003ACD070048FF07004AFF08004DFF
		080050FF080052FF080054FF090055FF090056FF090056FF090056FF090056FF090056FF0900
		56FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF
		090056FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF0900
		56FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF090056FF
		090056FF090056FF090056FF090056FF090056FF090056FF090055FF080054FF080052FF0800
		50FF08004DFF07004AFF070048FF060039C701000733000000090000000500000003FFFFFF01
		FFFFFF010000021B06003CC1070049FF08004CFF080050FF080054FF090057FF09005AFF0900
		5BFF09005CFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF
		09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF0900
		5DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF
		09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF09005DFF0900
		5DFF09005DFF09005DFF09005DFF09005CFF09005BFF09005AFF090057FF080054FF080050FF
		08004CFF070049FF06003AB900000119FFFFFF01FFFFFF01FFFFFF0100000007050032870700
		4AFF08004DFF080051FF090056FF09005BFF09005EFF090060FF0A0061FF0A0062FF0A0062FF
		0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A00
		62FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF
		0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A00
		62FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF0A0062FF
		0A0062FF0A0062FF0A0061FF090060FF09005DFF09005AFF090056FF080051FF08004DFF0700
		4AFF0500307F00000007FFFFFF01FFFFFF010200132D070049EF07004EFF080052FF080058FF
		09005DFF090060FF090063FF0A0064FF0A0065FF0A0065FF0A0065FF0A0066FF0A0066FF0A00
		66FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF
		0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A00
		66FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF
		0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0066FF0A0065FF0A0065FF0A00
		65FF0A0064FF090063FF090060FF09005CFF080058FF080052FF07004EFF070048EB01000F27
		FFFFFF010000000305003A8507004FFF070052FF080057FF08005DFF090061FF090064FF0900
		66FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF
		090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF0900
		67FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF
		090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF0900
		67FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090067FF090066FF
		090064FF090061FF08005DFF080057FF070052FF07004FFF0500387D000000030000000D0600
		49CD070053FF080057FF08005CFF080061FF090065FF090067FF090068FF090068FF090068FF
		090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF0900
		68FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF
		090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF0900
		68FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF090068FF
		090068FF090068FF090068FF090068FF090068FF090068FF090068FF090066FF090065FF0800
		61FF08005CFF080057FF070053FF060048C50000000B01000F1F070053F3080057FF08005BFF
		080060FF090065FF090067FF090068FF090069FF090069FF090069FF090069FF090069FF0900
		69FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF
		090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF0900
		69FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF
		090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF090069FF0900
		69FF090069FF090069FF090069FF090069FF090068FF090067FF090064FF080060FF08005BFF
		080057FF070052EF0100081904002A33080058FD08005BFF08005FFF080063FF090067FF0900
		69FF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF
		09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF0900
		6AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF
		09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF0900
		6AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF09006AFF
		09006AFF09006AFF09006AFF090069FF090067FF080063FF08005FFF08005BFF080058FB0300
		252B0500333B08015CFF08015EFF080162FF090166FF090169FF09016AFF09016AFF09016AFF
		09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF0901
		6AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF
		09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF0901
		6AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF
		09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF09016AFF0901
		6AFF09016AFF090168FF090166FF080162FF08015EFF08015BFF04002E310500353B08015EFF
		080161FF080164FF090168FF09016AFF09016BFF09016CFF09016CFF09016CFF09016CFF0901
		6CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF
		09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF0901
		6CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF
		09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF0901
		6CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016CFF09016BFF09016AFF
		090168FF080164FF080161FF08015EFF04012F310400363B070160FF070163FF080166FF0801
		69FF08016BFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF
		08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF0801
		6CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF
		08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF0801
		6CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF
		08016CFF08016CFF08016CFF08016CFF08016CFF08016CFF08016BFF080169FF080166FF0701
		62FF070160FF040130310400373B070162FF070164FF080167FF08016AFF08016CFF08016EFF
		08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF0801
		6EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF
		08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF0801
		6EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF
		08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF08016EFF0801
		6EFF08016EFF08016EFF08016EFF08016CFF08016AFF080167FF070164FF070161FF04013031
		0400373B070163FF070165FF080168FF08016CFF08016DFF08016FFF08016FFF08016FFF0801
		6EFF08016EFF08016EFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF
		08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF0801
		6FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF
		08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF0801
		6FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF08016FFF
		08016FFF08016DFF08016CFF080168FF070165FF070162FF040131310400383B070164FF0701
		66FF08016AFF08016DFF08016FFF080170FF080170FF09026FFF363186FF545098FF464190FF
		292380FF0D0770FF08016EFF08016FFF08016FFF080170FF080170FF080170FF080170FF0801
		70FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF
		080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF0801
		70FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF
		080170FF080170FF080170FF080170FF080170FF080170FF080170FF080170FF08016FFF0801
		6CFF080169FF070166FF070164FF040132310400393B070165FF070167FF08016BFF08016EFF
		080170FF080171FF080170FF514E8AFFEFEFEFFFFFFFFFFFFFFFFFFFFDFDFDFFECECF3FFC1BF
		D9FF8481B6FF484493FF120C74FF08016FFF080170FF080171FF080171FF080171FF080171FF
		080171FF080171FF080171FF080171FF080171FF080171FF080171FF080171FF080171FF0801
		71FF080171FF080171FF080171FF080171FF080171FF080171FF080171FF080171FF080171FF
		080171FF080171FF080171FF080171FF080171FF080171FF080171FF080171FF080171FF0801
		71FF080171FF080171FF080171FF080171FF080171FF080170FF08016EFF08016AFF070167FF
		070165FF040132310400393B070166FF070168FF08016CFF08016FFF080171FF080172FF0801
		71FF6B698AFFE5E5E5FFFDFDFDFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		F2F2F7FFB6B4D3FF706CAAFF282281FF080170FF080171FF080172FF080172FF080172FF0801
		72FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF
		080172FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF0801
		72FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF080172FF
		080172FF080172FF080172FF080171FF08016FFF08016CFF070168FF070165FF040133310300
		3A3B060167FF060169FF07016DFF070170FF070172FF070173FF070173FF211D6DFF868690FF
		D6D6D6FFF9F9F9FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFBFBFCFFCBCAE0FF7B78B1FF2C2785FF080272FF070173FF070173FF070173FF070173FF
		070173FF070173FF070173FF070173FF070173FF070173FF070173FF070173FF070173FF0701
		73FF070173FF070173FF070173FF070173FF070173FF070173FF070173FF070173FF070173FF
		070173FF070173FF070173FF070173FF070173FF070173FF070173FF070173FF070173FF0701
		73FF070172FF070170FF07016DFF060169FF060167FF0301333103003B3B060168FF06016AFF
		07016EFF070171FF070173FF070175FF070175FF070174FF0E096FFF5D5C7AFFBEBEBEFFF2F2
		F2FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFCFCFDFFD0CFE3FF807DB5FF302B88FF070173FF070174FF070174FF070175FF0701
		75FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF
		070175FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF0701
		75FF070175FF070175FF070175FF070175FF070175FF070175FF070175FF070173FF070171FF
		07016EFF06016AFF060168FF0301343103003B3B060169FF06016BFF07016FFF070172FF0701
		74FF070176FF070176FF070176FF070175FF070173FF373470FFA8A8A9FFECECECFFFEFEFEFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFEFEFEFFD7D6E7FF8683B9FF37338DFF0B0575FF070174FF070175FF070176FF
		070176FF070176FF070176FF070176FF070176FF070176FF070176FF070176FF070176FF0701
		76FF070176FF070176FF070176FF070176FF070176FF070176FF070176FF070176FF070176FF
		070176FF070176FF070176FF070176FF070176FF070174FF070172FF07016FFF06016BFF0601
		69FF0301353103003C3B06016AFF06016DFF070170FF070174FF070176FF070177FF070177FF
		070177FF070177FF070177FF070176FF25216FFF9B9A9FFFE8E8E8FFFEFEFEFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFEFEFEFFE3E2EEFFA19FC9FF5D59A3FF1D1880FF080275FF070176FF0701
		77FF070177FF070177FF070177FF070177FF070177FF070177FF070177FF070177FF070177FF
		070177FF070177FF070177FF070177FF070177FF070177FF070177FF070177FF070177FF0701
		77FF070177FF070177FF070176FF070173FF070170FF06016DFF06016AFF0301353103003C3B
		06016BFF06016EFF070171FF070175FF070177FF070178FF070178FF070178FF070178FF0701
		78FF070178FF070177FF1E1970FF919198FFE5E5E5FFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFAFAFBFFCBCAE0FF8784BAFF403B94FF0C0678FF070177FF
		070178FF070178FF070178FF070178FF070178FF070178FF070178FF070178FF070178FF0701
		78FF070178FF070178FF070178FF070178FF070178FF070178FF070178FF070178FF070178FF
		070177FF070175FF070171FF06016EFF06016BFF0301363103003D3B05016DFF05016FFF0601
		73FF060176FF060178FF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF
		060179FF181471FF898993FFE1E1E1FFFDFDFDFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFE8E8F1FF9B99C6FF423F96FF090479FF0601
		79FF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF
		06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF06017AFF060178FF060176FF0601
		72FF05016FFF05016CFF0301363103013E3B05026DFF050270FF060274FF060277FF06027AFF
		06027BFF06027BFF06027BFF06027BFF06027BFF06027BFF06027BFF06027BFF06027AFF1511
		73FF83828FFFDEDEDEFFFDFDFDFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFD3D2E5FF6360A8FF0B077BFF06027AFF
		06027BFF06027BFF06027BFF06027BFF06027BFF06027BFF06027BFF06027BFF06027BFF0602
		7BFF06027BFF06027BFF06027BFF06027BFF06027AFF060277FF060273FF050270FF05026DFF
		0301363103013F3B05026FFF050271FF060275FF060279FF06027BFF06027CFF06027CFF0602
		7CFF06027CFF06027CFF06027CFF06027CFF06027CFF06027CFF06027CFF110E75FF7A798AFF
		D9D9D9FFFBFBFBFFFEFEFEFFF8F8F8FFFAFAFAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD2D1E5FF322F90FF06027CFF06027CFF0602
		7CFF06027CFF06027CFF06027CFF06027CFF06027CFF06027CFF06027CFF06027CFF06027CFF
		06027CFF06027CFF06027BFF060279FF060275FF050271FF05026EFF0301373103013F3B0502
		70FF050273FF060277FF06027AFF06027CFF06027DFF06027DFF06027DFF06027DFF06027DFF
		06027DFF06027DFF06027DFF06027DFF06027DFF06027DFF0E0A76FF6E6D84FFD2D2D2FFF8F8
		F8FFAAA9BEFFCCCCCCFFF6F6F6FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFEBEBF3FF2A278DFF06027DFF06027DFF06027DFF06027DFF
		06027DFF06027DFF06027DFF06027DFF06027DFF06027DFF06027DFF06027DFF06027DFF0602
		7CFF06027AFF060276FF050273FF05026FFF030138310301403B050271FF050274FF060278FF
		06027BFF06027DFF06027FFF06027FFF06027FFF06027FFF06027FFF06027FFF06027FFF0602
		7FFF06027FFF06027FFF06027FFF06027EFF0A0779FF626280FFCECECEFF6A68ABFF555388FF
		C2C2C2FFF3F3F3FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFAAA9CFFF06027DFF06027FFF06027FFF06027FFF06027FFF06027FFF0602
		7FFF06027FFF06027FFF06027FFF06027FFF06027FFF06027FFF06027DFF06027BFF060277FF
		050274FF050271FF030138310201403B040272FF050275FF050279FF05027CFF05027FFF0502
		80FF050280FF050280FF050280FF050280FF050280FF050280FF050280FF050280FF050280FF
		050280FF050280FF050280FF08057BFF5F5F7FFFCDCDCEFF7574B3FF454484FFB8B8B9FFEFEF
		EFFFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE4E4
		EDFF08057FFF050280FF050280FF050280FF050280FF050280FF050280FF050280FF050280FF
		050280FF050280FF050280FF050280FF05027FFF05027CFF050279FF050275FF040272FF0201
		39310201413B040274FF050276FF05027AFF05027DFF050280FF050281FF050281FF050281FF
	)

	iconData4 =
	(LTrim Join
		050281FF050281FF050281FF050281FF050281FF050281FF050281FF050281FF050281FF0502
		81FF050281FF09067CFF676783FFD5D5D5FF8786BEFF393782FFB0AFB2FFEBEBEBFFFEFEFEFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDDDDE7FF070480FF050281FF
		050281FF050281FF050281FF050281FF050281FF050281FF050281FF050281FF050281FF0502
		81FF050281FF050280FF05027DFF05027AFF050276FF040273FF020139310201423B040275FF
		050277FF05027BFF05027FFF050281FF050282FF050283FF050283FF050283FF050283FF0502
		83FF050283FF050283FF050283FF050283FF050283FF050283FF050283FF050283FF050282FF
		0B087CFF76768AFFE0E0E0FF9D9CCAFF2F2E82FFA4A4AAFFE6E6E6FFFEFEFEFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFA2A1C6FF050281FF050283FF050283FF050283FF0502
		83FF050283FF050283FF050283FF050283FF050283FF050283FF050283FF050282FF050281FF
		05027FFF05027BFF050277FF040274FF02013A310201423B040276FF050279FF05027DFF0502
		80FF050282FF050284FF050284FF050284FF050284FF050284FF050284FF050284FF050284FF
		050284FF050284FF050284FF050284FF050284FF050284FF050284FF050283FF110F7BFF9090
		99FFECECECFFB0AFD5FF2A2884FF9998A3FFE1E1E1FFFDFDFDFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFF7F7F7FF4D4B9EFF050283FF050284FF050284FF050284FF050284FF050284FF050284FF
		050284FF050284FF050284FF050284FF050284FF050284FF050282FF050280FF05027CFF0502
		79FF040276FF02013B310201433B040277FF05027AFF05027EFF050281FF050284FF050285FF
		050285FF050285FF050285FF050285FF050285FF050285FF050285FF050285FF050285FF0502
		85FF050285FF050285FF050285FF050285FF050285FF050285FF24227AFFB0B0B2FFF6F6F6FF
		C0BFDEFF272687FF8C8C9CFFD8D8D8FFFAFAFAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFEFFC3C2D7FF9291BBFF
		42409EFF050285FF050285FF050285FF050285FF050285FF050285FF050285FF050285FF0502
		85FF050285FF050285FF050285FF050284FF050281FF05027EFF05027AFF040276FF02013B31
		0201443B040278FF04027BFF04027FFF040283FF040285FF040286FF040287FF040287FF0402
		87FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF
		040287FF040287FF040287FF040287FF040285FF43427CFFCACACAFFFBFBFBFFCFCFE6FF2625
		8BFF6F6F8EFFC9C9C9FFF6F6F6FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5F5F5FF7574AEFFEAEAEBFFB3B3D6FF040285FF0402
		87FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF040287FF
		040286FF040285FF040283FF04027FFF04027BFF040278FF02013C310201443B040279FF0402
		7CFF040280FF040284FF040286FF040288FF040288FF040288FF040288FF040288FF040288FF
		040288FF040288FF040288FF040288FF040288FF040288FF040288FF040288FF040288FF0402
		88FF040288FF040288FF060484FF6C6B87FFDFDFDFFFFEFEFEFFD6D6E9FF24238FFF4E4D82FF
		B6B5B6FFEDEDEDFFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
		FFFFFEFEFEFFB5B4CFFF9C9BC0FFFBFBFBFFC9C9DFFF040286FF040288FF040288FF040288FF
		040288FF040288FF040288FF040288FF040288FF040288FF040288FF040287FF040286FF0402
		84FF040280FF04027CFF040279FF02013D310201453B04027AFF04027DFF040282FF040285FF
		040288FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF0402
		89FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF040289FF
		040289FF0F0E80FF92929BFFEDEDEDFFFFFFFFFFDDDDEDFF272595FF2B2A7CFF919198FFD7D7
		D7FFF7F7F7FFFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3F3F4FF6665A8FF
		E9E9EAFFFFFFFFFFADADD1FF040288FF040289FF040289FF040289FF040289FF040289FF0402
		89FF040289FF040289FF040289FF040289FF040289FF040288FF040285FF040281FF04027DFF
		04027AFF02013D310201463B04027CFF04027EFF040283FF040287FF040289FF04028AFF0402
		8AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF
		04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF2524
		7DFFB2B2B4FFF7F7F7FFFFFFFFFFDFDFEFFF272596FF0E0C81FF56557FFFABABACFFD8D8D8FF
		EEEEEEFFFCFCFCFFFFFFFFFFFFFFFFFFFEFEFEFFB3B2D0FF9B9BC0FFFBFBFBFFFFFFFFFF8E8D
		C5FF040289FF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF04028AFF
		04028AFF04028AFF04028AFF040289FF040286FF040282FF04027EFF04027BFF02013D310202
		463B04037DFF040380FF040384FF040388FF04038AFF04038BFF04038CFF04038CFF04038CFF
		04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF0403
		8CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038AFF47477EFFCDCDCDFF
		FCFCFCFFFFFFFFFFDEDEEEFF212096FF040389FF16157FFF464680FF8E8EA9FFF5F5F5FFFFFF
		FFFFFFFFFFFFF5F5F5FF7170AFFFDFDFE0FFEAEAEAFFFAFAFAFFBAB9DCFF06058AFF04038BFF
		04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF04038CFF0403
		8BFF04038AFF040388FF040383FF040380FF04037CFF02023E310202473B03037EFF030381FF
		030385FF030389FF03038CFF03038DFF03038DFF03038DFF03038DFF03038DFF03038DFF0303
		8DFF03038DFF03038DFF03038DFF03038DFF03038DFF03038DFF03038DFF03038DFF03038DFF
		03038DFF03038DFF03038DFF03038DFF03038DFF050589FF6D6D88FFDBDBDBFFFDFDFDFFFFFF
		FFFFD3D3E9FF131391FF03038CFF0F0F8CFFC4C4D4FFFDFDFDFFFFFFFFFFFCFCFCFFABABCBFF
		9F9FC0FF8080ADFF70708FFFC3C3C3FFEBEBEBFFB4B4D8FF242498FF03038CFF03038DFF0303
		8DFF03038DFF03038DFF05058CFF07078CFF03038CFF03038DFF03038DFF03038CFF030389FF
		030385FF030381FF03037EFF02023F310202483B03037FFF030382FF030386FF03038AFF0303
		8DFF03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF
		03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF03038EFF0303
		8EFF03038EFF03038EFF03038EFF0D0D85FF808090FFE0E0E0FFFDFDFDFFFFFFFFFF9898CDFF
		03038CFF6F6FAAFFF7F7F7FFFFFFFFFFFEFEFEFFE3E3E7FF6E6EAFFFBABAD0FF14148FFF3939
		9BFF58589BFFA1A1BAFFE6E6E6FFECECF1FF9090C9FF212198FF03038DFF03038EFF03038DFF
		333397FF6B6B9AFF2D2D8EFF03038EFF03038EFF03038DFF03038AFF030386FF030382FF0303
		7FFF020240310202483B030380FF030383FF030387FF03038BFF03038EFF03038FFF030390FF
		030390FF030390FF030390FF030390FF030390FF030390FF030390FF030390FF030390FF0303
		90FF030390FF030390FF030390FF030390FF030390FF030390FF030390FF030390FF030390FF
		030390FF03038FFF111185FF818190FFDBDBDBFFFBFBFBFFF8F8FBFF34349EFFD4D4DBFFFEFE
		FEFFFFFFFFFFF0F0F0FF7474B1FFCFCFDBFFB9B9D3FFA6A6B4FF747497FF787891FF858597FF
		9090A8FFC9C9D3FFF2F2F2FFF6F6F9FFB3B3DAFF6F6FBBFF6F6FBAFFD6D6E5FF252598FF4D4D
		93FF04048EFF03038FFF03038EFF03038BFF030387FF030383FF030380FF020240310202493B
		030381FF030384FF030388FF03038CFF03038FFF030390FF030391FF030391FF030391FF0303
		91FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF
		030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF030391FF0303
		90FF0D0D87FF6D6D87FFC7C7C7FFF1F1F1FFD1D1E7FFFBFBFBFFFDFDFDFFEBEBEBFF7D7DACFF
		707091FFA2A2AAFF575794FF0E0E8BFF03038FFF03038EFF080889FF272780FF5F5F85FF9D9D
		A5FFD1D1D2FFEDEDEDFFF8F8F8FFFBFBFBFFF7F7F7FFBCBCD3FF6B6BA4FF03038FFF030390FF
		03038FFF03038CFF030388FF030384FF030381FF020240310202493B030382FF030385FF0303
		8AFF03038EFF030390FF030392FF030392FF030392FF030392FF030392FF030392FF030392FF
		030392FF030392FF030392FF030392FF030392FF030392FF030392FF030392FF030392FF0303
		92FF030392FF030392FF030392FF030392FF030392FF030392FF030392FF030391FF06068DFF
		3C3C7FFF929298FFC2C2C2FFD4D4D4FFC3C3C5FF5F5F9CFF06068FFF0B0B88FF07078CFF0303
		91FF030392FF030392FF030392FF030392FF030391FF030390FF0F1086FF3E3E81FF75758DFF
		A0A0A1FFAAAAABFF9191A1FF4B4C91FF07078FFF030392FF030391FF030390FF03038EFF0303
		89FF030385FF030382FF0102403101024A3B020383FF020386FF02038BFF02038FFF020392FF
		020393FF020393FF020393FF020393FF020393FF020393FF020393FF020393FF020393FF0203
		93FF020393FF020393FF020393FF020393FF020393FF020393FF020393FF020393FF020393FF
		020393FF020393FF020393FF020393FF020393FF020393FF020393FF020392FF06078CFF2020
		82FF2D2D82FF121389FF020392FF020393FF020393FF020393FF020393FF020393FF020393FF
		020393FF020393FF020393FF020393FF020393FF020392FF020391FF04058DFF05068CFF0203
		91FF020392FF020393FF020393FF020393FF020392FF02038FFF02038BFF020386FF020383FF
		0102413101024B3B020384FF020387FF02038CFF020390FF020393FF020394FF020394FF0203
		94FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF
		020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF0203
		94FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF
		020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF0203
		94FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF020394FF
		020394FF020394FF020393FF020390FF02038CFF020387FF020384FF0102423101024C3B0203
		86FF020389FF02038DFF020391FF020394FF020395FF020395FF020395FF020395FF020395FF
		020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF0203
		95FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF
		020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF0203
		95FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF
		020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF020395FF0203
		94FF020391FF02038DFF020388FF020385FF0102433101024C3B020387FF02038AFF02038EFF
		020392FF020395FF020396FF020396FF020396FF030496FF030496FF030496FF030496FF0203
		96FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF
		020396FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF0203
		96FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF
		020396FF020396FF020396FF020396FF020396FF020396FF020396FF020396FF030496FF0304
		96FF030496FF030496FF020396FF020396FF020396FF020396FF020395FF020392FF02038EFF
		02038AFF020386FF0102433101024D3B020389FF02038BFF020390FF020393FF020396FF0203
		97FF020398FF030498FF040598FF040598FF040598FF030498FF030498FF030498FF020398FF
		020398FF020398FF020398FF020398FF020398FF020398FF020398FF020398FF020398FF0203
		98FF020398FF020398FF020398FF020398FF020398FF020398FF020398FF020398FF020398FF
		020398FF020398FF020398FF020398FF020398FF020398FF020398FF020398FF020398FF0203
		98FF020398FF020398FF020398FF020398FF030498FF030498FF040598FF040598FF040598FF
		040598FF030498FF020398FF020397FF020396FF020393FF02038FFF02038BFF020388FF0102
		443101024F3B02038BFF02038DFF020391FF020395FF020397FF020499FF04069AFF05079AFF
		06079AFF06079AFF06079AFF05079AFF05069AFF040699FF040599FF030599FF030599FF0305
		99FF030599FF030499FF030499FF030599FF030599FF030599FF030599FF030599FF030599FF
		030599FF030599FF030599FF030599FF030599FF030599FF030599FF030599FF030599FF0305
		99FF030599FF030599FF030599FF030599FF030499FF030499FF030599FF030599FF030599FF
		030599FF040599FF040699FF05069AFF05079AFF06079AFF06079AFF06079AFF05079AFF0405
		99FF020498FF020397FF020395FF020391FF02038DFF02038AFF010245310002513901038EFF
		010390FF010394FF010397FF020499FF05079BFF080A9CFF090B9DFF0A0C9DFF0A0C9DFF0A0C
		9DFF090B9DFF090B9DFF080A9CFF080A9CFF07099CFF07099CFF07099CFF07099CFF07099CFF
		07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF0709
		9CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF
		07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF07099CFF080A9CFF080A
		9CFF090B9DFF090B9DFF0A0C9DFF0A0C9DFF0A0C9DFF090B9DFF080A9CFF05079BFF010399FF
		010397FF010394FF010390FF01038DFD0102482F01024A2B010391FD010394FF010397FF0103
		99FF04069BFF0A0C9EFF0D0E9FFF0D0F9FFF0E10A0FF0E10A0FF0E10A0FF0E10A0FF0D0F9FFF
		0D0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E
		9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF
		0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E
		9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0C0E9FFF0D0F9FFF0D0F9FFF0E10A0FF
		0E10A0FF0E10A0FF0E10A0FF0D0F9FFF0C0E9FFF090B9EFF03059BFF010399FF010397FF0103
		94FF010391F901013F2300001911010394ED010399FF01049BFF02059CFF080B9EFF0F11A1FF
		1114A2FF1214A2FF1215A2FF1215A2FF1215A2FF1214A2FF1214A2FF1113A2FF1113A2FF1113
		A1FF1013A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF
		1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012
		A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF1012A1FF
		1012A1FF1113A1FF1113A2FF1113A2FF1113A2FF1214A2FF1215A2FF1215A2FF1215A2FF1215
		A2FF1214A2FF1113A2FF0E11A1FF07099EFF02059CFF01049BFF010399FF010392E70000090D
		00000005030691B906099EFF080B9FFF090CA0FF0F11A1FF1518A4FF171AA5FF171AA5FF171A
		A5FF171AA5FF171AA5FF1719A5FF1619A5FF1618A4FF1518A4FF1518A4FF1518A4FF1517A4FF
		1517A4FF1517A4FF1517A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417
		A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417A4FF1417A4FF
		1417A4FF1417A4FF1417A4FF1517A4FF1517A4FF1517A4FF1517A4FF1517A4FF1518A4FF1518
		A4FF1518A4FF1618A4FF1619A5FF1719A5FF171AA5FF171AA5FF171AA5FF171AA5FF1619A5FF
		1417A4FF0D10A1FF090CA0FF080B9FFF06099EFF030690AF00000003FFFFFF010B0E87611114
		A3FF1417A4FF1316A4FF1619A5FF1D1FA8FF1E21A8FF1E21A8FF1D20A8FF1D1FA8FF1C1FA7FF
		1C1EA7FF1B1EA7FF1B1DA7FF1A1DA7FF1A1CA7FF1A1CA7FF1A1CA7FF191CA7FF191CA6FF191C
		A6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF
		191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191CA6FF191C
		A6FF191CA6FF191CA6FF191CA6FF191CA7FF1A1CA7FF1A1CA7FF1A1CA7FF1A1DA7FF1B1DA7FF
		1B1EA7FF1C1EA7FF1C1FA7FF1D1FA8FF1D20A8FF1E20A8FF1E21A8FF1C1EA7FF1417A5FF1316
		A4FF1417A4FF1114A3FF0B0D8355FFFFFF01FFFFFF0108093C0D1B1EA3D92023AAFF2022AAFF
		1F22A9FF2629ACFF282BADFF282BADFF2729ACFF2528ACFF2427ABFF2326ABFF2325ABFF2224
		AAFF2224AAFF2124AAFF2124AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF
		2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123
		AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF2123AAFF
		2123AAFF2123AAFF2123AAFF2124AAFF2124AAFF2224AAFF2225AAFF2325ABFF2326ABFF2427
		ABFF2528ACFF2629ACFF282AADFF282AADFF2527ACFF1E21A9FF2022AAFF2022AAFF1B1EA2D1
		06072C0BFFFFFF01FFFFFF01FFFFFF012021914D2B2DAEFD2D2FAFFF2B2DAFFF3032B1FF3437
		B2FF3538B3FF3437B2FF3235B2FF3033B1FF2F32B0FF2E32B0FF2E31B0FF2D31B0FF2D30B0FF
		2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30
		B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF
		2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30B0FF2D30
		B0FF2D30B0FF2D30B0FF2D31B0FF2E31B0FF2F32B0FF2F32B0FF3033B1FF3235B2FF3437B2FF
		3437B2FF3336B2FF2E30B0FF2B2DAFFF2D2FAFFF2A2DAEFB1F218E45FFFFFF01FFFFFF01FFFF
		FF01FFFFFF01000001032F32A483383BB5FF393CB5FF393CB5FF4043B8FF4346B9FF4447B9FF
		4144B8FF3F42B7FF3D41B7FF3D40B6FF3C40B6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3F
		B6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF
		3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3F
		B6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF3C3FB6FF
		3C3FB6FF3C40B6FF3D40B6FF3D41B7FF3F42B7FF4144B8FF4346B9FF4245B9FF3E41B7FF383B
		B5FF393CB5FF383BB5FF2F31A27B00000003FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01
		121339053C3FAC874548BAFF474ABBFF494BBBFF4F52BEFF5456BFFF5457C0FF5355BFFF5154
		BEFF5053BEFF5053BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF
		5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052
		BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF
		5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5052BEFF5053BEFF5153
		BEFF5154BEFF5355BFFF5457C0FF5355BFFF4E51BDFF474ABBFF474ABBFF4548BAFD3B3EAA7F
		0D0E2905FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01020206034447
		AB595053BCE55457C0FF5659C1FF5B5EC2FF6163C5FF6567C6FF6769C7FF6769C7FF676AC7FF
		676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676A
		C7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF
		676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676A
		C7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF676AC7FF6769C7FF6669C7FF6467C6FF
		6063C4FF5A5CC2FF5558C0FF5457C0FF5052BCE34346A95301010303FFFFFF01FFFFFF01FFFF
		FF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF013C3F89115457B773
		5B5EC0CF5F61C4FB6163C5FF6466C6FF6769C7FF6A6CC8FF6C6EC9FF6E70CAFF6F71CAFF7072
		CBFF7072CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF
		7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073
	)

	iconData5 =
	(LTrim Join
		CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7073CBFF7072CBFF7072CBFF
		7072CBFF6F71CAFF6E70CAFF6C6EC9FF696CC8FF6769C7FF6366C6FF6163C5FF5F61C4FB5B5E
		BFCD5456B66F3B3D850FFFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01
		FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01080811034F51A01B5B5D
		B6415E60BA555F61BB595F61BB595F61BB595F61BB595F61BB596062BB596062BB596062BB59
		6062BB596062BB596062BB596062BB596062BB596062BB596062BB596062BB596062BB596062
		BB596062BB596062BB596062BB596062BB596062BB596062BB596062BB596062BB596062BB59
		6062BB596062BB596062BB596062BB596062BB596062BB596062BB596062BB595F61BB595F61
		BB595F61BB595F61BB595F61BB595E60BA535B5DB6414E509F1904040803FFFFFF01FFFFFF01
		FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF01FFFFFF010000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		0000000000000000000000000000000000000000000000000000000000000000000000000000
		00000000
	)
	iconData := iconData1 . iconData2 . iconData3 . iconData4 . iconData5
	hexToBin(iconBin, iconData)
	fileIco := FileOpen(hs.file.ICON, "w")
	fileIco.RawWrite(iconBin, StrLen(iconData) / 2)
	fileIco.close()
}

createNewInExplorer(type:="file") {
	; TODO - Windows 10 --> Ctrl-Space, Menu key, W, T
	; TODO - Windows 8 --> Menu key, W, T
	; TODO - Windows 7 --> Alt-F, W, T
;	debug("type = " . type)
	folder := getExplorerPath()
;	debug("folder = " . folder)
	if (folder != "") {
		type := setCase(type, "L")
		name := getUniqueNewName(folder, type)
;		debug("name = " . name)
		fullName := folder . name
;		debug("fullName = " . fullName)
		if (type == "folder") {
			FileCreateDir, %fullName%
		}
		else {
			FileAppend("", fullName)
		}
		if (!FileExist(fullName)) {
			message("Unable to create " . type . ": " . fullName)
		}
		ctrl := "DirectUIHWND" . (isActiveDialog() ? "2" : "3")
		ControlFocus, %ctrl%, A
		selectInExplorer(name)
		Sleep(50)
		SendInput, {F2}
	}
}

createNewOnDesktop(type:="file") {
	folder := A_Desktop
	name := getUniqueNewName(folder, type)
	fullName := folder . name
	if (equalsIgnoreCase(type, "folder")) {
		FileCreateDir, %fullName%
	}
	else {
		FileAppend("", fullName)
	}
	selectOnDesktop(name)
	Sleep(50)
	SendInput, {F2}
}

createStartupLink() {
	lnkFile := A_Startup . "\" . hs.TITLE . ".lnk"
	if (hs.config.user.enableAutoStart) {
		if (!FileExist(lnkFile)) {
			target := hs.BASENAME . ".ahk"
			workDir := A_ScriptDir
			args := ""
			desc := "Changing the way you use Windows through better efficiencies!"
			iconFile := hs.file.ICON
			shortcut := ""
			iconNum := 1
			runState := 1
			FileCreateShortcut(target, lnkFile, workDir, args, desc, iconFile, shortcut, iconNum, runState)
		}
	}
	else {
		FileDelete(lnkFile)
	}
}

createUserFiles() {
	file := hs.file.USER_FUNCTIONS
	if (FileExist(file) == "") {
		contents =
		(LTrim Join`r`n
			; All user-defined functions should be declared below.
			; Functions defined here can be used by HotScriptKeys.ahk or HotScriptStrings.ahk.
			; Any functions defined within HotScript itself can be called by functions created here.

			/*
			simpleFunction`(someVar`) {
			%A_Space%   ; do something here...
			}

			userInit() {
			%A_Space%   ; this is a special function that will be executed whenever HotScript is loaded.
			}
			*/

		)
		FileAppend(contents, file)
	}
	file := hs.file.USER_KEYS
	if (FileExist(file) == "") {
		contents =
		(LTrim Join`r`n
			; All user-defined HotKeys should be declared below.
			; All HotScript or user-defined functions are available for use here.

			/*
			%A_Space%   #  - Win
			%A_Space%   !  - Alt
			%A_Space%   ^  - Control
			%A_Space%   +  - Shift
			%A_Space%   <  - left key
			%A_Space%   >  - right key
			%A_Space%   *  - wild card `(fire even if extra modifier keys are pressed`)
			%A_Space%   ~  - do not block native key function
			%A_Space%   UP - fire upon key release instead of key press
			*/

			/*
			Below are the names/symbols that can be used when defining HotKeys. The names are case-insensitve.

			Key Names and Symbols
			---------------------
			'
			,
			-
			.
			/
			0
			1
			2
			3
			4
			5
			6
			7
			8
			9
			;
			=
			[
			\
			]
			``
			A
			Alt
			AppsKey
			B
			Backspace
			Break
			Browser_Back
			Browser_Favorites
			Browser_Forward
			Browser_Home
			Browser_Refresh
			Browser_Search
			Browser_Stop
			Bs
			C
			CapsLock
			Control
			Ctrl
			CtrlBreak
			D
			Del
			Delete
			Down
			E
			End
			Enter
			Esc
			Escape
			F
			F1
			F2
			F3
			F4
			F5
			F6
			F7
			F8
			F9
			F10
			F11
			F12
			F13
			F14
			F15
			F16
			F17
			F18
			F19
			F20
			F21
			F22
			F23
			F24
			G
			H
			Help
			Home
			I
			Ins
			Insert
			J
			Joy1
			Joy2
			Joy3
			Joy4
			Joy5
			Joy6
			Joy7
			Joy8
			Joy9
			Joy10
			Joy11
			Joy12
			Joy13
			Joy14
			Joy15
			Joy16
			Joy17
			Joy18
			Joy19
			Joy20
			Joy21
			Joy22
			Joy23
			Joy24
			Joy25
			Joy26
			Joy27
			Joy28
			Joy29
			Joy30
			Joy31
			Joy32
			K
			L
			LAlt
			Launch_App1
			Launch_App2
			Launch_Mail
			Launch_Media
			LButton
			LControl
			LCtrl
			Left
			LShift
			LWin
			M
			MButton
			Media_Next
			Media_Play_Pause
			Media_Prev
			Media_Stop
			N
			NumLock
			Numpad0
			Numpad1
			Numpad2
			Numpad3
			Numpad4
			Numpad5
			Numpad6
			Numpad7
			Numpad8
			Numpad9
			NumpadAdd
			NumpadClear
			NumpadDel
			NumpadDiv
			NumpadDot
			NumpadDown
			NumpadEnd
			NumpadEnter
			NumpadHome
			NumpadIns
			NumpadLeft
			NumpadMult
			NumpadPgDn
			NumpadPgUp
			NumpadRight
			NumpadSub
			NumpadUp
			O
			P
			Pause
			PgDn
			PgUp
			PrintScreen
			Q
			R
			RAlt
			RButton
			RControl
			RCtrl
			Return
			Right
			RShift
			RWin
			S
			SCnnn
			ScrollLock
			Shift
			Sleep
			Space
			T
			Tab
			U
			Up
			V
			VKnn
			Volume_Down
			Volume_Mute
			Volume_Up
			W
			WheelDown
			WheelLeft
			WheelRight
			WheelUp
			X
			XButton1
			XButton2
			Y
			Z
			*/

			/*
			%A_Space%   hotKey`(hotKeyStr, action, condition:="", params*`)
			%A_Space%       hotKeyStr - string representing the HotKey
			%A_Space%       action    - function to call, OR label to go to, OR text to send
			%A_Space%                       - passing a blank value will delete any existing HotKey
			%A_Space%                       - this can be useful to allow a HotKey to trigger until some conditional has been met
			%A_Space%       mode      - the operating mode of the trigger  `(default = Normal`)
			%A_Space%                       - hs.const.REPLACE_MODE.Normal `(or 1`)  -  `(case-insensitive`)
			%A_Space%                       - hs.const.REPLACE_MODE.Case   `(or 2`)  -  `(case-sensitive`)
			%A_Space%                       - hs.const.REPLACE_MODE.Regex  `(or 3`)  -  `(regular expression`)
			%A_Space%       condition - `(optional`) either a function name that must return true or false if the action should be
			%A_Space%                   executed OR a string in the format of "ahk_xxx yyy" that must match the current window
			%A_Space%                       - See AutoHotkey help for: ahk_class, ahk_exe_ ahk_group, ahk_id, ahk_pid
			%A_Space%                       - Example: "ahk_class ConsoleWindowClass"
			%A_Space%                           - This would restrict the action to executing only for windows that are a "console"
			%A_Space%                             application such as DOS or PowerShell.  Information on any window can be found by
			%A_Space%                             right-clicking the system tray icon for HotScript and selecting "Window Spy".
			%A_Space%       params    - `(optional`) any parameter(s) to be passed to action, if it is a function

			%A_Space%   Only the first two parameters are required.
			%A_Space%       - "condition" is optional
			%A_Space%       - "params" can be any number of parameters to be passed to the function referenced by "action"


			Examples:

			%A_Space%   hotKey("^!+m", "This text will be automatically typed.")
			%A_Space%       - executed when Ctrl-Alt-Shift-M is pressed
			%A_Space%   hotKey("#b", "myFunc")
			%A_Space%       - executed when Win-B is pressed
			%A_Space%       - if "myFunc" is an existing function or label, it will be executed
			%A_Space%       - otherwise the literal text "myFunc" will be typed

			By calling a user-defined function, very advanced functionality or output may be created.

			Some examples within HotScript are: hkWindowResizeToAnchor(), hkTextDeleteToEol() or hkTextDeleteNextWord()
			*/

		)
		FileAppend(contents, file)
	}
	file := hs.file.USER_STRINGS
	if (FileExist(file) == "") {
		contents =
		(LTrim Join`r`n
			; All user-defined HotStrings should be declared below.
			; All HotScript or user-defined functions are available for use here.

			/*
			%A_Space%   hotString`(trigger, replace, mode, clear, condition`)
			%A_Space%       trigger   - string or regex to trigger the action
			%A_Space%       replace   - string to replace trigger, OR function to call, OR label to go to
			%A_Space%                       - passing a blank value will delete any existing HotString for the specified trigger
			%A_Space%                       - this can be useful to allow a HotString to trigger until some conditional has been met
			%A_Space%       mode      - the operating mode of the trigger  `(default = Normal`)
			%A_Space%                       - hs.const.REPLACE_MODE.Normal `(or 1`)  -  `(case-insensitive`)
			%A_Space%                       - hs.const.REPLACE_MODE.Case   `(or 2`)  -  `(case-sensitive`)
			%A_Space%                       - hs.const.REPLACE_MODE.Regex  `(or 3`)  -  `(regular expression`)
			%A_Space%       clear     - `(optional`) true if the trigger should be erased, false to leave the trigger `(default = true`)
			%A_Space%       condition - `(optional`) function name that must return true or false if the action should be executed

			%A_Space%   Only the first two parameters are required.
			%A_Space%       - "mode" defaults to case-insentive `(1`), if not specified
			%A_Space%       - "clear" defaults to true, if not specified
			%A_Space%       - "condition" is optional


			Examples:

			%A_Space%   hotString`("hw", "Hello World."`)
			%A_Space%       - when "hw" is typed it is replaced with "Hello World."
			%A_Space%   hotString`("hw", ""`)
			%A_Space%       - the HotString for "hw" is now deleted and is no longer active
			%A_Space%       - typing "hw" now has no special meaning
			%A_Space%   hotString`("@math", "myMath"`)
			%A_Space%       - if "myMath" exists as a function, it is called
			%A_Space%       - if "myMath" exists as a label, it is called
			%A_Space%       - otherwise the text "myMath" will be used
			%A_Space%   hotString`("gett", "ing much more efficient, with HotScript!", 1, false`)
			%A_Space%       - leaves the typed trigger of "gett"
			%A_Space%       - creates the remaining text of "ing much more efficient, with HotScript!"
			%A_Space%   hotString`("myTest", "Conditional testing worked!",, true, "myTestFunc"`)
			%A_Space%       - defaults to case-insensitive because no value was specified for "mode"
			%A_Space%       - if myTestFunc exists, it is called
			%A_Space%           - if it returns true, the HotString will be triggered
			%A_Space%           - if it returns false, the HotString will be ignored
			%A_Space%       - if myTestFunc does not exist, the HotString will be triggered
			%A_Space%   hotString`("aBc", "This is case-sensitive!", 2`)
			%A_Space%   hotString`("\w{3}\d{3}", "Three letters and three numbers...", 3`)
			%A_Space%       - when typing any three letters followed by three numbers, this HotString is triggered

			By calling a user-defined function, very advanced functionality or output may be created.
			*/

		)
		FileAppend(contents, file)
	}
	file := hs.file.USER_VARIABLES
	if (FileExist(file) == "") {
		contents =
		(LTrim Join`r`n
			; All user-defined variables should be declared below.
			; Variables defined here can be used referenced by HotScriptFunctions.ahk, HotScriptKeys.ahk or HotScriptStrings.ahk.
			; All variables should be declared with "global" to make them easily accessible by other HotScript modules and functions.

		)
		FileAppend(contents, file)
	}
	file := hs.file.USER_INCLUDES
	if (FileExist(file) == "") {
		contents =
		(LTrim Join`r`n
			; All user-defined includes should be listed below.
			; Include files allow custom functionality and modules to be created and easily shared with other users by keeping
			; all related functionality together in a single file.

			/*
			%A_Space%   Add new include files in this format:
			%A_Space%       #Include *i MyCustomStuff.ahk
			%A_Space%       #Include *i WorkStuff.ahk

			%A_Space%   Filenames do not need to have an ".ahk" extension. As long as the file is just a plain text file, it can be named anything.
			%A_Space%       #Include *i RandomThings.txt

			%A_Space%   Files can include the full path.
			%A_Space%       #Include *i D:\work\My Stuff\CustomFuncs.ahk

			%A_Space%   Notes:
			%A_Space%       * The "*i" tells HotScript to ignore any errors if the file cannot be loaded (e.g.: the file is missing)
			%A_Space%       * If a filename does not specify a path, it is assumed to be in the same location of the HotScript folder.
			%A_Space%       * It may be necessary to load these files in a certain order if they have dependencies on other files, functions, or variables.
			*/

		)
		FileAppend(contents, file)
	}
}

crypt(text) {
	result := ""
	Loop, Parse, text
	{
		ascii := Asc(A_LoopField)
		if (ascii < 32) {
			result .= A_LoopField
		}
		else {
			result .= Chr(Asc(A_LoopField) ^ 129)
		}
	}
	return result
}

cryptSelected() {
	selText := getSelectedText()
	if (selText != "") {
		replaceSelected(crypt(selText))
	}
}

debug(str, prefix:="") {
	if (prefix == "") {
		prefix := hs.TITLE . ": "
	}
	OutputDebug % prefix . str
}

debugVar(name, value:="{empty}") {
	if (value == "{empty}") {
		value := getVar(name)
	}
	debug(name . " = [" . value . "]")
}

deepCopy(obj) {
	newObj := ObjClone(obj)
	for k, v in newObj {
		if (IsObject(v)) {
			newObj[k] := deepCopy(v)
		}
	}
	return newObj
}

deleteBlankLines() {
	selText := getSelectedText()
	if (selText == "") {
		SendInput, ^a
		selText := getSelectedText()
	}
	if (selText != "") {
		eol := getEol(selText)
		hasEol := endsWith(selText, eol)
		if (hasEol) {
			selText := SubStr(selText, 1, 0 - StrLen(eol))
		}
		newText := ""
		Loop, Parse, selText, % hs.const.EOL_NIX, % hs.const.EOL_MAC
		{
			if (A_LoopField != "") {
				newText .= A_LoopField . eol
			}
		}
		if (!hasEol) {
			newText := SubStr(newText, 1, 0 - StrLen(eol))
		}
		replaceSelected(newText)
	}
}

deleteCurrentLine() {
	selText := getCurrentLine()
	SendInput, {Delete}
}

deprecatedFunc(replacement:="") {
	replacement := (replacement == "" ? "" : "`n`nReplacement:`t" . replacement . "()")
	message(func . " has been deprecated!" . replacement . getStackTraceStr(), "Deprecated - " . getSelf(1) . "()", 48)
}

deprecatedParam(param, value) {
	isOK := true
	if (value != "deprecated") {
		message("Parameter '" . param . "' for " . getSelf(1) . "() has been deprecated!" . getStackTraceStr(), "Deprecated - " . param, 48)
		isOK := false
	}
	return isOK
}

duplicateCurrentLine() {
	selText := getCurrentLine()
	eol := getEol(selText)
	hasEol := endsWith(selText, eol)
	if (hasEol) {
		SendInput, {Up}
	}
	else {
		SendInput, {Home}
	}
	sendText(selText)
	if (hasEol) {
		SendInput, {Up}
	}
	else {
		SendInput, {Enter}{Home}{Up}
	}
}

equals(a, b) {
	return (a == b)
}

equalsIgnoreCase(a, b) {
	a := setCase(a, "L")
	b := setCase(b, "L")
	return equals(a, b)
}

endsWith(str, value, caseInsensitive:="") {
	if (toBool(caseInsensitive)) {
		str := setCase(str, "L")
		value := setCase(value, "L")
	}
	tmp := StringRight(str, StrLen(value))
	return (tmp == value)
}

escapeText(text:="") {
	isSelected := false
	if (text == "") {
		text := getSelectedText()
		isSelected := true
	}
	if (text != "") {
		text := StrReplace(text, "``", "````")
		text := StrReplace(text, "%", "``%")
		text := StrReplace(text, "(", "``(")
		text := StrReplace(text, ")", "``)")
		if (isSelected) {
			replaceSelected(text)
		}
	}
	if (!isSelected) {
		return text
	}
}

extractJiraStyle(setting) {
	RegexMatch(setting, "i)borderStyle=(\w+)", borderStyle)
	RegexMatch(setting, "i)borderColor=(#\w+)", borderColor)
	RegexMatch(setting, "i)titleBGColor=(#\w+)", bgColor)
	return "border:.15em " . borderStyle1 . " " . borderColor1 . ";background:" . bgColor1
}

extractLocationAndResize() {
	if (isSelf()) {
		splash("Cannot resize " . hs.TITLE . " windows...")
		return
	}
	curMon := hs.vars.monitors[getMonitorForWindow()]
	hWnd := getHwnd()
	WinGetPos, WinX, WinY, WinW, WinH, ahk_id %hWnd%
	self := getSelf(1)
	if (RegexMatch(self, "(?:hkWindowR|r)esizeTo(\dx\d)_(\d{1,2})", match)) {
		keepSize := GetKeyState("ScrollLock", "T")
		; TODO - this should also be for Start Menu, SysTray, and maybe others...
		; TODO - need to adjust for Windows 10 calculator, too - Brady1 pushes it too far down
		if (isActiveCalculator()) {
			splash("Current window cannot be resized.", 2000)
			return
		}
		dimension := match1
		position := match2
		if (dimension == "3x3" && GetKeyState("Shift", "p")) {
			; necessary because AHK does not register Shift-Win-NumPad keys but instead it fires as though Win-NumPad key was pressed with the NumLock being toggled
			dimension := "3x2"
			if (position > 6) {
				return
			}
		}
		origDelay := A_WinDelay
		SetWinDelay, 0
		RegexMatch(dimension, "(\d)x(\d)", dimCount)
		widthCount := dimCount1
		heightCount := dimCount2
		height50 := (curMon.workHeight / 2)
		height33 := (curMon.workHeight / 3)
		height25 := (curMon.workHeight / 4)
		width50 := (curMon.workWidth / 2)
		width33 := (curMon.workWidth / 3)
		width25 := (curMon.workWidth / 4)
		if (dimension == "1x2") {
			; 100% width, 50% height
			newX := curMon.workLeft
			newY := curMon.workTop + (height50 * (heightCount - position))
			newH := height50
			newW := curMon.workWidth
		}
		else if (dimension == "1x3") {
			; 100% width, 33% height
			newX := curMon.workLeft
			newY := (curMon.workTop + (height33 * (heightCount - position)))
			newH := height33
			newW := curMon.workWidth
		}
		else if (dimension == "1x4") {
			; 100% width, 25% height
			newX := curMon.workLeft
			newY := (curMon.workTop + (height25 * (heightCount - position)))
			newH := height25
			newW := curMon.workWidth
		}
		else if (dimension == "2x1") {
			; 50% width, 100% height
			newX := curMon.workLeft + (width50 * (position - 1))
			newY := curMon.workTop
			newH := curMon.workHeight
			newW := width50
		}
		else if (dimension == "2x2") {
			; 50% width, 50% height
			newX := curMon.workLeft + (width50 * Abs(1 - (Mod(position, widthCount))))
			newY := curMon.workTop + (height50 * (position < 3 ? 1 : 0))
			newH := height50
			newW := width50
		}
		else if (dimension == "2x3") {
			; 50% width, 33% height
			newX := curMon.workLeft + (width50 * (1 - Mod(position, widthCount)))
			newY := curMon.workTop + (height33 * (position < 3 ? 2 : position < 5 ? 1 : 0))
			newH := height33
			newW := width50
		}
		else if (dimension == "2x4") {
			; 50% width, 25% height
			newX := curMon.workLeft + (width50 * (1 - Mod(position, widthCount)))
			newY := curMon.workTop + (height25 * (position < 3 ? 3 : position < 5 ? 2 : position < 7 ? 1 : 0))
			newH := height25
			newW := width50
		}
		else if (dimension == "3x1") {
			; 33% width, 100% height
			newX := curMon.workLeft + (width33 * (position - 1))
			newY := curMon.workTop
			newH := curMon.workHeight
			newW := width33
		}
		else if (dimension == "3x2") {
			; 33% width, 50% height
			xMap := {0:2, 1:0, 2:1}
			newX := curMon.workLeft + (width33 * xMap[Mod(position, widthCount)])
			newY := curMon.workTop + (height50 * (position < 4 ? 1 : 0))
			newH := height50
			newW := width33
		}
		else if (dimension == "3x3") {
			; 33% width, 33% height
			xMap := {0:2, 1:0, 2:1}
			newX := curMon.workLeft + (width33 * xMap[Mod(position, widthCount)])
			newY := curMon.workTop + (height33 * (position < 4 ? 2 : position < 7 ? 1 : 0))
			newH := height33
			newW := width33
		}
		else if (dimension == "3x4") {
			; 33% width, 25% height
			xMap := {0:2, 1:0, 2:1}
			newX := curMon.workLeft + (width33 * xMap[Mod(position, widthCount)])
			newY := curMon.workTop + (height25 * (position < 4 ? 3 : position < 7 ? 2 : position < 10 ? 1 : 0))
			newH := height25
			newW := width33
		}
		else if (dimension == "4x1") {
			; 25% width, 100% height
			newX := curMon.workLeft + (width25 * (position - 1))
			newY := curMon.workTop
			newH := curMon.workHeight
			newW := width25
		}
		else if (dimension == "4x2") {
			; 25% width, 50% height
			xMap := {0:3, 1:0, 2:1, 3:2}
			newX := curMon.workLeft + (width25 * xMap[Mod(position, widthCount)])
			newY := curMon.workTop + (height50 * (position < 5 ? 1 : 0))
			newH := height50
			newW := width25
		}
		else if (dimension == "4x3") {
			; 25% width, 33% height
			xMap := {0:3, 1:0, 2:1, 3:2}
			newX := curMon.workLeft + (width25 * xMap[Mod(position, widthCount)])
			newY := curMon.workTop + (height33 * (position < 5 ? 2 : position < 9 ? 1 : 0))
			newH := height33
			newW := width25
		}
		else if (dimension == "4x4") {
			; 25% width, 25% height
			xMap := {0:3, 1:0, 2:1, 3:2}
			newX := curMon.workLeft + (width25 * xMap[Mod(position, widthCount)])
			newY := curMon.workTop + (height25 * (position < 5 ? 3 : position < 9 ? 2 : position < 13 ? 1 : 0))
			newH := height25
			newW := width25
		}
		else {
			message("Cannot resize window - unknown caller: " . self)
			return
		}
		; Windows 10 adjustments
		if (isWin10()) {
			newX += -6
			newY += -1
			newW += 16
			newH += 8
		}
		if (keepSize) {
			newW := WinW
			newH := WinH
		}
	}
	else {
		GAP := 20
		if (self == "resizeToHeight") {
			newX := WinX
			newW := WinW
			if (Abs(WinW - curMon.workWidth) <= GAP) {
				top := ""
				height := ""
				Loop, % hs.vars.monitors.count {
					mon := hs.vars.monitors[A_Index]
					if (top == "" || mon.workTop < top) {
						top := mon.workTop
					}
					if (height == "" || mon.workBottom > height) {
						height := mon.workBottom
					}
				}
				newY := top
				newH := height
			}
			else {
				newY := curMon.workTop
				newH := curMon.workBottom
			}
			; Windows 10 adjustments
			if (isWin10()) {
				newY += -1
				newH += 7
			}
		}
		else if (self == "resizeToWidth") {
			newY := WinY
			newH := WinH
			if (Abs(WinW - curMon.workWidth) <= GAP) {
				left := ""
				width := ""
				Loop, % hs.vars.monitors.count {
					mon := hs.vars.monitors[A_Index]
					if (left == "" || mon.workLeft < left) {
						left := mon.workLeft
					}
					if (width == "" || mon.workRight > width) {
						width := mon.workRight
					}
				}
				newX := left
				newW := width
			}
			else {
				newX := curMon.workLeft
				newW := curMon.workWidth
			}
			; Windows 10 adjustments
			if (isWin10()) {
				newX += -6
				newW += 16
			}
		}
		else {
			message("Cannot resize window - unknown caller: " . self)
			return
		}
	}
	WinGet, minMaxState, MinMax, ahk_id %hWnd%
	if (minMaxState == 1) {
		WinRestore, ahk_id %hWnd%
	}
	WinMove, ahk_id %hWnd%,, %newX%, %newY%, %newW%, %newH%
	SetWinDelay, %origDelay%
}

extractNumClip() {
	numClip := "Unknown"
	; this only works if the default HotKeys are still in use and not changed by the user
	key := StrReplace(StrReplace(A_ThisHotKey, "Numpad", ""), "^#", "")
	if (RegexMatch(key, "\d+", num)) {
		numClip := num
	}
	else {
		if (key == "End") {
			numClip := 1
		}
		else if (key == "Down") {
			numClip := 2
		}
		else if (key == "PgDn") {
			numClip := 3
		}
		else if (key == "Left") {
			numClip := 4
		}
		else if (key == "Clear") {
			numClip := 5
		}
		else if (key == "Right") {
			numClip := 6
		}
		else if (key == "Home") {
			numClip := 7
		}
		else if (key == "Up") {
			numClip := 8
		}
		else if (key == "PgUp") {
			numClip := 9
		}
		else if (key == "Ins") {
			numClip := 0
		}
	}
	if (numClip == 0) {
		numClip := 10
	}
	return numClip
}

findAndRun(exe) {
	file := findOnPath(exe)
	if (file == "") {
		winVer := RegRead("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion", "ProductName")
		msg := ""
		if (contains(winVer, "2008", "2012")) {
			msg := "`n`nFor Windows Server 2008 or 2012, you may need to install 'Themes' or 'Desktop Experience'."
		}
		message("Unable to locate " . exe . " on the PATH." . msg, "File not found", 48)
	}
	else {
		Run(file)
	}
}

findCalculator() {
	if (isWin10()) {
		; TODO - this is a poor workround and will not work for any other language than English
		; When it is not *really* running, but has a thread running in the background, showWindowInfo()
		/*
			Window State: Windowed
			Class           : Windows.UI.Core.CoreWindow
			Style           : 0x94000000
			ExStyle         : 0x00200000
			isAppWindow     : false
			isChild         : false
			isControlParent : false
			isDisabled      : false
			isHung          : false
			isPopup         : true
			isSuspended     : true
			isToolWindow    : false
			isVisible       : true
		*/
		hWnd := getHwnd("Calculator")
		calcWin := getWindowInfo(hWnd)
		if (calcWin.isSuspended) {
			hWnd := 0
		}
	}
	else {
		hWnd := getHwnd("ahk_exe i)calc.exe")
	}
	return hWnd
}

findOnPath(filename) {
	target := ""
	if (FileExist(filename) != "") {
		target := filename
	}
	else {
		SplitPath(filename, findName)
		paths := EnvGet("Path")
		StringSplit, pathArray, paths, `;
		Loop, % pathArray0 {
			file := StrReplace(pathArray%A_Index% . "\", "\\", "\") . findName
			if (FileExist(file) != "") {
				target := file
				break
			}
		}
	}
	return target
}

findOrRunByExe(name) {
	exe := name . ".exe"
	if (name == "calc") {
		hWnd := findCalculator()
	}
	else {
		hWnd := getHwnd("ahk_exe i)" . exe)
	}
	if (hWnd) {
		WinActivate, ahk_id %hWnd%
	}
	else {
		runTarget(exe)
	}
}

findWindow(title) {
	dhw := A_DetectHiddenWindows
	DetectHiddenWindows, Off
	result := getHwnd(title)
	DetectHiddenWindows, %dhw%
}

findWindows(title) {
	dhw := A_DetectHiddenWindows
	DetectHiddenWindows, Off
	result := []
	WinGet, winArray, List, % title
	Loop, % winArray {
		result.Insert(winArray%A_Index%)
	}
	DetectHiddenWindows, %dhw%
	return result
}

fontSelect(fonts*) {
	static defaultFont := new Font().size(9)
	result := false
	for i, aFont in fonts {
		if (aFont.__Class == "Font" && aFont.isUsable()) {
			result := aFont
			break
		}
	}
	if (!result) {
		result := defaultFont
	}
	return result
}

getActiveProcessID() {
	WinGet, procName, ProcessName, A
	if (procName == "ApplicationFrameHost.exe") {
		ControlGet, hWnd, hWnd,, Windows.UI.Core.CoreWindow1, A
		if (hWnd) {
			WinGet, procPID, PID, ahk_id %hWnd%
		}
	}
	else {
		WinGet, procPID, PID, A
	}
	return procPID
}

getActiveProcessName() {
	WinGet, procName, ProcessName, A
	if (procName == "ApplicationFrameHost.exe") {
		ControlGet, hWnd, hWnd,, Windows.UI.Core.CoreWindow1, A
		if (hWnd) {
			WinGet, procName, ProcessName, ahk_id %hWnd%
		}
	}
	return procName
}

getCenter(winW, winH, monitor:="") {
	if (monitor == "" || equalsIgnoreCase(monitor, "A")) {
		monitor := getMonitorForWindow()
	}
	else {
		if (monitor < hs.vars.monitors.count) {
			monitor := 1
		}
		else if (monitor > hs.vars.monitors.count) {
			monitor := hs.vars.monitors.count
		}
	}
	coord := {
		(LTrim Comments Join,
			height: 0
			width: 0
			x: 0
			y: 0
		)}
	targetMon := hs.vars.monitors[monitor]
	newX := targetMon.left + (targetMon.workWidth / 2) - (winW / 2)
	newY := targetMon.top + (targetMon.workHeight / 2) - (winH / 2)
	coord.x := newX
	coord.y := newY
	return coord
}

getCurrentLine() {
	selectCurrentLine()
	return getSelectedText()
}

getDefaultHotKeyDefs(type) {
	hk := {}
	if (type == "hkAutomation") {
		hk["hkAutomationCalculator"] := "#c"
		hk["hkAutomationCharacterMap"] := "#m"
		hk["hkAutomationControlPanel"] := "^RCtrl"
		hk["hkAutomationDosPrompt"] := "#d"
		hk["hkAutomationDosPromptInExplorer"] := "!#d"
		hk["hkAutomationEditor"] := "#e"
		hk["hkAutomationGoogleSearch"] := "#g"
		hk["hkAutomationQuickLookup"] := "#q"
		hk["hkAutomationStartupFolder"] := "!#s"
		hk["hkAutomationTempFolder"] := "!#t"
		hk["hkAutomationUserMenu"] := "#u"
		hk["hkAutomationWindowsExplorer"] := "#x"
		hk["hkAutomationWindowsServices"] := "#s"
		hk["hkAutomationWindowsSnip"] := "#PrintScreen"
	}
	else if (type == "hkClipboard") {
		hk["hkClipboardClear"] := "^#Delete"
		hk["hkClipboardClearAll"] := "!#Delete"
		hk["hkClipboardCopyAppend"] := "^#a"
		hk["hkClipboardCutAppend"] := "^#x"
		hk["hkClipboardPaste-01"] := "^v"
		hk["hkClipboardPaste-02"] := "+Insert"
		hk["hkClipboardPasteAll"] := "^#v"
		hk["hkClipboardPasteAsText"] := "^!v"
		hk["hkClipboardPasteEnter"] := "#Enter"
		hk["hkClipboardPasteTab"] := "#Tab"
		hk["hkClipboardPreview"] := "#v"
		hk["hkClipboardSwapToClipboard"] := "^#s"
		hk["hkClipboardToggleQueue"] := "^#q"
		hk["hkClipboardUseMultiClip"] := "^#m"
		hk["hkClipboardUseNumClip-01"] := "^#F1"
		hk["hkClipboardUseNumClip-02"] := "^#F2"
		hk["hkClipboardUseNumClip-03"] := "^#F3"
		hk["hkClipboardUseNumClip-04"] := "^#F4"
		hk["hkClipboardUseNumClip-05"] := "^#F5"
		hk["hkClipboardUseNumClip-06"] := "^#F6"
		hk["hkClipboardUseNumClip-07"] := "^#F7"
		hk["hkClipboardUseNumClip-08"] := "^#F8"
		hk["hkClipboardUseNumClip-09"] := "^#F9"
		hk["hkClipboardUseNumClip-10"] := "^#F10"
		hk["hkClipboardCopyToNumClip-01"] := "^#1"
		hk["hkClipboardCopyToNumClip-02"] := "^#Numpad1"
		hk["hkClipboardCopyToNumClip-03"] := "^#NumpadEnd"
		hk["hkClipboardCopyToNumClip-04"] := "^#2"
		hk["hkClipboardCopyToNumClip-05"] := "^#Numpad2"
		hk["hkClipboardCopyToNumClip-06"] := "^#NumpadDown"
		hk["hkClipboardCopyToNumClip-07"] := "^#3"
		hk["hkClipboardCopyToNumClip-08"] := "^#Numpad3"
		hk["hkClipboardCopyToNumClip-09"] := "^#NumpadPgDn"
		hk["hkClipboardCopyToNumClip-10"] := "^#4"
		hk["hkClipboardCopyToNumClip-11"] := "^#Numpad4"
		hk["hkClipboardCopyToNumClip-12"] := "^#NumpadLeft"
		hk["hkClipboardCopyToNumClip-13"] := "^#5"
		hk["hkClipboardCopyToNumClip-14"] := "^#Numpad5"
		hk["hkClipboardCopyToNumClip-15"] := "^#NumpadClear"
		hk["hkClipboardCopyToNumClip-16"] := "^#6"
		hk["hkClipboardCopyToNumClip-17"] := "^#Numpad6"
		hk["hkClipboardCopyToNumClip-18"] := "^#NumpadRight"
		hk["hkClipboardCopyToNumClip-19"] := "^#7"
		hk["hkClipboardCopyToNumClip-20"] := "^#Numpad7"
		hk["hkClipboardCopyToNumClip-21"] := "^#NumpadHome"
		hk["hkClipboardCopyToNumClip-22"] := "^#8"
		hk["hkClipboardCopyToNumClip-23"] := "^#Numpad8"
		hk["hkClipboardCopyToNumClip-24"] := "^#NumpadUp"
		hk["hkClipboardCopyToNumClip-25"] := "^#9"
		hk["hkClipboardCopyToNumClip-26"] := "^#Numpad9"
		hk["hkClipboardCopyToNumClip-27"] := "^#NumpadPgUp"
		hk["hkClipboardCopyToNumClip-28"] := "^#0"
		hk["hkClipboardCopyToNumClip-29"] := "^#Numpad0"
		hk["hkClipboardCopyToNumClip-30"] := "^#NumpadIns"
		hk["hkClipboardPasteNumClip-01"] := "+#1"
		hk["hkClipboardPasteNumClip-02"] := "+#Numpad1"
		hk["hkClipboardPasteNumClip-03"] := "+#NumpadEnd"
		hk["hkClipboardPasteNumClip-04"] := "+#2"
		hk["hkClipboardPasteNumClip-05"] := "+#Numpad2"
		hk["hkClipboardPasteNumClip-06"] := "+#NumpadDown"
		hk["hkClipboardPasteNumClip-07"] := "+#3"
		hk["hkClipboardPasteNumClip-08"] := "+#Numpad3"
		hk["hkClipboardPasteNumClip-09"] := "+#NumpadPgDn"
		hk["hkClipboardPasteNumClip-10"] := "+#4"
		hk["hkClipboardPasteNumClip-11"] := "+#Numpad4"
		hk["hkClipboardPasteNumClip-12"] := "+#NumpadLeft"
		hk["hkClipboardPasteNumClip-13"] := "+#5"
		hk["hkClipboardPasteNumClip-14"] := "+#Numpad5"
		hk["hkClipboardPasteNumClip-15"] := "+#NumpadClear"
		hk["hkClipboardPasteNumClip-16"] := "+#6"
		hk["hkClipboardPasteNumClip-17"] := "+#Numpad6"
		hk["hkClipboardPasteNumClip-18"] := "+#NumpadRight"
		hk["hkClipboardPasteNumClip-19"] := "+#7"
		hk["hkClipboardPasteNumClip-20"] := "+#Numpad7"
		hk["hkClipboardPasteNumClip-21"] := "+#NumpadHome"
		hk["hkClipboardPasteNumClip-22"] := "+#8"
		hk["hkClipboardPasteNumClip-23"] := "+#Numpad8"
		hk["hkClipboardPasteNumClip-24"] := "+#NumpadUp"
		hk["hkClipboardPasteNumClip-25"] := "+#9"
		hk["hkClipboardPasteNumClip-26"] := "+#Numpad9"
		hk["hkClipboardPasteNumClip-27"] := "+#NumpadPgUp"
		hk["hkClipboardPasteNumClip-28"] := "+#0"
		hk["hkClipboardPasteNumClip-29"] := "+#Numpad0"
		hk["hkClipboardPasteNumClip-30"] := "+#NumpadIns"
		hk["hkClipboardPasteNumClipAsText-01"] := "!#1"
		hk["hkClipboardPasteNumClipAsText-02"] := "!#Numpad1"
		hk["hkClipboardPasteNumClipAsText-03"] := "!#NumpadEnd"
		hk["hkClipboardPasteNumClipAsText-04"] := "!#2"
		hk["hkClipboardPasteNumClipAsText-05"] := "!#Numpad2"
		hk["hkClipboardPasteNumClipAsText-06"] := "!#NumpadDown"
		hk["hkClipboardPasteNumClipAsText-07"] := "!#3"
		hk["hkClipboardPasteNumClipAsText-08"] := "!#Numpad3"
		hk["hkClipboardPasteNumClipAsText-09"] := "!#NumpadPgDn"
		hk["hkClipboardPasteNumClipAsText-10"] := "!#4"
		hk["hkClipboardPasteNumClipAsText-11"] := "!#Numpad4"
		hk["hkClipboardPasteNumClipAsText-12"] := "!#NumpadLeft"
		hk["hkClipboardPasteNumClipAsText-13"] := "!#5"
		hk["hkClipboardPasteNumClipAsText-14"] := "!#Numpad5"
		hk["hkClipboardPasteNumClipAsText-15"] := "!#NumpadClear"
		hk["hkClipboardPasteNumClipAsText-16"] := "!#6"
		hk["hkClipboardPasteNumClipAsText-17"] := "!#Numpad6"
		hk["hkClipboardPasteNumClipAsText-18"] := "!#NumpadRight"
		hk["hkClipboardPasteNumClipAsText-19"] := "!#7"
		hk["hkClipboardPasteNumClipAsText-20"] := "!#Numpad7"
		hk["hkClipboardPasteNumClipAsText-21"] := "!#NumpadHome"
		hk["hkClipboardPasteNumClipAsText-22"] := "!#8"
		hk["hkClipboardPasteNumClipAsText-23"] := "!#Numpad8"
		hk["hkClipboardPasteNumClipAsText-24"] := "!#NumpadUp"
		hk["hkClipboardPasteNumClipAsText-25"] := "!#9"
		hk["hkClipboardPasteNumClipAsText-26"] := "!#Numpad9"
		hk["hkClipboardPasteNumClipAsText-27"] := "!#NumpadPgUp"
		hk["hkClipboardPasteNumClipAsText-28"] := "!#0"
		hk["hkClipboardPasteNumClipAsText-29"] := "!#Numpad0"
		hk["hkClipboardPasteNumClipAsText-30"] := "!#NumpadIns"
		hk["hkClipboardUseWindowsClipboard"] := "^#w"
	}
	else if (type == "hkCommandLine") {
		hk["hkCommandLineCdParent-01"] := "!."
		hk["hkCommandLineCdParent-02"] := "!Up"
		hk["hkCommandLineClear"] := "Escape"
		hk["hkCommandLineCopy"] := "!c"
		hk["hkCommandLineDownloads"] := "!d"
		hk["hkCommandLineExit"] := "!x"
		hk["hkCommandLineMove"] := "!m"
		hk["hkCommandLinePopd"] := "^p"
		hk["hkCommandLinePushd"] := "!p"
		hk["hkCommandLineRoot"] := "!r"
		hk["hkCommandLineScrollBottom"] := "^End"
		hk["hkCommandLineScrollDown"] := "^Down"
		hk["hkCommandLineScrollPageDown"] := "^PgDn"
		hk["hkCommandLineScrollPageUp"] := "^PgUp"
		hk["hkCommandLineScrollTop"] := "^Home"
		hk["hkCommandLineScrollUp"] := "^Up"
		hk["hkCommandLineStart"] := "^."
		hk["hkCommandLineType"] := "!t"
	}
	else if (type == "hkEpp") {
		hk["hkEppGoToLine"] := "^g"
;		 hk["hkEppNextFile"] := "XButton2"
;		 hk["hkMiscMouseForward"] := "XButton2"
;		 hk["hkEppPrevFile"] := "XButton1"
;		 hk["hkMiscMouseBack"] := "XButton1"
	}
	else if (type == "hkHotScript") {
		hk["hkHotScriptMenu"] := "#F12"
		hk["hkHotScriptPauseHotKeys"] := "Escape & k"
		hk["hkHotScriptPauseHotScript"] := "Escape & h"
		hk["hkHotScriptPauseHotStrings"] := "Escape & s"
		hk["hkHotScriptQuickHelp"] := "#h"
	}
	else if (type == "hkMisc") {
		hk["hkMiscCreateFile"] := "^!f"
		hk["hkMiscCreateFolder"] := "^!d"
;		 hk["hkMiscExplorerBack"] := "XButton2"
;		 hk["hkMiscExplorerUpOneLevel"] := "XButton1"
		hk["hkMiscMouseBack"] := "XButton1"
		hk["hkMiscMouseForward"] := "XButton2"
		hk["hkMiscToggleDesktop"] := "#Esc"
		hk["hkMiscToggleDesktopIcons"] := "#AppsKey"
	}
	else if (type == "hkMouse") {
		hk["hkMouseCenterMouseScreen-01"] := "^CapsLock"
		hk["hkMouseCenterMouseScreen-02"] := "^#LButton"
		hk["hkMouseCenterMouseWindow-01"] := "+CapsLock"
		hk["hkMouseCenterMouseWindow-02"] := "+#LButton"
		hk["hkMouseDragDown"] := "^!#Down"
		hk["hkMouseDragLeft"] := "^!#Left"
		hk["hkMouseDragRight"] := "^!#Right"
		hk["hkMouseDragUp"] := "^!#Up"
		hk["hkMouseMoveDown"] := "^+#Down"
		hk["hkMouseMoveLeft"] := "^+#Left"
		hk["hkMouseMoveRight"] := "^+#Right"
		hk["hkMouseMoveUp"] := "^+#Up"
	}
	else if (type == "hkText") {
		hk["hkTextDeleteBlankLines"] := "^!Space"
		hk["hkTextDeleteCurrentLine"] := "!Delete"
		hk["hkTextDeleteToEol"] := "^Delete"
		hk["hkTextDeleteToSol"] := "^+Delete"
		hk["hkTextDeleteNextWord"] := "^d"
		hk["hkTextDeletePrevWord"] := "^Backspace"
		hk["hkTextDuplicateCurrentLineDown"] := "^+Down"
		hk["hkTextDuplicateCurrentLineUp"] := "^+Up"
		hk["hkTextEndBackspaceDown"] := "^!Backspace"
		hk["hkTextMoveCurrentLineDown"] := "!Down"
		hk["hkTextMoveCurrentLineUp"] := "!Up"
		hk["hkTextTrimLines"] := "^!."
		hk["hkTextUpEndDelete"] := "!End"
	}
	else if (type == "hkTransform") {
		hk["hkTransformCurlyQuotes"] := "^+'"
		hk["hkTransformEncrypt"] := "^+e"
		hk["hkTransformEscape"] := "^+``"
		hk["hkTransformInvertCase"] := "^+i"
		hk["hkTransformLowerCase"] := "^+l"
		hk["hkTransformMySqlUpper"] := "^+m"
		hk["hkTransformNumberPrepend"] := "^+n"
		hk["hkTransformNumberPrependPrompt"] := "^!+n"
		hk["hkTransformNumberStrip"] := "^!n"
		hk["hkTransformOracleUpper"] := "^+o"
		hk["hkTransformReverseText"] := "^+r"
		hk["hkTransformSentenceCase"] := "^+s"
		hk["hkTransformSortAscending"] := "^+a"
		hk["hkTransformSortDescending"] := "^+d"
		hk["hkTransformSortToggleCase"] := "!+8"
		hk["hkTransformSortToggleType"] := "!+3"
		hk["hkTransformTagify-01"] := "!+,"
		hk["hkTransformTagify-02"] := "!+."
		hk["hkTransformTitleCase"] := "^+t"
		hk["hkTransformUnwrapText"] := "^!+w"
		hk["hkTransformUpperCase"] := "^+u"
		hk["hkTransformWrap-01"] := "*^#``"
		hk["hkTransformWrap-02"] := "*+#``"
		hk["hkTransformWrap-03"] := "*+#1"
		hk["hkTransformWrap-04"] := "*+#2"
		hk["hkTransformWrap-05"] := "*+#3"
		hk["hkTransformWrap-06"] := "*+#4"
		hk["hkTransformWrap-07"] := "*+#5"
		hk["hkTransformWrap-08"] := "*+#6"
		hk["hkTransformWrap-09"] := "*+#7"
		hk["hkTransformWrap-10"] := "*+#8"
		hk["hkTransformWrap-11"] := "*+#9"
		hk["hkTransformWrap-12"] := "*+#0"
		hk["hkTransformWrap-13"] := "*^#-"
		hk["hkTransformWrap-14"] := "*+#-"
		hk["hkTransformWrap-15"] := "*^#="
		hk["hkTransformWrap-16"] := "*+#="
		hk["hkTransformWrap-17"] := "*^#["
		hk["hkTransformWrap-18"] := "*+#["
		hk["hkTransformWrap-19"] := "*^#]"
		hk["hkTransformWrap-20"] := "*+#]"
		hk["hkTransformWrap-21"] := "*^#\"
		hk["hkTransformWrap-22"] := "*+#\"
		hk["hkTransformWrap-23"] := "*^#;"
		hk["hkTransformWrap-24"] := "*+#;"
		hk["hkTransformWrap-25"] := "*^#'"
		hk["hkTransformWrap-26"] := "*+#'"
		hk["hkTransformWrap-27"] := "*^#,"
		hk["hkTransformWrap-28"] := "*+#,"
		hk["hkTransformWrap-29"] := "*^#."
		hk["hkTransformWrap-30"] := "*+#."
		hk["hkTransformWrap-31"] := "*^#/"
		hk["hkTransformWrap-32"] := "*+#/"
		hk["hkTransformWrapText"] := "^+w"
	}
	else if (type == "hkWindow") {
		hk["hkWindowAlwaysOnTop"] := "#a"
		hk["hkWindowCenter"] := "#Home"
		hk["hkWindowClickThrough"] := "!#a"
		hk["hkWindowDecreaseTransparency-01"] := "#-"
		hk["hkWindowDecreaseTransparency-02"] := "#NumpadSub"
		hk["hkWindowDecreaseTransparency-03"] := "#WheelDown"
		hk["hkWindowHide"] := "#Delete"
		hk["hkWindowHorizontalScrollLeft"] := "^WheelUp"
		hk["hkWindowHorizontalScrollRight"] := "^WheelDown"
		hk["hkWindowIncreaseTransparency-01"] := "#="
		hk["hkWindowIncreaseTransparency-02"] := "#NumpadAdd"
		hk["hkWindowIncreaseTransparency-03"] := "#WheelUp"
		hk["hkWindowLeft-01"] := "WheelLeft"
		hk["hkWindowLeft-02"] := "#Left"
		hk["hkWindowMaximize"] := "#Up"
		hk["hkWindowMinimize"] := "#Down"
		hk["hkWindowMoveToEdgeBottom"] := "^#Down"
		hk["hkWindowMoveToEdgeLeft"] := "^#Left"
		hk["hkWindowMoveToEdgeRight"] := "^#Right"
		hk["hkWindowMoveToEdgeTop"] := "^#Up"
		hk["hkWindowPageDown"] := "!WheelDown"
		hk["hkWindowPageUp"] := "!WheelUp"
		hk["hkWindowResizeToAnchor-01"] := "+#Down"
		hk["hkWindowResizeToAnchor-02"] := "+#Left"
		hk["hkWindowResizeToAnchor-03"] := "+#Right"
		hk["hkWindowResizeToAnchor-04"] := "+#Up"
		hk["hkWindowResizeTo3x3_01-01"] := "#Numpad1"
		hk["hkWindowResizeTo3x3_01-02"] := "#NumpadEnd"
		hk["hkWindowResizeTo3x3_01-03"] := "#1"
		hk["hkWindowResizeTo3x3_02-01"] := "#Numpad2"
		hk["hkWindowResizeTo3x3_02-02"] := "#NumpadDown"
		hk["hkWindowResizeTo3x3_02-03"] := "#2"
		hk["hkWindowResizeTo3x3_03-01"] := "#Numpad3"
		hk["hkWindowResizeTo3x3_03-02"] := "#NumpadPgDn"
		hk["hkWindowResizeTo3x3_03-03"] := "#3"
		hk["hkWindowResizeTo3x3_04-01"] := "#Numpad4"
		hk["hkWindowResizeTo3x3_04-02"] := "#NumpadLeft"
		hk["hkWindowResizeTo3x3_04-03"] := "#4"
		hk["hkWindowResizeTo3x3_05-01"] := "#Numpad5"
		hk["hkWindowResizeTo3x3_05-02"] := "#NumpadClear"
		hk["hkWindowResizeTo3x3_05-03"] := "#5"
		hk["hkWindowResizeTo3x3_06-01"] := "#Numpad6"
		hk["hkWindowResizeTo3x3_06-02"] := "#NumpadRight"
		hk["hkWindowResizeTo3x3_06-03"] := "#6"
		hk["hkWindowResizeTo3x3_07-01"] := "#Numpad7"
		hk["hkWindowResizeTo3x3_07-02"] := "#NumpadHome"
		hk["hkWindowResizeTo3x3_07-03"] := "#7"
		hk["hkWindowResizeTo3x3_08-01"] := "#Numpad8"
		hk["hkWindowResizeTo3x3_08-02"] := "#NumpadUp"
		hk["hkWindowResizeTo3x3_08-03"] := "#8"
		hk["hkWindowResizeTo3x3_09-01"] := "#Numpad9"
		hk["hkWindowResizeTo3x3_09-02"] := "#NumpadPgUp"
		hk["hkWindowResizeTo3x3_09-03"] := "#9"
		hk["hkWindowResizeWindowMenu"] := "!#r"
		hk["hkWindowRestoreHidden"] := "#Insert"
		hk["hkWindowRight-01"] := "WheelRight"
		hk["hkWindowRight-02"] := "#Right"
		hk["hkWindowShiftWindowDown"] := "+WheelDown"
		hk["hkWindowShiftWindowLeft"] := "!+WheelUp"
		hk["hkWindowShiftWindowRight"] := "!+WheelDown"
		hk["hkWindowShiftWindowUp"] := "+WheelUp"
		hk["hkWindowShowInfo"] := "#/"
		hk["hkWindowStretchToEdgeBottom"] := "!#Down"
		hk["hkWindowStretchToEdgeLeft"] := "!#Left"
		hk["hkWindowStretchToEdgeRight"] := "!#Right"
		hk["hkWindowStretchToEdgeTop"] := "!#Up"
		hk["hkWindowToggleMinimized"] := "!#m"
		hk["hkWindowToggleTransparency"] := "#t"
		hk["hkWindowZoomWindow"] := "#z"
	}
	return hk
}

getDpiFactor() {
	return Round(A_ScreenDPI / 96)
}

getDpiResolution(width, height) {
	res := {}
	res.factor := getDpiFactor()
	res.width := Round(width / res.factor)
	res.height := Round(height / res.factor)
	return res
}

getDpiSize(size) {
	return Round(size / getDpiFactor())
}

getEndChar() {
	return (A_EndChar != "" ? A_EndChar : hs.vars.hotStringEndChar)
}

getEol(text) {
	if (InStr(text, hs.const.EOL_WIN)) {
		; check this first because it may contain both
		eol := hs.const.EOL_WIN
	}
	else if (InStr(text, hs.const.EOL_NIX)) {
		eol := hs.const.EOL_NIX
	}
	else if (InStr(text, hs.const.EOL_MAC)) {
		eol := hs.const.EOL_MAC
	}
	else {
		; otherwise, default to Windows
		eol := hs.const.EOL_WIN
	}
	return eol
}

getExplorerPath() {
	xPath := ""
	if (isActiveExplorer()) {
		hWnd := getHwnd()
;		 debug("hWnd = " . hWnd)
		url := ""
		if (isActiveDialog()) {
			/*
			debug("Checking dialog...")
			;url := ControlGetText("ToolbarWindow322", "ahk_id %hWnd%")
			ControlGetText, url, ToolbarWindow322, Open ahk_class #32770
			debug("url = " . url)
			; TODO - is this an issue for non-paths? Such as current user or "My Documents'?
			; TODO - is this an issue for open dialog, too
			pos := InStr(url, ":\") - 1
			xPath := SubStr(url, pos)
			debug("xPath = " . xPath)
			*/
			message("Unable to determine current path from a dialog...")
			centerWindow()
		}
		else {
;			 debug("Checking windows...")
			for item in ComObjCreate("Shell.Application").Windows {
				if (url == "" && item.hWnd == hWnd) {
					url := item.LocationURL
				}
			}
			if (url != "") {
				VarSetCapacity(xPath, pathSize := 2084, 0)
				DllCall("shlwapi\PathCreateFromUrl" . (A_IsUnicode ? "W" : "A"), Str, url, Str, xPath, UIntP, pathSize, UInt, 0)
			}
		}
	}
	return xPath
}

getHelpCommon(reset:=false) {
	static html := ""
	if (html == "") {
		html =
		(LTrim Join`r`n
			<!DOCTYPE html>
			<html>
				<head>
					<meta charset='UTF-8'/>
					<style>
						{*reset*}
						html {font-family:sans-serif;font-size:.78em;height:calc(100vh - 1.25em);}
						body {background:#FFF3E1;height:100`%;margin:0;padding:0;}
						a {color:inherit;text-decoration:none;}
						a:hover {color:blue;text-decoration:underline;}
						hr {background-color:hotPink;border:0;height:.15em;margin:.5em 1.5em;}
						table {border-collapse:collapse;width:100`%;}
						td {white-space:nowrap;}

						col.bg {width:1`%;white-space:nowrap;}
						table#header {margin-top:.5em;}
						table#header td {text-align:center;}
						table#header td.bg {background:#dde;border-left:.1em dashed #aaa;font-family:Consolas,Courier;padding:.25em 1em;}
						table#header td.top {border-top:.1em dashed #aaa;padding-bottom:0.1em}
						table#header td.bottom {border-bottom:.1em dashed #aaa;padding-top:0.1em}
						table#header tr td:first-child {border-left:none;}
						table#header .left {text-align:left;}
						table#header .logo {padding-bottom:.65em;padding-right:1em;text-align:right;}
						table#header .logo img {height:1.5em;padding-right:.75em;position:relative;top:.38em;width:1.5em;}
						table#header .title {background:#FFE0E0;border:.1em solid #DF9898;border-radius:1.25em;font-family:Roboto,'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:1.4em;padding:.25em .75em;}
						table#header .version {font-size:.9em;margin-left:.5em;}
						table#header .copyright {align-self:center;font-weight:bold;margin-left:2em;}

						table#help {margin-top:1em;table-layout:fixed;}
						table#help td {vertical-align:top;}
						table#help td:nth-child(odd) {width:25`%;}
						table#help td:nth-child(even) {width:.75em;}

						section {background:#E5F0FF;border:.15em solid #3E84DE;border-radius:1.1em;}
						section+section {margin-top:.75em;}
						section>header {background:#99BCE8;border-radius:.95em .95em 0 0;line-height:2.5em;margin-bottom:.25em;}
						section>header>span {border-radius:1.5em;font-weight:bold;padding:.25em .75em;}
						section>header>span.name {background-color:#F3D6A2;border:.15em solid #8040FF;margin-left:.5em;}
						section>header>span.info {background-color:blueViolet;color:white;float:right;line-height:normal;margin:.4em 0.5em 0 0;}
						section>header>span>span.desc {color:lawnGreen;}
						section>header>span>span.value {color:aqua;}
						section>row {display:flex;flex-wrap:wrap;line-height:1.25em;padding:0 .25em;}
						section>row>:last-child {padding-bottom:.4em;}
						section>row>hk, section>row>hs, .keyText {color:royalBlue;font-family:Consolas,Courier;}
						section>row>hk {width:41`%;}
						section>row>hkd {width:59`%;}
						section>row>hs {width:25`%;}
						section>row>hsd {width:75`%;}
						section>row>hk>c, section>row>hs>c {padding-left:.25em;}

						.base {color:#444;font-style:normal;font-weight:normal;}
						.bold {font-weight:bold;}
						.code {color:mediumOrchid;font-family:Consolas,Courier;}
						.endKey {background-color:paleGreen;}
						.endSpace {background-color:#FFBFFF;}
						.explorer::before {content: "*";}
						.frac {font-family:Calibri,serif;font-size:1.25em;}
						.hex {background-color:yellow;padding:0 .1em;}
						.indent {margin-left:3.5em;}
						.italic {font-style:italic;}
						.jiraPanel {border-radius:.3em;display:inline-block;padding:0 .2em;margin-top:.25em;}
						.keys {color:blueViolet;font-weight:bold;}
						.live {color:crimson;}
						.mod {color:#E14854;font-family:Consolas,Courier;font-weight:bold;}
						.mono {font-family:Courier;font-size:1.25em;}
						.mouse {background-color:#FFBFFF;padding:0 .2em;}
						.myVar {color:mediumPurple;font-size:.75em;text-align:left;width:9.5em;}
						.note {background-color:#B5F5B5;border:.1em solid #149714;border-radius:.75em;font-size:.75em;line-height:1.1em;margin:.5em 1.5em .5em 1.5em;padding:.25em .5em;text-align:left;white-space:normal;width:calc(100`% - 4em) !important;}
						.panelRow {display:inline-block;margin-top:.25em;}
						.right {float:right;padding-right:.25em;}
						.span {display:inline-block;width:100`%;}
						.symbol {background:lightGray;}
						.symlist {font-family:Consolas,Courier;font-size:1.15em;padding:0 .2em;}
						.uni {color:seaGreen;float:right;font-size:1.5em;margin-right:2.5em;text-align:left;width:.5em;}
						.uniAlt {margin-right:1em;}
						.wheel {background-color:yellow;padding:0 .2em;}
						.wrapper {border:.1em solid #AAA;border-radius:.75em;height:100`%;margin:.2em .2em 0 .2em;padding:0 .75em .75em .75em;}
						.center {display:inline-block;text-align:center;width:100`%;} /* this needs to remain last so it has precedence */

						hsd span.panelRow span.code {color:#39434A;}
					</style>
				</head>
				<body onContextMenu='return true'><div class='wrapper base'>{content}</div></body>
			</html>
		)
	}
	return StrReplace(html, "{*reset*}", reset ? "* {margin:0;padding:0;}" : "")
}

getHelpContentHotKeys() {
	static contentHK := ""
	if (contentHK == "") {
		hkAutomationHelp := ""
		if (hs.config.user.enableHkAutomation) {
			userMenu := (IsFunc("userMenu") ? "`n[W]-U`tUser menu" : "")
			hkAutomationHelp =
			(LTrim Comments
				Automation
				[W]-C`tRun Calculator
				[W]-D`tRun DOS
				[AW]-D`t{explorer}Run DOS from folder{explorer}
				[W]-E`tRun editor
				[W]-G`tGoogle ___or___ Goto URL / Path
				[W]-M`tCharacter Map
				[W]-Q`tQuick Lookup
				[W]-S`tRun Windows Services
				[AW]-S`t{explorer}View ___Startup___ folder{explorer}
				[AW]-T`t{explorer}View ___Temp___ folder{explorer}%userMenu%
				[W]-X`tRun Windows Explorer
				[W]-PrintScreen`tRun Snipping tool
				[LC]-[RC]`tRun Control Panel
			)
		}

		hkClipboardHelp := ""
		if (hs.config.user.enableHkClipboard) {
			hkClipboardHelp =
			(LTrim Comments
				Clipboard
				[CW]-A`tCopy-Append to clipboard{right}(__text__){right}
				[AW]-Delete`tClear all clipboards
				[CW]-Delete`tClear active clipboard
				[CW]-M`tUse MultiClip clipboard
				[CW]-Q`tToggle MultiClip (queue / stack)
				[CW]-S`tSwap selection and clipboard
				[CA]-V`tPaste as text
				[CW]-V`tPaste all MultiClip entries
				[W]-V`tPreview active clipboard
				[CW]-W`tUse Windows clipboard
				[CW]-X`tCut-Append to clipboard{right}(__text__){right}
				[CW]-[[F1-F10]]`tUse # clipboard
				[CW]-[[1-0]]`tCopy to # clipboard
				[SW]-[[1-0]]`tPaste # clipboard
				[AW]-[[1-0]]`tPaste # clipboard as text
				[W]-Enter`tPaste 'enter'
				[W]-Tab`tPaste 'tab'
			)
		}

		hkCommandLineHelp := ""
		if (hs.config.user.enableHkCommandLine) {
			hkCommandLineHelp =
			(LTrim Comments
				Command Line (DOS / shell)
				[A]-C`tcopy / cp
				[A]-D`tPUSHD to Downloads
				[A]-M`tmove / mv
				[A]-P`tpushd
				[C]-P`tpopd to last dir
				[A]-R`tCD to root dir
				[A]-T`ttype / cat
				[A]-X`tRun 'exit'
				Escape`tClear line
				[C]-.`t{explorer}View current folder{explorer}
				[A]-[[{arrow_up}.]] {base}___or___{base} {mouse}Back{mouse}`tCD to parent dir
				[C]-[[{arrow_up}{arrow_down}]]`tScroll up / down one line
				[C]-[[PgUp PgDn]]`tScroll up / down one page
				[C]-[[Home End]]`tScroll to top / bottom
			)
		}

		title := hs.TITLE
		hkHotScriptHelp =
		(LTrim Comments
			%title%
			[W]-H`tShow quick help
			[W]-F12`t%title% menu
			Escape + H`tPause %title%
			Escape + K`tPause HotKeys
			Escape + S`tPause HotStrings
		)

		hkMiscHelp := ""
		if (hs.config.user.enableHkMisc) {
			hkMiscHelp =
			(LTrim Comments
				Miscellaneous
				[CA]-D`t{explorer}Create new directory{explorer}
				[CA]-F`t{explorer}Create new file{explorer}
				[W]-Apps`tToggle desktop icons
				[W]-Esc`tToggle desktop
				{mouse}Back{mouse}`t{explorer}Go up one folder{explorer}
				{mouse}Forward{mouse}`t{explorer}Previous folder{explorer}
			)
		}

		hkMouseHelp := ""
		if (hs.config.user.enableHkMouse) {
			hkMouseHelp =
			(LTrim Comments
				Mouse
				[C]-Caps {base}___or___{base} [CW]-{mouse}Left{mouse}`tCenter mouse (screen)
				[S]-Caps {base}___or___{base} [SW]-{mouse}Left{mouse}`tCenter mouse (window)
				[CAW]-ARROW`tDrag mouse 1px
				[CSW]-ARROW`tMove mouse 1px
			)
		}

		hkTextHelp := ""
		if (hs.config.user.enableHkText) {
			hkTextHelp =
			(LTrim Comments
				Text Editing
				[C]-D`tDelete next word
				[C]-Backspace`tDelete previous word
				[CA]-Backspace`tEnd, Backspace, Down
				[A]-Delete`tDelete line
				[C]-Delete`tDelete to line end
				[CS]-Delete`tDelete to line start
				[A]-End`tUp, End, Delete
				[CA]-Space`tDelete blank lines
				[CA]-.`tTrim EOL whitespace
				[A]-[[{arrow_up}{arrow_down}]]`tMove line up / down
				[CS]-{arrow_up}`tDuplicate line (up)
				[CS]-{arrow_down}`tDuplicate line (down)
			)
		}

		hkTransformHelp := ""
		if (hs.config.user.enableHkTransform) {
			hkTransformHelp =
			(LTrim Comments
				Transform
				[AS]-#`tSort type: Natural/ASCII/Random
				[AS]-*`tSort case-sensitive: Yes/No
				[CS]-A`tSort ascending
				[CS]-D`tSort descending
				[CS]-E`tEncrypt text
				[CS]-I`tiNVERT cASE
				[CS]-L`tlower case
				[CS]-M`tMySQL words to UPPER
				[CS]-N`tAuto-number (start at 1)
				[CAS]-N`tAuto-number (prompt for start)
				[CA]-N`tAuto-Denumber
				[CS]-O`tOracle words to UPPER
				[CS]-R`tReverse text
				[CS]-S`tSentence case
				[CS]-T`tTitle Case
				[CS]-U`tUPPER CASE
				[CS]-W`tWrap text at width
				[CAS]-W`tUnwrap wrapped text
				[CS]-'`t{symlist}{curly_dquote_open}{curly_dquote_close}{symlist} to {symlist}""{symlist} {base}___and___{base} {symlist}{curly_squote_open}{curly_squote_close}{symlist} to {symlist}''{symlist}
				[CS]-```tEscape text for AHK
				[AS]-[[{lt}{gt}]]`tTagify text
				[CW]-SYMBOL`tWrap text in symbol
				[CAW]-SYMBOL`tWrap each line in symbol
				{span}{indent}{mono}{pointer}{mono}{indent}[[{symlist}``-=[]\;',./{symlist}]]{span}
				[SW]-SYMBOL`tWrap text in symbol
				[ASW]-SYMBOL`tWrap each line in symbol
				{span}{indent}{mono}{pointer}{mono}{indent}[[{symlist}~!@#$`%^&*()_+{}|:"{lt}{gt}?{symlist}]]{span}
				{note}{center}Text transformation actions apply to selected, editable text.{center}{note}
			)
		}

		hkWindowHelp := ""
		if (hs.config.user.enableHkWindow) {
			hkWindowHelp =
			(LTrim Comments
				Window Functions
				[W]-A`tToggle always-on-top
				[AW]-A`tToggle click-through
				[AW]-M`tToggle minimized
				[W]-T`tToggle transparency
				[W]-Z`tShow zoom window
				[W]-/`tShow window info
				[W]-Delete`tHide window
				[W]-Insert`tShow hidden windows
				[W]-Home`tCenter window
				[W]-[[+-]] {base}___or___{base} [W]-[[{wheel}{wheel_up}{wheel_down}{wheel}]]`tMore / Less transparency
				[A]-[[{wheel}{wheel_up}{wheel_down}{wheel}]]`tPageUp / PageDown
				[C]-[[{wheel}{wheel_up}{wheel_down}{wheel}]]`tScroll left / right
				[S]-[[{wheel}{wheel_up}{wheel_down}{wheel}]]`tShift window up / down
				[AS]-[[{wheel}{wheel_up}{wheel_down}{wheel}]]`tShift window left / right
				[W]-[[{arrow_up}{arrow_down}]]`tMinimize / Maximize
				[W]-[[{arrow_left}{arrow_right}]] {base}___or___{base} [[{wheel}{wheel_left}{wheel_right}{wheel}]]`tMove to previous / next monitor
				[AW]-[[{arrow_up}{arrow_down}{arrow_left}{arrow_right}]]`tStretch to edge
				[CW]-[[{arrow_up}{arrow_down}{arrow_left}{arrow_right}]]`tMove to edge
				[SW]-[[{arrow_up}{arrow_down}]]`tResize to 1x2 grid
				[SW]-[[{arrow_left}{arrow_right}]]`tResize to 2x1 grid
				[SW]-[[{arrow_up}{arrow_down}]]{base}{bold} ___and___ {bold}{base}[[{arrow_left}{arrow_right}]]`tResize to 2x2 grid
				[W]-[[1-9]]`tResize to 3x3 grid
				[AW]-R`tResize window menu
				{note}When ScrollLock is on, resizing actions will only move a window instead of moving and resizing it.{note}
			)
		}

		logo := getHelpLogo()
		hkCol1 := [hkAutomationHelp, hkClipboardHelp]
		hkCol2 := [hkWindowHelp, hkMiscHelp]
		hkCol3 := [hkTransformHelp, hkMouseHelp]
		hkCol4 := [hkTextHelp, hkCommandLineHelp, hkHotScriptHelp]
		hkHeader =
		(LTrim Join`r`n
			<table id='header'>
				<colgroup>
					<col class='bg'>
					<col class='bg'>
					<col class='bg'>
					<col class='bg'>
					<col class='bg'>
					<col>
				</colgroup>
				<tr>
					<td class='bg top noLeftBorder'>{mod}A{mod} = Alt</td>
					<td class='bg top'>{mod}C{mod} = Ctrl</td>
					<td class='bg top'>{mod}S{mod} = Shift</td>
					<td class='bg top'>{mouse}{keyText}MouseButton{keyText}{mouse}</td>
					<td class='bg top left'>
						{wheel}{keyText}MouseWheel{keyText}{wheel}
						({wheel}{keyText}{wheel_up}{wheel_down}{keyText}{wheel}:Scroll
						&nbsp;{wheel}{keyText}{wheel_left}{wheel_right}{keyText}{wheel}:Tilt)
					</td>
					<td rowspan='2'>%logo%</td>
				</tr>
				<tr>
					<td class='bg bottom'>{mod}W{mod} = Win</td>
					<td class='bg bottom'>{mod}L{mod} = Left</td>
					<td class='bg bottom'>{mod}R{mod} = Right</td>
					<td class='bg bottom'>{explorer}In Explorer{explorer}</td>
					<td class='bg bottom left'>[[{keyText}keys{keyText}]] = press only ___ONE___ of these keys</td>
				</tr>
			</table>
		)

		contentHK := hkHeader . "<table id='help'><tr>"
		Loop, 4 {
			colIndex := A_Index
			contentHK .= "<td><div>"
			columnData := hkCol%A_Index%
			sections := columnData.MaxIndex()
			Loop, %sections% {
				sectionIndex := A_Index
				sectionData := columnData[sectionIndex]
				if (sectionData != "") {
					contentHK .= "<section>"
					Loop, Parse, sectionData, `n
					{
						lineIndex := A_Index
						if (lineIndex == 1) {
							contentHK .= "<header><span class='name'>" . A_LoopField . "</span>"
							if (A_LoopField == "Clipboard") {
								contentHK .= "<span class='info'>Active: <span class='value'>" . whichClipboard() . "</span></span>"
							}
							else if (A_LoopField == "Transform") {
								contentHK .= "<span class='info'><span class='desc'>[Sort]</span> Type: <span class='value'>" . hs.config.user.sortType . "</span>, Case: <span class='value'>" . (hs.config.user.sortCase ? "Y" : "N") . "</span></span>"
							}
							contentHK .= "</header>"
						}
						else {
							lineData := StrSplit(A_LoopField, "`t")
							if (lineIndex == 2) {
								contentHK .= "<row>"
							}
							if (lineData.MaxIndex() == 1) {
								contentHK .= A_LoopField
							}
							else {
								contentHK .= "<hk><c>" . lineData[1] . "</c></hk><hkd>" . lineData[2] . "</hkd>"
							}
						}
					}
					contentHK .= "</row></section>"
				}
			}
			contentHK .= "</div></td>"
			if (colIndex < 4) {
				contentHK .= "<td></td>"
			}
		}
		contentHK .= "</tr></table>"
		contentHK := helpPrep(StrReplace(getHelpCommon(true), "{content}", contentHK))
	}
	return contentHK
}

getHelpContentHotStrings() {
	static contentHS := ""
	if (contentHS == "") {
		hsAliasHelp := ""
		if (hs.config.user.enableHsAlias) {
			hsAliasHelp =
			(LTrim Comments
				Aliases
				bbl`tbe back later
				bbs`tbe back soon
				bi#{endKey}`tBack in # minutes
				brb`tbe right back
				brt`tbe right there
				g2g`tGood to go.
				gtg`tGot to go.
				idk`tI don't know.
				lmc`tLet me check on that...
				lmk`tLet me know
				nm{endKey}`tnever mind...
				nmif`tNever mind, I found it.
				np{endKey}`tno problem
				nw`tno worries
				okt`tOK, thanks...
				thok`tThat's OK...
				thx`tthanks
				ty{endKey}`tThank you.
				vg{endKey}`tvery good
				yw{endKey}`tYou're welcome
				wyb`tPlease let me know when you are back...
			)
		}

		hsArrowHelp := ""
		if (hs.config.user.enableHsAutoCorrect) {
			hsArrowHelp =
			(LTrim Comments
				Auto Replace (Arrows)
				@darr`tDown (single)`t{uni}&#x2193;{uni}
				@dArr`tDown (double)`t{uni}&#x21d3;{uni}
				@odarr`tDown (outline)`t{uni}&#x21e9;{uni}
				@harr`tHorizontal (single)`t{uni}&#x2194;{uni}
				@hArr`tHorizontal (double)`t{uni}&#x21d4;{uni}
				@larr`tLeft (single)`t{uni}&#x2190;{uni}
				@larr`tLeft (double)`t{uni}&#x21d0;{uni}
				@olarr`tLeft (outline)`t{uni}&#x21e6;{uni}
				@nearr`tNorth East (single)`t{uni}&#x2197;{uni}
				@neArr`tNorth East (double)`t{uni}&#x21d7;{uni}
				@nwarr`tNorth West (single)`t{uni}&#x2196;{uni}
				@nwArr`tNorth West (double)`t{uni}&#x21d6;{uni}
				@rarr`tRight (single)`t{uni}&#x2192;{uni}
				@rArr`tRight (double)`t{uni}&#x21d2;{uni}
				@orarr`tRight (outline)`t{uni}&#x21e8;{uni}
				@searr`tSouth East (single)`t{uni}&#x2198;{uni}
				@seArr`tSouth East (double)`t{uni}&#x21d8;{uni}
				@swarr`tSouth West (single)`t{uni}&#x2199;{uni}
				@swArr`tSouth West (double)`t{uni}&#x21d9;{uni}
				@uarr`tUp (single)`t{uni}&#x2191;{uni}
				@uArr`tUp (double)`t{uni}&#x21d1;{uni}
				@ouarr`tUp (outline)`t{uni}&#x21e7;{uni}
				@varr`tVertical (single)`t{uni}&#x2195;{uni}
				@vArr`tVertical (double)`t{uni}&#x21D5;{uni}
			)
		}

		shrug := hs.internal.SHRUG
		hsAutoCorrectHelp := ""
		if (hs.config.user.enableHsAutoCorrect) {
			hsAutoCorrectHelp =
			(LTrim Comments
				Auto Replace
				#/#`%`tDivide as percent
				#`%#{endKey}`tPercent of number
				[a-z]L`t[a-z]:{right}(__common typo__){right}
				rcX#{endKey}`tRepeat character X, # times
				rsXYZ~#{endKey}`tRepeat string XYZ, # times
				@#/#{endKey}`t<div style='margin-bottom:-.25em;margin-top:-.35em;'>A fraction from {frac}&#x215B;{frac} up to {frac}&#x215E;{frac}; or <sup>n</sup>&frasl;<sub>d</sub> via HTML</div>
				@ip`t{live}{ip}{live}
				@shrug`tShrug emoticon{right}%shrug%{right}
				{span}<hr>{span}
				@+-`tPlus-Minus`t{uni}&#177;{uni}
				@bullet`tBullet`t{uni}&#x2022;{uni}
				@cent`tCent`t{uni}&#x00A2;{uni}
				@check`tCheck`t{uni}&#x2713;{uni}
				@club`tClub`t{uni}&#x2663;{uni}
				@copy`tCopyright`t{uni}&#x00A9;{uni}
				@diam`tDiamond`t{uni}&#x2666;{uni}
				@div`tDivision`t{uni}&#x00F7;{uni}
				@ellip`tEllipsis`t{uni}&#x2026;{uni}
				@euro`tEuro`t{uni}&#x20AC;{uni}
				@gte`tGreater Than or Equal`t{uni}&#x2265;{uni}
				@heart`tHeart`t{uni}&#x2665;{uni}
				@inf`tInfinity`t{uni}&#x221E;{uni}
				@lte`tLess Than or Equal`t{uni}&#x2264;{uni}
				@mdash`tMDash`t{uni}&#x2014;{uni}
				@mult`tMultiplication`t{uni}&#x00D7;{uni}
				@ndash`tNDash`t{uni}&#x2013;{uni}
				@neq`tNot Equal`t{uni}&#x2260;{uni}
				@pound`tPound`t{uni}&#x00A3;{uni}
				@reg`tRegistered`t{uni}&#x00AE;{uni}
				@spade`tSpade`t{uni}&#x2660;{uni}
				@tm`tTrademark`t{uni}&#x2122;{uni}
				@yen`tYen`t{uni}&#x00A5;{uni}
				@uni{hex}XXXX{hex}`tUnicode character
			)
		}

		hsCodeHelp := ""
		if (hs.config.user.enableHsCode) {
			hsCodeHelp =
			(LTrim Comments
				Coding
				@html`tHTML template
				@java`tJava template
				@perl`tPerl template
				@sql`tSQL template
				${`t{code}${}{code} variable token
				elif`t{code}else/if{code} code block
				for(`t{code}for{code} code block
				func(`t{code}function{code} code block
				if(`t{code}if{code} code block
				ifel`t{code}if/else{code} code block
				sf.`t{code}String.format("", );{code}
				switch(`t{code}switch{code} code block
				sysout`t{code}System.out.println("");{code}
				while(`t{code}while{code} code block
			)
		}

		hsDatesHelp := ""
		if (hs.config.user.enableHsDates) {
			hsDatesHelp =
			(LTrim Comments
				Date/Time
				dtms`t{live}{dtms}{live}{right}(__date/time stamp__){right}
				dts`t{live}{dts}{live}{right}(__date stamp__){right}
				tms`t{live}{tms}{live}{right}(__time stamp__){right}
				@date`t{live}{date}{live}
				@day`t{live}{day}{live}
				@ddd`t{live}{ddd}{live}
				@mmm`t{live}{mmm}{live}
				@month`t{live}{month}{live}
				@now`t{live}{now}{live}
				@time`t{live}{time}{live}
			)
		}

		hsDosHelp := ""
		if (hs.config.user.enableHsDos) {
			hsDosHelp =
			(LTrim Comments
				Command Line (DOS / shell)
				cd{endSpace}`tcd /d
				rd{endSpace}`trd /s
			)
		}

		hsJiraHelp := ""
		if (hs.config.user.enableHsJira) {
			hsJiraHelp =
			(LTrim Comments
				Jira / Confluence
				`{code`t{code}&#123;code&#125;{code} tags
				`{color`t{code}{color}{code} tags
				`{info`t{code}{info}{code} tags
				`{java`t{code}&#123;code&#125;{code} tags for Java
				`{js`t{code}&#123;code&#125;{code} tags for JavaScript
				`{nof`t{code}{noformat}{code} tags
				`{note`t{code}{note}{code} tags
				`{py`t{code}&#123;code&#125;{code} tags for Python
				`{quo`t{code}{quote}{code} tags
				`{sql`t{code}&#123;code&#125;{code} tags for SQL
				`{table`t{code}{table}{code} tags with 5 columns
				`{tip`t{code}{tip}{code} tags
				`{warn`t{code}{warn}{code} tags
				`{xml`t{code}&#123;code&#125;{code} tags for XML
				{panelRow}`{pan{panelRow}`t{code}{jiraDefault}{panel}{jiraDefault}{code} tags for a default panel
				{panelRow}`{bpan{panelRow}`t{code}{jiraBlue}{panel}{jiraBlue}{code} tags for a blue panel
				{panelRow}`{gpan{panelRow}`t{code}{jiraGreen}{panel}{jiraGreen}{code} tags for a green panel
				{panelRow}`{rpan{panelRow}`t{code}{jiraRed}{panel}{jiraRed}{code} tags for a red panel
				{panelRow}`{ypan{panelRow}`t{code}{jiraYellow}{panel}{jiraYellow}{code} tags for a yellow
			)
		}

		hsVariableHelp := ""
		if (hs.config.user.enableHsVariables) {
			hsVariableHelp =
			(LTrim Comments
				MY Variables
				@@`temail address{right}{myVar}MY_EMAIL{myVar}{right}
				@#`tphone number{right}{myVar}MY_PHONE{myVar}{right}
				@home`thome address{right}{myVar}MY_HOME_ADDRESS{myVar}{right}
				@dob`tdate of birth{right}{myVar}MY_DOB{myVar}{right}
				@me`tname / nickname{right}{myVar}MY_NAME{myVar}{right}
				@pw`tpassword (__encrypted__){right}{myVar}MY_PASSWORD{myVar}{right}
				@sig`tsignature{right}{myVar}MY_SIGNATURE{myVar}{right}
				@W@`twork email address{right}{myVar}MY_WORK_EMAIL{myVar}{right}
				@W#`twork phone number{right}{myVar}MY_WORK_PHONE{myVar}{right}
				@work`twork address{right}{myVar}MY_WORK_ADDRESS{myVar}{right}
			)
		}

		logo := getHelpLogo()
		hsCol1 := [hsAliasHelp, hsDatesHelp]
		hsCol2 := [hsAutoCorrectHelp, hsDosHelp]
		hsCol3 := [hsArrowHelp, hsVariableHelp]
		hsCol4 := [hsCodeHelp, hsJiraHelp]

		hsHeader =
		(LTrim Join`r`n
			<table id='header'>
				<colgroup>
					<col class='bg'>
					<col class='bg'>
					<col class='bg'>
					<col class='bg'>
					<col>
				</colgroup>
				<tr>
					<td class='bg top noLeftBorder'>{endKey} = any whitespace or symbol</td>
					<td class='bg top noLeftBorder'>{endSpace} = a space</td>
					<td class='bg top'>{hex}{keyText}X{keyText}{hex} = Hex character</td>
					<td class='bg top bottom'>{live}Live values{live}</td>
					<td rowspan='2'>%logo%</td>
				</tr>
				<tr>
					<td class='bg bottom'>(___required___)</td>
					<td class='bg bottom'>(___required___)</td>
					<td class='bg bottom'>(0-9 and A-F)</td>
					<td class='bg top bottom'>{code}Generated code{code}</td>
				</tr>
			</table>
		)

		contentHS := hsHeader . "<table id='help'><tr>"
		Loop, 4 {
			colIndex := A_Index
			contentHS .= "<td><div>"
			columnData := hsCol%A_Index%
			sections := columnData.MaxIndex()
			Loop, %sections% {
				sectionIndex := A_Index
				sectionData := columnData[sectionIndex]
				if (sectionData != "") {
					contentHS .= "<section>"
					uniCount := 0
					Loop, Parse, sectionData, `n
					{
						lineIndex := A_Index
						if (lineIndex == 1) {
							contentHS .= "<header><span class='name'>" . A_LoopField . "</span>"
							if (A_LoopField == "My Variables") {
								SplitPath(hs.file.USER_VARIABLES, myFile)
								contentHS .= "<span class='info'>See: <span class='value'>" . myFile . "</span></span>"
							}
							contentHS .= "</header>"
						}
						else {
							lineData := StrSplit(A_LoopField, "`t")
							if (lineIndex == 2) {
								contentHS .= "<row>"
							}
							if (lineData.MaxIndex() == 1) {
								contentHS .= A_LoopField
							}
							else {
								contentHS .= "<hs><c>" . lineData[1] . "</c></hs><hsd>" . lineData[2]
								if (lineData.MaxIndex() == 3) {
									if (contains(lineData[3], "{uni}")) {
										uniCount++
										if (Mod(uniCount, 2) == 0) {
											lineData[3] := StrReplace(lineData[3], "{uni}", "{uni uniAlt}")
										}
									}
									contentHS .= lineData[3]
								}
								contentHS .= "</hsd>"
							}
						}
					}
					contentHS .= "</row></section>"
				}
			}
			contentHS .= "</div></td>"
			if (colIndex < 4) {
				contentHS .= "<td></td>"
			}
		}
		contentHS .= "</tr></table>"
		contentHS := helpPrep(StrReplace(getHelpCommon(true), "{content}", contentHS))
	}
	return contentHS
}

getHelpContentCustom() {
	static contentCustom := ""
	if (contentCustom == "") {
	contentCustom =
	(
<style>
	html {font-family:sans-serif;}
	a {color:blue;text-decoration:underline;}
	button {background-color:#008CBA;border:none;border-radius:.75em;color:white;cursor:pointer;display:inline-block;font-size:1em;margin:0 .5em;padding:1em 2em;text-align:center;}
	button:hover {background-color:#F44336;}
	caption {background-color:plum;border-radius:.2em;font-weight:bold;margin-bottom:.5em;padding:.25em;width:16em;}
	blockquote.code {background:lightGray;color:mediumBlue;margin-left:4em;padding:.5em;}
	h3 {background-color:darkSeaGreen;border-radius:.4em;padding:.25em .25em .25em 1em;}
	h4 {background-color:lightGray;border-radius:.2em;padding:.25em;text-align:center;width:16em;}
	li {margin-left:-2em;}
	pre {font-family:Consolas,Courier;margin:0;}
	table {border-collapse:collapse;margin-bottom:2em;width:96`%;}
	table.normal td {white-space:normal;}
	th {background-color:#99BCE8;}
	td, th {border:.05em solid #777;padding:.5em;white-space:nowrap;}
	td {font-family:Consolas,Courier;}
	td.comment, td.header {font-family:sans-serif;font-weight:normal;white-space:normal;}
	td.header {border-left:0;border-right:0;border-top:0;}
	td.noBorder {border:0;}
	tt {color:forestGreen;font-family:Courier;font-weight:bold;}
	ul {list-style-type:none;margin:0;}

	div.container {background:#F0F0F0;border:.05em solid mediumBlue;border-radius:.5em;font-size:1.29em;margin-top:1em;padding:.5em;}
	div.content {height:41.5em;overflow-y:auto;padding-right:1em;scrollbar-face-color:lightSteelBlue;scrollbar-track-color:#F0F0F0;}
	div.content > div, div.content > h4, div.content > p, div.content > table {margin-left:2em;}

	.auto {width:auto;}
	.codeComment {color:red;font-style:italic;}
	.customToken {color:darkCyan;font-family:Consolas,Courier;font-weight:bold;}
	.customValue {color:mediumVioletRed;font-family:Consolas,Courier;font-weight:bold;}
	.file {color:blueViolet;}
	.flex {display:flex;}
	.helpCode {color:red;font-weight:bold;}
	.helpInfo {background-color:khaki;border:.1em solid #333;border-radius:.3em;display:table;font-size:.8em;font-style:italic;margin-left:7.5em !important;padding:.5em;}
	.helpMono {font-family:Consolas,Courier;font-weight:bold;}
	.indent {margin-left:6em !important;}
	.noGap {margin-bottom:0;padding-bottom:0;}
	.nowrap {white-space:nowrap !important;}
	.setting {color:maroon;}
	.tab {background-color:wheat;font-weight:bold;padding:.1em;}
	.title {margin:0;padding-top:0;}

	div.flex blockquote.code {margin-top:.5em;}
	table#help {font-size:.78em;margin-left:1em;width:100`%;}
	table#help td {border:0;margin:0;padding:0;}
	table#help td:nth-child(2n+1) {width:33`%;}
	table.auto td {text-align:center;}
	section>row>hk {width:35`%;}
	section>row>hkd {width:65`%;}
	section>row>hs {width:25`%;}
	section>row>hsd {width:75`%;}
</style>

	)
	contentCustom = %contentCustom%
	(
<div class='container'>
	<div class='content'>
		<h2 class='title center'>Instructions for Creating Custom Help Tabs</h2>
		<h3>Introduction</h3>
		<p>After numerous requests to support user-defined help, this is now possible. This file `(<tt class='file'>HotScriptCustomHelp.html</tt>`) is automatically created by HotScript. If this file is deleted, it will be created again the next time HotScript is launched or restarted. Changing the contents of this file will <em>not</em> be reflected on the <span class='tab'>Custom</span> tab, however. Additionally, future versions of HotScript will likely recreate this file with updated content. This file's only purpose is to serve as a reference for creating your own help content.</p>
		<p>There is no restriction on the type `(or quantity`) of information that can be displayed within your custom help. The maximum number of tabs that can be displayed is 50. If you do not need a tab for custom HotKeys and HotStrings, you could create a list of HTTP links, server configuration information, or any other information you would like to access easily.</p>
		<p>Whenever the help screen is shown, the contents for custom help tabs is read each time, so they will always reflect the most recent changes. This allows for viewing changes quickly, without the need to reload HotScript. To make this even more useful, there is a new setting to control which tab is displayed by default. This setting is <tt class='setting'>defaultHelpTab</tt> and defaults to 1, meaning the first tab. To have a different tab show instead, edit <tt class='file'>HotScriptUser.ini</tt> and add the following line to the <tt class='helpCode'>[config]</tt> section, where the number is the tab number to be shown:</p>
		<div class='flex'>
			<blockquote class='code'><tt class='setting'>defaultHelpTab=4</tt></blockquote>
			<p>Save and reload HotScript to have the change take effect.</p>
		</div>
		<p>To have the last tab that was viewed be the default tab, set the value of <tt class='setting'>defaultHelpTab</tt> to blank, as shown below. This setting will persist whenever HotScript is launched `(or reloaded`), and is updated each time the help screen is closed.</p>
		<div class='flex'>
			<blockquote class='code'><tt class='setting'>defaultHelpTab=</tt></blockquote>
			<p>Save and reload HotScript to have the change take effect.</p>
		</div>
		<h3 id='setup'>Setup</h3>
		<p>To make integrating your help content into HotScript's help easier, and to allow for ultimate flexibility, the actual reading and/or processing of the content must be performed by a user-defined function `(the base code is in the example below`) and must be named <span class='helpCode'>getUserHelpTabs`(`)</span>. Here you will write code to read any files, process them for any replacement tokens `(if necessary`), and create an array entry for each help tab. That entry is an associative array containing the name of the tab and the HTML content to be rendered. This function is ultimately responsible for which tab`(s`) will be displayed and the content for each one.</p>
		<p>The following steps will help you to create your own help content and tabs. For this example, two tabs will be created and called <span class='tab'>Home</span> and <span class='tab'>Work</span>. The process would be exactly the same for any additional tabs. Begin by creating a new function `(usually in <tt class='file'>HotScriptFunctions.ahk</tt>`) called <span class='helpCode'>getUserHelpTabs`(`)</span>. This function will need to return an array, so create a local variable to hold the information. To reduce the amount of repetitive code, it is better to create a helper function for loading the content from files. The order in which the tab data is added to the array is the order in which they will appear, after HotScript's tabs though.</p>
		<p class='helpInfo'>
			The comments within the code below are meant to help teach someone new to writing code.<br/>
			Consider removing them from <em>your</em> code as documenting every line of code is unnecessary and makes the code difficult to read.
		</p>
		<div class='flex'>
			<blockquote class='code'>
				<pre>getUserHelpTabs`(`) {
	<span class='codeComment'>; array that will contain the name and content for each tab</span>
	tabs := []
	<span class='codeComment'>; add to the tab array an associative array for the Home tab and its content</span>
	tabs.push`({name: "Home", content: readAndPrepHelp`("home.html"`)})
	<span class='codeComment'>; add to the tab array an associative array for the Work tab and its content</span>
	tabs.push`({name: "Work", content: readAndPrepHelp`("work.html"`)})
	<span class='codeComment'>; return the tab array to HotScript</span>
	return tabs
}

readAndPrepHelp`(name`) {
	<span class='codeComment'>; read the file - if no path is given, the default HotScript folder is assumed</span>
	content := FileRead`(name`)
	<span class='codeComment'>; custom actions can be performed here based on the file being loaded</span>
	if `(name == "home.html"`) {
		<span class='codeComment'>; add some code here to customize the Home tab's content</span>
		content .= "{lt}p{gt}This is custom content for the Home tab.{lt}/p{gt}"
	}
	else if `(name == "work.html"`) {
		<span class='codeComment'>; add some code here to customize the Work tab's content</span>
		content .= "{lt}p{gt}This is custom content for the Work tab.{lt}/p{gt}"
	}
	<span class='codeComment'>; if the content does not contain "{lt}html" then wrap it in the common help HTML, otherwise use it as-is</span>
	if `(!containsIgnoreCase`(content, "{lt}html"`)`) {
		<span class='codeComment'>; replace the "{content}" token with the content that was read from the file</span>
		content := StrReplace`(getHelpCommon`(`), "{content}", content`)
	}
	<span class='codeComment'>; replace all of the documented Text and CSS tokens, then return the final content</span>
	return helpPrep`(content`)
}</pre>
			</blockquote>
		</div>
		<p>The <span class='tab'>Custom</span> tab is useful when first learning to create your own tabs, however and is displayed only when the <span class='helpCode'>getUserHelpTabs`(`)</span> function does not exist. If you would like this tab to continue to be displayed, include the following code in the <span class='helpCode'>getUserHelpTabs`(`)</span> function:</p>
		<div class='flex'>
			<blockquote class='code'>
				tabs.push`({name: "Custom", content: "custom"}`)  ; the name may be changed to anything you want
			</blockquote>
		</div>

	)
	contentCustom = %contentCustom%
	(
		<h3>Appearance</h3>
		<p class='helpInfo'>The help tabs use the embedded version of Internet Explorer 11. When creating your own content, you are restricted to the HTML and CSS that is valid for IE11.</p>
		<p>The appearance of your custom content is fully customizable via HTML, CSS, and JavaScript. You are <em>strongly</em> encouraged to use <tt class='helpCode'>em</tt> units within your CSS rather than <tt class='helpCode'>px</tt>. This will make the font sizes be relative to the screen DPI setting in use by Windows and allow the content to look the same on computers that may be using a different DPI setting. Without the use of <tt class='helpCode'>em</tt> values, the text will likely appear too small or too large on other computers. To check `(or change`) your DPI settings, right-click the Windows desktop and select "Display Settings". For Windows 10, the settings page will show "Scale and Layout" and use a percent value from 100 to 350.</p>
		<p>There are two options you can choose for styling your content:</p>
		<h4>Option 1: Custom Styling</h4>
		<p>To use your own styling, make this file a valid HTML document by including an <tt class='helpCode'>&lt;html&gt;</tt> tag before any other content. It does not necessarily need to be the first line of this file and may include any additional attributes. If HotScript finds this tag, it will not include the default styling used by the other tabs. You may also use CSS libraries, such as <a href='https://www.bulma.io' target='_blank'>Bulma</a>. Including a closing <tt class='helpCode'>&lt;/html&gt;</tt> tag at the bottom of the file is encouraged to keep the HTML valid. If choosing this option, make sure to read about <a href="#functions">Functions</a> below.</p>
		<h4>Option 2: Default Styling</h4>
		<p>To have your content appear similar to the <span class='tab'>HotKeys</span> and <span class='tab'>HotStrings</span> help tabs, it is possible `(<em>and encouraged</em>`) to use the same CSS `(and other helpers`) used by those tabs. This is how this file is setup, but it also includes additional CSS defined directly within this file. Look for the <tt class='helpCode'>&lt;style&gt;</tt> section for the on-page styles. There are many CSS and data helpers available for you use. For example, several tokens are available for defining how CSS classes should be applied to your content, as well as data tokens that will be replaced with actual values. In addition, any of the variables shown on the <span class='tab'>Variables</span> tab are available for use as well. Below are some examples of how to use most of the built-in functionality.</p>
		<table>
			<caption>Text Tokens</caption>
			<tr><td colspan='3' class='header'>The following text tokens are recognized and will be replaced within your code with the necessary HTML and CSS to yield results as shown by its example.</td></tr>
			<tr>
				<th>Text Token</th>
				<th>Example</th>
				<th class='comment'>Comments</th>
			</tr>
			<tr>
				<td>&#123;gt&#125;</td>
				<td>{gt}</td>
				<td class='comment'>Because the greater-than sign must be escaped in HTML, this is an easier alternative to <span class='helpCode'>&amp;gt;</span></td>
			</tr>
			<tr>
				<td>&#123;lt&#125;</td>
				<td>{lt}</td>
				<td class='comment'>Because the less-than sign must be escaped in HTML, this is an easier alternative to <span class='helpCode'>&amp;lt;</span></td>
			</tr>
			<tr>
				<td>&#123;arrow_down&#125;</td>
				<td>{arrow_down}</td>
				<td class='comment'>An easy way to include the symbol for the pressing the Down arrow.</td>
			</tr>
			<tr>
				<td>&#123;arrow_left&#125;</td>
				<td>{arrow_left}</td>
				<td class='comment'>An easy way to include the symbol for the pressing the Left arrow.</td>
			</tr>
			<tr>
				<td>&#123;arrow_right&#125;</td>
				<td>{arrow_right}</td>
				<td class='comment'>An easy way to include the symbol for the pressing the Right arrow.</td>
			</tr>
			<tr>
				<td>&#123;arrow_up&#125;</td>
				<td>{arrow_up}</td>
				<td class='comment'>An easy way to include the symbol for the pressing the Up arrow.</td>
			</tr>
			<tr>
				<td>&#123;curly_dquote_open&#125;</td>
				<td>{curly_dquote_open}</td>
				<td class='comment'>An easy way to include the symbol for open double-curly quotes.</td>
			</tr>
			<tr>
				<td>&#123;curly_dquote_close&#125;</td>
				<td>{curly_dquote_close}</td>
				<td class='comment'>An easy way to include the symbol for closing double-curly quotes.</td>
			</tr>
			<tr>
				<td>&#123;curly_squote_open&#125;</td>
				<td>{curly_squote_open}</td>
				<td class='comment'>An easy way to include the symbol for an open single-curly quote.</td>
			</tr>
			<tr>
				<td>&#123;curly_squote_close&#125;</td>
				<td>{curly_squote_close}</td>
				<td class='comment'>An easy way to include the symbol for a closing open single-curly quote.</td>
			</tr>
			<tr>
				<td>&#123;date&#125;</td>
				<td>{date}</td>
				<td class='comment'>The value will always use the current date.</td>
			</tr>
			<tr>
				<td>&#123;day&#125;</td>
				<td>{day}</td>
				<td class='comment'>The value will always use the current date.</td>
			</tr>
			<tr>
				<td>&#123;ddd&#125;</td>
				<td>{ddd}</td>
				<td class='comment'>The value will always use the current date.</td>
			</tr>
			<tr>
				<td>&#123;dtms&#125;</td>
				<td>{dtms}</td>
				<td class='comment'>The value will always use the current date/time.</td>
			</tr>
			<tr>
				<td>&#123;dts&#125;</td>
				<td>{dts}</td>
				<td class='comment'>The value will always use the current date.</td>
			</tr>
			<tr>
				<td>&#123;ip&#125;</td>
				<td>{ip}</td>
				<td class='comment'>An easy way to show the current IP address.</td>
			</tr>
			<tr>
				<td>&#123;mmm&#125;</td>
				<td>{mmm}</td>
				<td class='comment'>The value will always use the current date.</td>
			</tr>
			<tr>
				<td>&#123;month&#125;</td>
				<td>{month}</td>
				<td class='comment'>The value will always use the current date.</td>
			</tr>
			<tr>
				<td>&#123;now&#125;</td>
				<td>{now}</td>
				<td class='comment'>The value will always use the current date/time.</td>
			</tr>
			<tr>
				<td>&#123;pointer&#125;</td>
				<td>{mono}{pointer}{mono}</td>
				<td class='comment'>A right-angle line and arrow pointing to the right. `(__Shown here wrapped in {bold}&#123;mono&#125;{bold} tags__`)</td>
			</tr>
			<tr>
				<td>&#123;time&#125;</td>
				<td>{time}</td>
				<td class='comment'>The value will always use the current time.</td>
			</tr>
			<tr>
				<td>&#123;tms&#125;</td>
				<td>{tms}</td>
				<td class='comment'>The value will always use the current time.</td>
			</tr>
			<tr>
				<td>&#123;wheel_down&#125;</td>
				<td>{wheel_down}</td>
				<td class='comment'>An easy way to include the symbol for scrolling the mouse wheel down.</td>
			</tr>
			<tr>
				<td>&#123;wheel_left&#125;</td>
				<td>{wheel_left}</td>
				<td class='comment'>An easy way to include the symbol for tilting the mouse wheel left.</td>
			</tr>
			<tr>
				<td>&#123;wheel_right&#125;</td>
				<td>{wheel_right}</td>
				<td class='comment'>An easy way to include the symbol for tilting the mouse wheel right.</td>
			</tr>
			<tr>
				<td>&#123;wheel_up&#125;</td>
				<td>{wheel_up}</td>
				<td class='comment'>An easy way to include the symbol for scrolling the mouse wheel up.</td>
			</tr>
		</table>

	)
	contentCustom = %contentCustom%
	(
		<table>
			<caption>CSS Tokens</caption>
			<tr><td colspan='3' class='header'>The following text patterns are recognized and will be replaced within your code with the necessary HTML and CSS to yield results as shown by its example.</td></tr>
			<tr>
				<th>CSS Token</th>
				<th>Example</th>
				<th>Comments</th>
			</tr>
			<tr>
				<td>]&#45;</td>
				<td>]-</td>
				<td class='comment'>Replaces a simple dash with an HTML non-breaking hyphen, which is also smaller.</td>
			</tr>
			<tr>
				<td>&#91;&#91;abcd&#93;&#93; or Win-&#123;keys&#125;[&#123;keys&#125;ABC&#123;keys&#125;]&#123;keys&#125;</td>
				<td>[[abcd]] or Win-{keys}[{keys}ABCD{keys}]{keys}</td>
				<td class='comment'>Used to indicate ___one___ of listed keys should be pressed.</td>
			</tr>
			<tr>
				<td>some &#95;&#95;&#95;bold, italic&#95;&#95;&#95; text</td>
				<td>some ___bold, italic___ text</td>
				<td class='comment'>Same as <span class='helpMono'>&#123;bold&#125;</span> plus <span class='helpMono'>&#123;italic&#125;</span>.</td>
			</tr>
			<tr>
				<td>some &#95;&#95;italic&#95;&#95; text</td>
				<td>some __italic__ text</td>
				<td class='comment'>Same as <span class='helpMono'>&#123;italic&#125;</span>.</td>
			</tr>
			<tr>
				<td>&#123;mod&#125;&#95;&#95;colored and &#123;base&#125;normal&#123;base&#125; text&#95;&#95;&#123;mod&#125;</td>
				<td>{mod}__colored and {base}normal{base} text__{mod}</td>
				<td class='comment'>Used to reset text to the base color, weight and style</td>
			</tr>
			<tr>
				<td>some &#123;bold&#125;bold&#123;bold&#125; text</td>
				<td>some {bold}bold{bold} text</td>
				<td class='comment'>Used to add emphasis for some text, or in some cases appear slightly larger.</td>
			</tr>
			<tr>
				<td>some &#123;center&#125;centered&#123;center&#125; text</td>
				<td>{center}some centered text{center}</td>
				<td class='comment'>Used to display text across both columns within a HotKey or HotString section and to center the text within the available area. Similar to <span class='helpMono'>&#123;span&#125;</span>.</td>
			</tr>
			<tr>
				<td>some &#123;code&#125;highlighted&#123;code&#125; text</td>
				<td>some {code}highlighted{code} text</td>
				<td class='comment'>Used to indicate text that will be generated is usually related to programming code.</td>
			</tr>
			<tr>
				<td>abc&#123;endKey&#125;</td>
				<td>abc{endKey}</td>
				<td class='comment'>Used to indicate any whitespace or punctuation is required as the final character to trigger a HotString. This is usally only needed if the trigger itself is a common phrase or is contained within another word.</td>
			</tr>
			<tr>
				<td>abc&#123;endSpace&#125;</td>
				<td>abc{endSpace}</td>
				<td class='comment'>Used to indicate a space is required as the final character to trigger a HotString. This is usally only needed if the trigger itself is a common phrase or is contained within another word.</td>
			</tr>
			<tr>
				<td>&#123;explorer&#125;some simple text&#123;explorer&#125;</td>
				<td>{explorer}some simple text{explorer}</td>
				<td class='comment'>Used to indicate something is specific to when Windows Explorer is the focused window.</td>
			</tr>
			<tr>
				<td>&#123;frac&#125;&#x215B; &#x2159; &#x2155; &#x00BC; &#x2153; &#x215C; &#x2156; &#x00BD; &#x2157; &#x215D; &#x2154; &#x00BE; &#x2158; &#x215A; &#x215E;&#123;frac&#125;</td>
				<td>{frac}&#x215B; &#x2159; &#x2155; &#x00BC; &#x2153; &#x215C; &#x2156; &#x00BD; &#x2157; &#x215D; &#x2154; &#x00BE; &#x2158; &#x215A; &#x215E;{frac}</td>
				<td class='comment'>Used to display fraction symbols in a more consistent font style and weight. Many fonts do this poorly, such as: <span class='nowrap'>&#x215B;&nbsp; &#x2159;&nbsp; &#x2155;&nbsp; &#x00BC;&nbsp; &#x2153;&nbsp; &#x215C;&nbsp; &#x2156;&nbsp; &#x00BD;&nbsp; &#x2157;&nbsp; &#x215D;&nbsp; &#x2154;&nbsp; &#x00BE;&nbsp; &#x2158;&nbsp; &#x215A;&nbsp; &#x215E;</span></td>
			</tr>
			<tr>
				<td>some &#123;hex&#125;highlighted&#123;hex&#125; text</td>
				<td>some {hex}highlighted{hex} text</td>
				<td class='comment'>Used to indicate the expected value should be a hexadecimal character`(s`). There is a small amount of extra padding on the left/right sides.</td>
			</tr>
			<tr>
				<td>some &#123;indent&#125;indented&#123;indent&#125; text</td>
				<td>some {indent}indented{indent} text</td>
				<td class='comment'>Used to indent some text.</td>
			</tr>
			<tr>
				<td>some &#123;italic&#125;italic&#123;italic&#125; text</td>
				<td>some {italic}italic{italic} text</td>
				<td class='comment'>Used to add emphasis for some text.</td>
			</tr>
			<tr>
				<td>&#123;jiraDefault&#125;some wrapped text&#123;jiraDefault&#125;</td>
				<td>{jiraDefault}some wrapped text{jiraDefault}</td>
				<td class='comment'>Commonly used with <span class='helpMono'>&#123;panelRow&#125;</span> `(within a HotKey or HotString section`) to keep the right-side text better aligned with the panel.</td>
			</tr>
			<tr>
				<td>&#123;jiraBlue&#125;some wrapped text&#123;jiraBlue&#125;</td>
				<td>{jiraBlue}some wrapped text{jiraBlue}</td>
				<td class='comment'>Commonly used with <span class='helpMono'>&#123;panelRow&#125;</span> `(within a HotKey or HotString section`) to keep the right-side text better aligned with the panel.</td>
			</tr>
			<tr>
				<td>&#123;jiraGreen&#125;some wrapped text&#123;jiraGreen&#125;</td>
				<td>{jiraGreen}some wrapped text{jiraGreen}</td>
				<td class='comment'>Commonly used with <span class='helpMono'>&#123;panelRow&#125;</span> `(within a HotKey or HotString section`) to keep the right-side text better aligned with the panel.</td>
			</tr>
			<tr>
				<td>&#123;jiraRed&#125;some wrapped text&#123;jiraRed&#125;</td>
				<td>{jiraRed}some wrapped text{jiraRed}</td>
				<td class='comment'>Commonly used with <span class='helpMono'>&#123;panelRow&#125;</span> `(within a HotKey or HotString section`) to keep the right-side text better aligned with the panel.</td>
			</tr>
			<tr>
				<td>&#123;jiraYellow&#125;some wrapped text&#123;jiraYellow&#125;</td>
				<td>{jiraYellow}some wrapped text{jiraYellow}</td>
				<td class='comment'>Commonly used with <span class='helpMono'>&#123;panelRow&#125;</span> `(within a HotKey or HotString section`) to keep the right-side text better aligned with the panel.</td>
			</tr>
			<tr>
				<td>some &#123;live&#125;live&#123;live&#125; text</td>
				<td>some {live}live{live} text</td>
				<td class='comment'>Used to indicate the replacement value will be calculated at the time the HotString was triggered.</td>
			</tr>
			<tr>
				<td>&#123;mod&#125;CS&#123;mod&#125;-L</td>
				<td>{mod}CS{mod}-L</td>
				<td class='comment'>Used to highlight the abbreviation for the modifier of a HotKey.</td>
			</tr>
			<tr>
				<td>some &#123;mono&#125;monospaced&#123;mono&#125; text</td>
				<td>some {mono}monospaced{mono} text</td>
				<td class='comment'>Used to make monospaced text stand out a little more via a slightly larger font size and using a font that helps some symbols be displayed more clearly `(such as <span class='helpMono'>&#123;pointer&#125;</span>`).</td>
			</tr>
			<tr>
				<td>some &#123;mouse&#125;highlighted&#123;mouse&#125; text</td>
				<td>some {mouse}highlighted{mouse} text</td>
				<td class='comment'>Used to indicate something is specific to the mouse button`(s`). There is a small amount of extra padding on the left/right sides.</td>
			</tr>
			<tr>
				<td>some &#123;myVar&#125;highlighted&#123;myVar&#125; text</td>
				<td>some {myVar}highlighted{myVar} text</td>
				<td class='comment'>Used to indicate something is specific to any of the <span class='helpMono'>&#123;MY_*&#125;</span> variables.</td>
			</tr>
			<tr>
				<td>&#123;note&#125;My note goes here.&#123;note&#125;</td>
				<td>{note}My note goes here.{note}</td>
				<td class='comment'>Used to display a note within a HotKey or HotString section. This will span both columns within the section, and has various margins, padding, and width.</td>
			</tr>
			<tr>
				<td>&#123;note&#125;&#123;center&#125;My note goes here.&#123;center&#125;&#123;note&#125;</td>
				<td>{note}{center}My note goes here.{center}{note}</td>
				<td class='comment'>Used to display a note within a HotKey or HotString section. This will span both columns within the section, and has various margins, padding, and width, with the text being centered. The <span class='helpMono'>&#123;center&#125;</span> tokens MUST go inside of the <span class='helpMono'>&#123;span&#125;</span> tokens to work properly.</td>
			</tr>
			<tr>
				<td>&#123;panelRow&#125;some text&#123;panelRow&#125;</td>
				<td>{panelRow}some text{panelRow}</td>
				<td class='comment'>Commonly used with <span class='helpMono'>&#123;jira*&#125;</span> tokens `(within a HotKey or HotString section`) to keep the left-side text better aligned with the panel.</td>
			</tr>
			<tr>
				<td>some &#123;right&#125;right-aligned&#123;right&#125; text</td>
				<td>Some {right}right-aligned{right} text</td>
				<td class='comment'>Used to right-align some text within the description portion of a HotKey or HotString section. Typically used as a pseudo third column.</td>
			</tr>
			<tr>
				<td>&#123;span&#125;some spanned text&#123;span&#125;</td>
				<td>{span}some spanned text{span}</td>
				<td class='comment'>Used to display text across both columns within a HotKey or HotString section. Similar to <span class='helpMono'>&#123;center&#125;</span>.</td>
			</tr>
			<tr>
				<td>some &#123;symlist&#125;!@#$`%^&amp;[]{}<>&#123;symlist&#125; list</td>
				<td>some {symlist}!@#$`%^&amp;[]{}<>{symlist} list</td>
				<td class='comment'>Used to display a list of monospaced symbols, so they are easier to view on-screen.</td>
			</tr>
			<tr>
				<td>some &#123;uni&#125;&amp;#x2663;&#123;uni&#125; text</td>
				<td>some {uni}&#x2663;{uni} text</td>
				<td class='comment'>Used to display a unicode character. It will be right-aligned with padding on the right.</td>
			</tr>
			<tr>
				<td>some &#123;uni uniAlt&#125;&amp;#x2665;&#123;uni uniAlt&#125; text</td>
				<td>some {uni uniAlt}&#x2665;{uni uniAlt} text</td>
				<td class='comment'>Used to display a unicode character with alternate right-padding. Helpful when displaying unicode characters in a column and they tend to be displayed too close `(vertically`) to one another.</td>
			</tr>
			<tr>
				<td>some &#123;wheel&#125;highlighted&#123;wheel&#125; text</td>
				<td>some {wheel}highlighted{wheel} text</td>
				<td class='comment'>Used to indicate something is specific to the mouse wheel. There is a small amount of extra padding on the left/right sides.</td>
			</tr>
			<tr>
				<td>&#91;W-H&#93;</td>
				<td>[W]-H</td>
				<td class='comment'>Used to highlight the abbreviation for the modifier of a HotKey. This also replaces the dash with the non-breaking hyphen.</td>
			</tr>
		</table>
		<table class='noGap'>
			<caption>Nested Tokens</caption>
			<tr>
				<td class='noBorder comment'>Tokens may be nested to aggregate their effects, but they must be closed in the same manner as HTML tags `(reverse order`).</td>
			</tr>
		</table>
		<p class='noGap'>{bold}Before:{bold}</p>
		<div class='flex noGap'>
			<blockquote class='code'>normal text &#123;bold&#125;bold text &#123;code&#125;some bold code&#123;code&#125; more bold&#123;bold&#125; back to normal</blockquote>
		</div>
		<p class='noGap'>{bold}After:{bold}</p>
		<div class='flex noGap'>
			<blockquote class='code'>normal text {bold}bold text {code}some bold code{code} more bold{bold} back to normal</blockquote>
		</div>

	)
	contentCustom = %contentCustom%
	(
		<h3>HotKey and HotString examples</h3>
		<p>If you would like to include HotKey and HotString help that looks similar to how HotScript's look, the examples below will provide the information you will need. The basic `(HTML`) structure used is a table with one row and seven columns. The four primary columns contain the content, while the three remaining columns are used as gap `(spacer`) between the four primary columns. To visualize this, it looks something like this:</p>
		<div class='flex'>
			<blockquote class='code'>[content] [gap] [content] [gap] [content] [gap] [content]</blockquote>
		</div>
		<p>Further, each content column may contain sections. Each section should contain a header and any number of "rows". Here, a "row" is described either as a pairing of <tt class='helpCode'>{lt}hk{gt}{lt}hkd{gt}</tt> tags or <tt class='helpCode'>{lt}hs{gt}{lt}hsd{gt}</tt> tags. </p>
		<p>These are the default width settings for the different sections:</p>
		<div class='flex'>
			<blockquote class='code'>
				<ul>
					<li>section>row>hk {width:41`%;}</li>
					<li>section>row>hkd {width:59`%;}</li>
					<li>section>row>hs {width:25`%;}</li>
					<li>section>row>hsd {width:75`%;}</li>
				</ul>
			</blockquote>
		</div>
		<p>The example below uses three columns. To accommodate this, you ___must___ override the CSS class <tt class='helpCode'>table#help td:nth-child`(2n+1`)</tt> and change the default width to match the number of columns accordingly:</p>

	)
	contentCustom = %contentCustom%
	(
		<table class='auto indent'>
			<tr>
				<th>Columns</th>
				<th>Width</th>
			</tr>
			<tr>
				<td>1</td><td>100`%</td>
			</tr>
			<tr>
				<td>2</td><td>50`%</td>
			</tr>
			<tr>
				<td>3</td><td>33`%</td>
			</tr>
			<tr>
				<td>4</td><td>25`%</td>
			</tr>
			<tr>
				<td>5</td><td>20`%</td>
			</tr>
		</table>
		<p>Because the example below uses three columns, the following code is defined within this page:</p>
		<div class='flex'>
			<blockquote class='code'>table#help td:nth-child`(2n+1`) {width:33`%;}</blockquote>
		</div>
		<p>The width for the triggers and contents may be adjusted in the same manner. The example below has had the content width adjusted for both HotKeys and HotStrings. It may not appear necessary to adjust the width values for both the trigger section and the description section if only one of them will be made smaller, but eventually this could cause an issue with improper alignment. It is best to make sure the two values add up to be 100`%. The following code is defined within this page:</p>
		<div class='flex'>
			<blockquote class='code'>
				section>row>hk {width:35`%;}<br/>
				section>row>hkd {width:65`%;}<br/>
				section>row>hs {width:25`%;}<br/>
				section>row>hsd {width:75`%;}
			</blockquote>
		</div>
		<table id='help'>
			<tr>
				<td>
					<div>
						<section>
							<header>
								<span class='name'>HotKey 1</span>
							</header>
							<row>
								<hk><c>{mod}W{mod}-A</c></hk>
								<hkd>Something with Win-A</hkd>
								<hk><c>{mod}W{mod}-B</c></hk>
								<hkd>Something with Win-B</hkd>
								<hk><c>{mod}W{mod}-C</c></hk>
								<hkd>Something with Win-C</hkd>
							</row>
						</section>
						<section>
							<header>
								<span class='name'>HotKey 2</span>
								<span class='info'>Status: <span class='value'>Value</span></span>
							</header>
							<row>
								<hk><c>{mod}W{mod}-1</c></hk>
								<hkd>Something with Win-1</hkd>
								<hk><c>{mod}W{mod}-[[2-8]]</c></hk>
								<hkd>Something with Win-2 through Win-8</hkd>
								<hk><c>{mod}W{mod}-9</c></hk>
								<hkd>Something with Win-9</hkd>
							</row>
						</section>
					</div>
				</td>
				<td>&nbsp;</td>
				<td>
					<div>
						<section>
							<header>
								<span class='name'>HotString 1</span>
							</header>
							<row>
								<hs><c>@abc</c></hs>
								<hsd>Some text here</hsd>
								<hs><c>@def</c></hs>
								<hsd>{live}Some live text{live}{right}`(___extra info here___`){right}</hsd>
								<hs><c>ty{endKey}</c></hs>
								<hsd>Thank you.</hsd>
							</row>
						</section>
						<section>
							<header>
								<span class='name'>HotString 2</span>
							</header>
							<row>
								<hs><c>@jkl</c></hs>
								<hsd>Some text here</hsd>
								<hs><c>@club</c></hs>
								<hsd>Club{uni}&#x2663;{uni}</hsd>
								<hs><c>@diam</c></hs>
								<hsd>Diamond{uni uniAlt}&#x2666;{uni uniAlt}</hsd>
							</row>
						</section>
					</div>
				</td>
				<td>&nbsp;</td>
				<td>
					<div>
						<section>
							<header>
								<span class='name'>Hybrid</span>
								<span class='info'>
									<span class='desc'>[Mixed]</span> Contains <span class='value'>HotKeys</span> and <span class='value'>HotStrings</span>
								</span>
							</header>
							<row>
								<hk><c>{mod}W{mod}-X</c></hk>
								<hkd>There is a blank line below</hkd>
								{span}&nbsp;{span}
								<hk><c>{mod}W{mod}-Y</c></hk>
								<hkd>There is a blank line above</hkd>
								<hk><c>{mod}W{mod}-Z</c></hk>
								<hkd>Something with Win-Z</hkd>
								{span}<hr>{span}
								{center}This text is centered and spans both columns.{center}
								<hs><c>@xyz</c></hs>
								<hsd>Some text here</hsd>
								<hs><c>@zzz</c></hs>
								<hsd>Going to sleep...</hsd>
								{note}{center}Some useful information about this section goes here.{center}{note}
							</row>
						</section>
					</div>
				</td>
			</tr>
		</table>
		<p>To see how these sections were created, view the source code of this file `(<tt class='file'>HotScriptCustomHelp.html</tt>`). For the internal styling to be applied to your table, it must be created with the correct ID value, as shown below.</p>
		<div class='flex'>
			<blockquote class='code'>
				{lt}table id='help'{gt}
			</blockquote>
		</div>

	)
	contentCustom = %contentCustom%
	(
		<h3 id="functions">Functions</h3>
		<p>Regardless if you are choosing option 1 `(custom styling`) or option 2 `(default styling`), there are some functions that can assist you with further refining your content.</p>
		<table class='normal'>
			<tr>
				<th>Function</th>
				<th>Comments</th>
			</tr>
			<tr>
				<td class='helpCode nowrap'>helpPrep`(html`)</td>
				<td class='comment'>
					<p>The <tt class='helpCode'>html</tt> parameter is a string containing the HTML contents to be rendered. Modifies the contents of it as necessary and returns it at the end of the function. All Text and CSS Tokens defined in this document will be replaced.</p>
				</td>
			</tr>
			<tr>
				<td class='helpCode nowrap'>getCommonHelp`(reset`)</td>
				<td class='comment'>
					<p>Returns a base HTML structure containing the CSS definitions listed above. It is meant to be used as a wrapper for your content.</p>
					<p>The <tt class='helpCode'>reset</tt> parameter is a boolean that when true will reset the margin and padding CSS values to 0. The default value for <tt class='helpCode'>reset</tt> is false. When true, the following CSS will be injected into the returned HTML:</p>
					<div class='flex'>
						<blockquote class='code'>
							* {margin:0;padding:0;}
						</blockquote>
					</div>
					<p>The {lt}body{gt} contains only the following:</p>
					<div class='flex'>
						<blockquote class='code'>
							{lt}div class='wrapper base'{gt}{content}{lt}/div{gt}
						</blockquote>
					</div>
					<p>You must generate `(either reading it from a file or via a function`) the HTML content.</p>
					<p>
						contentHS := helpPrep`(StrReplace`(getHelpCommon`(true`), "{content}", contentHS`)`)
						contentVar := StrReplace`(getHelpCommon`(`), "{content}", "This is the VARIABLES tab."`)
					</p>
				</td>
			</tr>
			<tr>
				<td class='helpCode nowrap'>getUserHelpTabs`(`)</td>
				<td class='comment'>
					<p>___This is a user-defined function___ `(usually in <tt class='file'>HotScriptFunctions.ahk</tt>`).</p>
					<p>The function is expected to return an array of objects `(aka: associative array`). Each object in the array represents a tab to be displayed. The basics for how to implement this function were described in the <a href='#setup'>Setup</a> section above. This function also searves an important role by allowing the content to be truly customized before it is passed on to HotScript. A very brief example of this was shown for the two custom tabs in the <span class='helpCode'>readAndPrepHelp`(`)</span> function, though the same functionality could be included directly within this function, too. The example below shows a bit more about how to customize your content at run-time.</p>
					<p>Within this function, the contents of this file may be altered via custom processing. Any special text transformation or manipulation may be performed. To perform the built-in processing, include a call to <tt class='helpCode'>helpPrep`(`)</tt> within your custom processing. It is expected that the final HTML content `(as a string`) will be added to the associative array for the tab as the <tt>content</tt> parameter. Any number of transformations may be done to it up to that point. An example for loading and tranforming content within this function could look like this:</p>
					<div class='flex'>
						<blockquote class='code'>
							<pre>getUserHelpTabs`(`) {
	tabs := []
	myHtml := FileRead`("C:\data\myCustomHelp.html"`)
	myHtml := StrReplace`(myHtml, "{myCustomToken}", "My custom value!"`)
	myHtml := RegexReplace`(myHtml, "{\b`(bigText|myText|otherText`)\b}`(.*?`){\1}", "<span class='$1'>$2</span>"`)
	tabs.push`({name: "My Custom Help", content: helpPrep`(myHtml`)})
	return tabs
}</pre>
						</blockquote>
					</div>
					<p>The code above performs all of the following replacements:</p>
					<table class='indent' style='text-align:left;width:auto;'>
						<tr>
							<th>Find</th>
							<th>Replace</th>
						</tr>
						<tr>
							<td class='customToken'>{myCustomToken}</td>
							<td class='customValue'>My custom value!</td>
						</tr>
						<tr>
							<td class='customToken'>{bigText}big words{bigText}</td>
							<td class='customValue'>{lt}span class='bigText'{gt}big words{lt}/span{gt}</td>
						</tr>
						<tr>
							<td class='customToken'>{myText}my words{myText}</td>
							<td class='customValue'>{lt}span class='myText'{gt}my words{lt}/span{gt}</td>
						</tr>
						<tr>
							<td class='customToken'>{otherText}other words{otherText}</td>
							<td class='customValue'>{lt}span class='otherText'{gt}other words{lt}/span{gt}</td>
						</tr>
						<tr>
							<td class='comment'>All Text and CSS Tokens documented in this help</td>
							<td class='comment'>All replacements documented in this help</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<h3>JavaScript</h3>
		<p>Use of JavaScript is supported to allow dynamic behavior. Anything that can be done with JavaScript is valid and available to use for your own help screens, including using external JavaScript libraries such as <a href='https://jquery.com' target='_blank'>jQuery</a> or <a href='https://getbootstrap.com' target='_blank'>Bootstrap</a>. The two buttons below use on-page JavaScript.</p>
		<div class='indent'>
			<button onClick='showMsg`(`)' id='clickMe'>Click Me</button>
			<button onClick='toggle`(`)'>Toggle</button>
		</div>
		<h3>Conclusion</h3>
		<p>This concludes the custom help walk-through and how-to. Everything you need to know to be able to create your custom content has been documented here. Now, go make some custom help!</p>
	</div>
</div>
<script>
	function showMsg`(`) {
		alert`('You clicked the button.\n\nThis message is displayed via on-page JavaScript.'`);
	}
	function toggle`(`) {
		var btn = document.getElementById`('clickMe'`);
		btn.style.visibility = `(btn.style.visibility === '' ? 'hidden' : ''`)
	}
</script>

	)
	}
	return contentCustom
}

getHelpContentVariables() {
	static varGroups := ""
	static num := 0
	static sysVars := []
	static sysVals := {}
	static userVars := []
	static userVals := {}
	if (varGroups == "") {
		varGroups := {}
		varGroups[++num] := varGroup("Date and Time", "AutoHotkey", "A_DD", "A_DDD", "A_DDDD", "A_Hour", "A_MDAY", "A_Min", "A_MM", "A_MMM", "A_MMMM", "A_Mon", "A_MSec", "A_Now", "A_NowUTC", "A_Sec", "A_TickCount", "A_WDay", "A_YDay", "A_Year", "A_YWeek", "A_YYYY")
		varGroups[++num] := varGroup("Operating System and Computer", "AutoHotkey", "A_AppData", "A_AppDataCommon", "A_ComputerName", "A_ComSpec", "A_Desktop", "A_DesktopCommon", "A_IPAddress1", "A_IPAddress2", "A_IPAddress3", "A_IPAddress4", "A_Is64bitOS", "A_IsAdmin", "A_Language", "A_MyDocuments", "A_OSType", "A_OSVersion", "A_ProgramFiles", "A_Programs", "A_ProgramsCommon", "A_PtrSize", "A_ScreenDPI", "A_ScreenHeight", "A_ScreenWidth", "A_StartMenu", "A_StartMenuCommon", "A_Startup", "A_StartupCommon", "A_Temp", "A_TimeIdle", "A_TimeIdleKeyboard", "A_TimeIdleMouse", "A_TimeIdlePhysical", "A_UserName", "A_WinDir", "ComSpec", "ProgramFiles")
		varGroups[++num] := varGroup("Miscellaneous", "AutoHotkey", "A_AhkPath", "A_AhkVersion", "A_AutoTrim", "A_BatchLines", "A_CaretX", "A_CaretY", "A_ControlDelay", "A_CoordModeCaret", "A_CoordModeMenu", "A_CoordModeMouse", "A_CoordModePixel", "A_CoordModeToolTip", "A_Cursor", "A_DefaultGui", "A_DefaultListView", "A_DefaultMouseSpeed", "A_DefaultTreeView", "A_DetectHiddenText", "A_DetectHiddenWindows", "A_EndChar", "A_EventInfo", "A_ExitReason", "A_FileEncoding", "A_FormatFloat", "A_FormatInteger", "A_Gui", "A_GuiControl", "A_GuiControlEvent", "A_GuiEvent", "A_GuiHeight", "A_GuiWidth", "A_GuiX", "A_GuiY", "A_IconFile", "A_IconHidden", "A_IconNumber", "A_IconTip", "A_Index", "A_IsCompiled", "A_IsCritical", "A_IsPaused", "A_IsSuspended", "A_IsUnicode", "A_KeyDelay", "A_KeyDelayPlay", "A_KeyDuration", "A_KeyDurationPlay", "A_LastError", "A_LineFile", "A_LineNumber", "A_ListLines", "A_LoopField", "A_LoopFileAttrib", "A_LoopFileDir", "A_LoopFileExt", "A_LoopFileFullPath", "A_LoopFileLongPath", "A_LoopFileName", "A_LoopFilePath", "A_LoopFileShortName", "A_LoopFileShortPath", "A_LoopFileSize", "A_LoopFileSizeKB", "A_LoopFileSizeMB", "A_LoopFileTimeAccessed", "A_LoopFileTimeCreated", "A_LoopFileTimeModified", "A_LoopReadLine", "A_LoopRegKey", "A_LoopRegName", "A_LoopRegSubkey", "A_LoopRegTimeModified", "A_LoopRegType", "A_MouseDelay", "A_MouseDelayPlay", "A_NumBatchLines", "A_PriorHotkey", "A_PriorKey", "A_RegView", "A_ScriptDir", "A_ScriptFullPath", "A_ScriptHwnd", "A_ScriptName", "A_SendLevel", "A_SendMode", "A_Space", "A_StoreCapsLockMode", "A_StringCaseSense", "A_Tab", "A_ThisFunc", "A_ThisHotkey", "A_ThisLabel", "A_ThisMenu", "A_ThisMenuItem", "A_ThisMenuItemPos", "A_TimeSincePriorHotkey", "A_TimeSinceThisHotkey", "A_TitleMatchMode", "A_TitleMatchModeSpeed", "A_WinDelay", "A_WorkingDir", "ErrorLevel")
		Loop, HKLM, SYSTEM\CurrentControlSet\Control\Session Manager\Environment
		{
			RegRead, regVal
			sysVars.Push(A_LoopRegName)
			sysVals[A_LoopRegName] := regVal
		}
		varGroups[++num] := varGroup("Environment (System)", "Windows", sysVars*)
		Loop, HKCU, Environment
		{
			RegRead, regVal
			userVars.Push(A_LoopRegName)
			userVals[A_LoopRegName] := regVal
		}
		varGroups[++num] := varGroup("Environment (User)", "Windows", userVars*)
		;varGroups[++num] := varGroup("User-Defined", "HotScript", "")
		myVars := []
		for myVarKey in hs.internal.defaultMyVars {
			myVars.Push("MY_" . myVarKey)
		}
		varGroups[++num] := varGroup("Internal", "HotScript", "hs.BASENAME", "hs.const.COMMENT_HEADER_LINE", "hs.const.END_CHARS_REGEX", "hs.const.EOL_MAC", "hs.const.EOL_NIX", "hs.const.EOL_WIN", "hs.const.HTML_COLORS", "hs.const.INDENT", "hs.const.MENU_COLORS", "hs.const.REPLACE_MODE", "hs.const.VIRTUAL_SPACE", "hs.file.CONFIG_DEFAULT", "hs.file.CONFIG_USER", "hs.file.ICON", "hs.file.UPDATE", "hs.file.USER_FUNCTIONS", "hs.file.CUSTOM_HELP", "hs.file.USER_INCLUDES", "hs.file.USER_KEYS", "hs.file.USER_STRINGS", "hs.file.USER_VARIABLES", "hs.TITLE", "hs.vars.hotStringEndChar", "hs.vars.lastHotKey", "hs.vars.lastHotString", "hs.vars.monitors", "hs.vars.uniqueId", "hs.vars.url.ahk.download", "hs.vars.url.ahk.install", "hs.vars.url.ahk.version", "hs.vars.url.HotScript.download", "hs.vars.url.HotScript.forum", "hs.vars.url.HotScript.history", "hs.vars.url.HotScript.home", "hs.vars.url.HotScript.userManual", "hs.vars.url.HotScript.version", "hs.VERSION", myVars*)
	}
	contentVar =
	(LTrim
		<style>
			*:focus {outline:none;}
			h3 {background-color:darkSeaGreen;border-radius:.4em;color:white;margin:0 0 .5em 0;padding:.5em .75em;}
			pre {font-family:Consolas,Courier;margin:0;white-space:pre-wrap;}
			th {background:#99BCE8;padding:.5em;text-align:left;}
			div.container {background:#F0F0F0;border:.05em solid mediumBlue;border-radius:.5em;font-size:1.29em;margin-top:1em;padding:.5em;}
			div.content {height:41.5em;overflow-y:auto;padding-right:1em;scrollbar-face-color:lightSteelBlue;scrollbar-track-color:#F0F0F0;}
			div.content > div, div.content > h3, div.content > p {margin-left:1em;}
			div.content > h2 {text-align:center;}

			div.keyHelp {background:lightGray;border:.1em solid #888;border-radius:.5em;display:table;margin:0 0 2em 5em !important;padding:.5em;}
			table.keyHelp {}
			table.keyHelp td.gap {width:2em;}
			table.keyHelp td.desc {padding-left:1em;}
			table.keyHelp div.line {border-left:.1em solid coral;height:5em;width:0;}

			div.vars {border-collapse:collapse;margin-bottom:2em;}
			table.vars {margin:0 1em 3em 5em;table-layout:fixed;overflow-wrap:break-word;width:93`%;}
			table.vars tr:not`(:first-child`) {border-bottom:.1em solid #ccc;}
			table.vars th:nth-child`(odd`) {width:30`%;}
			table.vars th:nth-child`(even`) {width:70`%;}
			table.vars td, table.vars th {padding:.25em;}
			table.vars td:nth-child`(odd`), .var {color:firebrick;font-family:Consolas,Courier;font-weight:bold}
			table.vars td:nth-child`(odd`) {vertical-align:top;}
			table.vars td:nth-child`(even`) {color:royalBlue;}
			table.vars tr.selected {background-color:#f7e6c4;}
			table.vars tr.hover {background-color:#bbeeee;}
			table.vars tr.hoverSelected {background-color:#e7bde7;}
			table.vars tr.filtered {display:none;}

			label {font-size:1.25em;font-weight:bold;margin:1em 0 1em 3.1em;}
			#filter {background-image:url`(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAACYktHRAD/h4/MvwAAAAl2cEFnAAABKgAAASkAUBZlMQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMy0wNC0xMFQwNjo1OTowNy0wNzowMI5BiVEAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTMtMDQtMTBUMDY6NTk6MDctMDc6MDD/HDHtAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAABF0RVh0VGl0bGUAc2VhcmNoLWljb27Cg+x9AAACKklEQVQ4T6WUSavqQBCFK+2sII7gShFXLpUsBBHFf+1KcAQFwaWiolsnnBDn++4p0iHRqPDuByFJd/Wp6qrqVn5+IQP3+52m0ymtVis6Ho885na7KRgMUiKR4O9vmEQHgwGNx2NyOp0khCBFUXgcJo/Hg67XK8ViMcpkMjz+Dl200+nQZrMhh8PBE4gYQgDidrudvzEOm2KxyP9WsCginM1mHKEUS6VSFA6HOWI4G41GPAfx2+1GgUCAVFXVZMwovwY/lUqFPB4PiyFn+XxemzbT6/VovV6z8Ol0olwux+LPCBQFEQKIvhME2WyWbWGHFCD/VghUGVvE1rDlb6TTabbFmuVyqY2aEWgbFALeI5GINvyeUCjEtlgju+IZoRWfkS30CURoxFJUNjMEt9stf38CNjJKIFvNiMBJgTebzcZt843hcMhCELWqPBDxeJwulwtvC/3X7/e1qVfgFD0rC5tMJrUZM8Lr9VI0GmVBRDCfz6nZbHI/Sna7HXW7XZpMJtxSiBIP1lmhH9NqtaqfGKQDTmQREBnSgwfmMqfYYblc1o+2xHShtNttLgSiee4EmMEp3hDBPJzikimVSuRyuTTLJ1GwWCz4pCB3UhiL/X4/Hw50C5zjLSM+n898weCogxdRIzAGxigAdtNqtV6EC4UC+Xy+z6Kf2O/31Gg0TMK4ZBDxf4uCw+FA9XpdF0aaUOg/iQLcHbVaTb/p0Cl/FgXIJ/oYnaCqKv0DC6dltH6Ks84AAAAASUVORK5CYII=`);background-position:.2em;background-repeat:no-repeat;background-size:1em;border:.1em solid dodgerBlue;border-radius:.5em;font-size:1.1em;margin:1em 0 1em .5em;padding:.25em .25em .25em 2em;width:40`%;}
			#filter:not(:focus) {font-style:italic;border-color:#ddd;}
			.helpCode {color:red;font-family:Consolas,Courier;font-weight:bold;}
			.key {color:mediumBlue;font-family:Consolas,Courier;font-style:normal;font-weight:bold;}
			.sub {color:khaki;float:right;}
			.varError {background:red;color:yellow;font-style:italic;padding:.15em;}
		</style>
		<div class='container'>
			<div class='content'>
				<h2>Variables</h2>
				<p>The variables below are built-in to HotScript and may be used by HotStrings, templates, and user-defined functions. With the exception of <span class='var'>ErrorLevel</span>, these variables are read-only `(their values cannot be changed`). Detailed information on each <span class='var'>A_*</span> variable is available by clicking its name.</p>
				<p>To access Windows' environment variables in your scripts, use the <span class='helpCode'>EnvGet`(VAR_NAME`)</span> function. For example: <span class='helpCode'>myPath := EnvGet`("PATH"`)</span></p>
				<p>HotScript uses a complex object to store all of its internal values. Some variables are mixed cased while other are uppercase. The uppercase variables are to signify that the value is typically set once and should not be changed, though nothing within the code prevents that. These variables should be treated as being static `(at worst`) and read-only `(at best`). Unless you truly understand what you are doing, you should never change any of HotScript's internal variables. To access a HotScript variable, refer to its full <em>dotted</em> name, such as:  <span class='var'>hs.vars.VERSION</span></p>
				<p>In the tables below, when the mouse is hovered over a variable row, it will become highlighted, which enables the actions shown below. To select more than one row, click anywhere on the highlighted row. Selected row`(s`) take precedence of a single hovered row. After copying, a short beep will sound as an indicator the copy was successful.</p>
				<div class='keyHelp'>
					<table class='keyHelp'>
						<tr>
							<td class='key'>Ctrl-F</td>
							<td class='desc'>Focus the Filter field</td>
							<td class='gap' rowspan='9'></td>
							<td rowspan='9'><div class='line'></div></td>
							<td class='gap' rowspan='9'></td>
							<td class='key'>Ctrl-C</td>
							<td class='desc'>Copy the name and value for the selected variable`(s`)</td>
						</tr>
						<tr>
							<td class='key'>Ctrl-A</td>
							<td class='desc'>Toggle selecting all variables</td>
							<td class='key'>Ctrl-N</td>
							<td class='desc'>Copy the name for the selected variable`(s`)</td>
						</tr>
						<tr>
							<td class='key'>Ctrl-U</td>
							<td class='desc'>Unselect all variables</td>
							<td><span class='key'>Ctrl-V</span> or <span class='key'>Space</span></td>
							<td class='desc'>Copy the value for the selected variable`(s`)</td>
						</tr>
						<tr>
							<td class='key'>Click</td>
							<td class='desc'>Toggle selecting highlighted variable</td>
						</tr>
					</table>
				</div>
				<div>
					<label for="filter">Filter:</label>
					<input type='text' id='filter' oninput='doFilter`(`)' placeholder='Filter by name or value...'>
				</div>
	)
	for idx, grp in varGroups {
		contentVar .= "<h3 class='group'>" . grp.name . "</h3><table class='vars'><tr><th>Name</th><th>Value</th></tr>"
		isAHK := InStr(grp.sub, "AutoHotkey")
		isWin := InStr(grp.sub, "Windows")
		isHotScript := InStr(grp.sub, "HotScript")
		for varName in grp.values {
			contentVar .= "<tr><td>"
			if (isAHK) {
				anchor := RegExReplace(varName, "^A_", "")
				anchor := RegExReplace(anchor, "^Caret.$", "Caret")
				anchor := RegExReplace(anchor, "^MouseDelay.+", "MouseDelay")
				anchor := RegExReplace(anchor, "^NumBatchLines$", "BatchLines")
				anchor := RegExReplace(anchor, "^CoordMode.+$", "CoordMode")
				anchor := RegExReplace(anchor, "^Loop.+$", "loop")
				anchor := RegExReplace(anchor, "^MDay", "DD")
				anchor := RegExReplace(anchor, "^Mon", "MM")
				anchor := RegExReplace(anchor, "^GuiHeight$", "GuiWidth")
				anchor := RegExReplace(anchor, "^Screen(Height|Width)$", "Screen")
				contentVar .= "<a href='https://autohotkey.com/docs/Variables.htm#" . anchor . "' target='_blank'>" . varName . "</a>"
			}
			else {
				contentVar .= varName
			}
			isVarError := false
			if (isHotScript) {
				try {
					varValue := getVar(varName)
					if (IsObject(varValue)) {
						varValue := toString(varValue)
						if (varName == "hs.const.HTML_COLORS") {
							tmpVal := ""
							Loop, Parse, varValue, % hs.const.EOL_NIX, % hs.const.EOL_MAC
							{
								if (RegexMatch(A_LoopField, "<(\d+)>", hexStr)) {
									tmpVal .= StrReplace(A_LoopField, hexStr1, toHex(hexStr1, 6))
								}
								else {
									tmpVal .= A_LoopField
								}
								tmpVal .= hs.const.EOL_NIX
							}
							varValue := tmpVal
						}
					}
				}
				catch e {
					isVarError := true
					varValue := "<span class='varError'>[Unable to read variable]</span>"
				}
			}
			else if (isWin) {
				if (contains(grp.name, "System")) {
					varValue := sysVals[varName]
				}
				else {
					varValue := userVals[varName]
				}
			}
			else {
				if (varName == "") {
					varValue := "TBD..."
				}
				else {
					varValue := %varName%
				}
			}
			if (!isVarError) {
				varValue := htmlEncode(varValue)
			}
			contentVar .= "</td><td><pre>" . varValue . "</pre></td></tr>"
		}
		contentVar .= "</table>"
	}
	contentVar .= "</div></div>"
	contentVar = %contentVar%
	(LTrim
		<script>
			var snd = new Audio`('data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU='`);
			var toggleAll = false;
			function addHandlers`(`) {
				var body = document.querySelectorAll`('body'`)[0];
				body.addEventListener`('keydown', doKeyPress`);
				body.addEventListener`('keypress', doKeyPress`);
				var filter = document.getElementById`('filter'`);
				filter.addEventListener`('keydown', doKeyPress`);
				filter.addEventListener`('keypress', doKeyPress`);
				var rows = document.querySelectorAll`('table.vars tr'`);
				for `(var i = 0; i < rows.length; i++`) {
					var row = rows[i];
					if `(isDataRow`(row`)`) {
						row.addEventListener`('click', doClick`);
						row.addEventListener`('mouseenter', doHover`);
						row.addEventListener`('mouseleave', doHover`);
					}
				}
				document.getElementsByTagName`('BODY'`)[0].focus`(`);
			}
			function beep`(`) {
				snd.play`(`);
			}
			function copyToClipboard`(str`) {
				var el = document.createElement`('textarea'`);
				el.value = str;
				document.body.appendChild`(el`);
				el.select`(`);
				document.execCommand`('copy'`);
				document.body.removeChild`(el`);
				beep`(`);
			}
			function copySelected`(column`) {
				var copyBoth = `(column == 'both'`);
				var copyName = `(copyBoth || column == 'name'`);
				var copyValue = `(copyBoth || column == 'value'`);
				var rows = document.querySelectorAll`('table.vars tr.selected:not`(.filtered`)'`);
				if `(rows.length == 0`) {
					rows = document.querySelectorAll`('table.vars tr.hover'`);
				}
				var content = '';
				for `(var i = 0; i < rows.length; i++`) {
					var row = rows[i];
					if `(isDataRow`(row`)`) {
						if `(copyName`) {
							content += row.children[0].innerText.trim`(`);
						}
						if `(copyBoth`) {
							content += '\t';
						}
						if `(copyValue`) {
							var value = unescape(row.children[1].innerText);
							if `(rows.length == 1`) {
								value = value.replace`(/`(\r?\n|\r`)$/, ''`);
							}
							else if `(value == ''`) {
								value += '\r\n';
							}
							content += value;
						}
						if `(rows.length > 1`) {
							content += '\r\n';
						}
					}
				}
				if `(content != ''`) {
					copyToClipboard`(content`);
				}
			}
			function doClick`(evt`) {
				var classList = evt.currentTarget.classList;
				classList.toggle`('selected'`);
				doHoverCheck`(classList`);
			}
			function doFilter`(`) {
				var filterValue = document.getElementById`('filter'`).value.toLocaleUpperCase`(`);
				var rows = document.querySelectorAll`('table.vars tr'`);
				for `(var i = 0; i < rows.length; i++`) {
					var row = rows[i];
					if `(isDataRow`(row`)`) {
						var classList = row.classList;
						var name = row.children[0].innerText.toLocaleUpperCase`(`);
						var value = row.children[1].innerText.toLocaleUpperCase`(`);
						if `(name.indexOf`(filterValue`) > -1 || value.indexOf`(filterValue`) > -1`) {
							classList.remove`('filtered'`);
						}
						else {
							classList.add`('filtered'`);
						}
					}
				}
				toggleAll = false;
			}
			function doHover`(evt`) {
				var classList = evt.currentTarget.classList;
				classList.toggle`('hover'`);
				doHoverCheck`(classList`);
			}
			function doHoverCheck`(classList`) {
				if `(classList.contains`('hover'`) && classList.contains`('selected'`)`) {
					classList.add`('hoverSelected'`);
				}
				else {
					classList.remove`('hoverSelected'`);
				}
			}
			function doKeyPress`(evt`) {
				var doPrevent = false;
				if `(evt.ctrlKey`) {
					var key = evt.key.toLowerCase();
					// A, C, N, U
					if `(evt.keyCode == 65 || key == 'a'`) {
						toggleAll = !toggleAll;
						selectAll`(toggleAll`);
						doPrevent = true;
					}
					else if `(evt.keyCode == 67 || key == 'c'`) {
						copySelected`('both'`);
						doPrevent = true;
					}
					else if (evt.keyCode == 70 || key == 'f') {
						document.getElementById('filter').focus();
						doPrevent = true;
					}
					else if `(evt.keyCode == 78 || key == 'n'`) {
						copySelected`('name'`);
						doPrevent = true;
					}
					else if `(evt.keyCode == 85 || key == 'u'`) {
						selectAll`(false`);
						doPrevent = true;
					}
					else if `(evt.keyCode == 86 || key == 'v'`) {
						copySelected`('value'`);
						doPrevent = true;
					}
				}
				else {
					if `(evt.keyCode == 32`) {
						var filter = document.getElementById`('filter'`);
						if (document.activeElement != filter) {
							copySelected`('value'`);
							doPrevent = true;
						}
					}
				}
				if (doPrevent) {
					evt.preventDefault`(`);
					evt.stopImmediatePropagation`(`);
				}
			}
			function isDataRow`(row`) {
				return `(row.childElementCount == 2 && row.children[0].tagName == 'TD'`);
			}
			function selectAll`(selected`) {
				var rows = document.querySelectorAll`('table.vars tr:not`(.filtered`)'`);
				for `(i = 1; i < rows.length; i++`) {
					var row = rows[i];
					if `(isDataRow`(row`)`) {
						var classList = row.classList;
						if `(selected`) {
							classList.add`('selected'`);
						}
						else {
							classList.remove`('selected'`);
						}
						doHoverCheck`(classList`);
					}
				}
			}
		</script>
	)
	contentVar := StrReplace(getHelpCommon(), "{content}", contentVar)
	contentVar := StrReplace(contentVar, "<body ", "<body onLoad='addHandlers()' ")
	return contentVar
}

getHelpLogo() {
	static logo := ""
	if (logo == "") {
		title := hs.TITLE
		homeUrl := hs.vars.url[title].home
		historyUrl := hs.vars.url[title].history
		hsVersion := hs.VERSION
		manualUrl := hs.vars.url[title].userManual
		logo =
		(LTrim Join`r`n
			<div class='logo'>
				<span class='title'>
					<a href='%homeUrl%' target='_blank' title='Home Page'><img src='%A_ScriptDir%/HotScript.ico'/></a>
					<a href='%manualUrl%' target='_blank' title='User Manual'>%title%</a>
					<span class='version'>v<a href='%historyUrl%' target='_blank' title='Historical Changes'>%hsVersion%</a></span>
				</span>
				<span class='copyright'>&copy; 2013-%A_YYYY%</span>
			</div>
		)
	}
	return logo
}

getHexColor(value:="", silent:=false) {
	value := Trim(value)
	if (value == "") {
		return ""
	}
	if (SubStr(value, 1, 1) == "#") {
		value := SubStr(value, 2)
	}
	else if (SubStr(value, 1, 2) == "0x") {
		value := SubStr(value, 3)
	}
	if (value ~= "i)^[a-f0-9]{6}$") {
		color := value
	}
	else if (is(value, "number") && value >= 0 && value <= 16777215) {
		color := toHex(value, 6)
	}
	else if (hs.const.HTML_COLORS.hasKey(value)) {
		color := toHex(hs.const.HTML_COLORS[value], 6)
	}
	else {
		if (!silent) {
			message("Unknown color value: " . toString(value) . getStackTraceStr(), "Invalid parameter - " . A_ThisFunc . "()", 16)
		}
		color := ""
	}
	return setCase(color, "L")
}

getHwnd(hWnd:="", allowHidden:=false) {
	allowHidden := toBool(allowHidden)
	if (!allowHidden) {
		dhw := A_DetectHiddenWindows
		DetectHiddenWindows, Off
	}
	hWnd := Trim(hWnd)
	if (hWnd == "") {
		hWnd := "A"
	}
	else if (is(hWnd, "number")) {
		hWnd := "ahk_id " . hWnd
	}
	foundHwnd := WinExist(hWnd)
	if (!allowHidden) {
		DetectHiddenWindows, %dhw%
	}
	return foundHwnd
}

getHwndForPid(pid) {
	pidStr := "ahk_pid " . pid
	WinGet, hWnd, ID, %pidStr%
	return hWnd
}

getIndent() {
	if (isActiveDos()) {
		result := hs.const.INDENT
	}
	else {
		SendInput, +{Home}
		; TODO - before trying to getSelectedText(), test if we are at position 1 already by using Ctrl-C
		; if the buffer is empty, we are at pos 1, so no indent!
		result := getSelectedText()
		if (!RegexMatch(result, "^[ \t]*$")) {
			SendInput, +{Home}
			result2 := getSelectedText()
			if (StrLen(result2) > StrLen(result)) {
				result := result2
			}
			tmp := result
			result := ""
			isBlank := true
			Loop, Parse, tmp
			{
				if (isBlank) {
					if (isBlank && RegexMatch(A_LoopField, "[ \t]")) {
						result .= A_LoopField
					}
					else {
						isBlank := false
					}
				}
			}
		}
		SendInput, {End}
	}
	return result
}

getIndent1(indent) {
	return (contains(indent, A_Tab) ? A_Tab : hs.const.INDENT)
}

getListSize(list, delim:="") {
	delim := (delim == "" ? hs.const.EOL_WIN : delim)
	tmpCount := 0
	Loop, Parse, list, %delim%
	{
		tmpCount++
	}
	return tmpCount
}

getMenuColor(name) {
	colors := hs.const.MENU_COLORS
	for key, oColor in colors {
		if (equalsIgnoreCase(oColor.name, name)) {
			return oColor.color
		}
	}
}

getMenuColorName(color) {
	colors := hs.const.MENU_COLORS
	for key, oColor in colors {
		if (equalsIgnoreCase(oColor.color, color)) {
			return oColor.name
		}
	}
}

getMonitorForWindow(hWnd:="") {
	hWnd := getHwnd(hWnd, true)
	monIdx := 1
	VarSetCapacity(monInfo, 40)
	NumPut(40, monInfo)
	if (monitorHandle := DllCall("MonitorFromWindow", "uint", hWnd, "uint", 0x2))
		&& DllCall("GetMonitorInfo", "uint", monitorHandle, "uint", &monInfo) {
		monitorLeft := NumGet(monInfo, 4, "Int")
		monitorTop := NumGet(monInfo, 8, "Int")
		monitorRight := NumGet(monInfo, 12, "Int")
		monitorBottom := NumGet(monInfo, 16, "Int")
		workLeft := NumGet(monInfo, 20, "Int")
		workTop := NumGet(monInfo, 24, "Int")
		workRight := NumGet(monInfo, 28, "Int")
		workBottom := NumGet(monInfo, 32, "Int")
		isPrimary := NumGet(monInfo, 36, "Int") & 1
		SysGet, monitorCount, MonitorCount
		Loop, % monitorCount {
			SysGet, curMon, Monitor, %A_Index%
			if (monitorLeft == curMonLeft && monitorTop == curMonTop && monitorRight == curMonRight && monitorBottom == curMonBottom) {
				monIdx := A_Index
				break
			}
		}
	}
	return monIdx
}

getPauseState(value) {
	return (value ? "paused" : "enabled")
}

getPauseTriState(value1, value2) {
	return (value1 ? "paused" : value2 ? "limited" : "enabled")
}

getSelectedText() {
	origIgnore := hs.internal.clipIgnore
	clipIgnore()
	Clipboard := ""
	if (isActiveSsh()) {
		result := ""
		if (clipLoad()) {
			result := Clipboard
		}
		return result
	}
	if (isActiveDos()) {
		if (isWin10()) {
			SendInput, ^{Insert}
		}
		else {
			SendInput, {Enter}
		}
	}
	else if (isActiveNix()) {
		SendInput, ^{Insert}
	}
	else {
		; TODO - the issue with this is that when there is no selection, some apps do not clear the clipboard, so the value is whatever was previously on the clipboard
		SendInput, ^c
	}
	clipSleep()
	ClipWait()
	selText := (ErrorLevel ? "" : Clipboard)
	clipIgnore(origIgnore)
	return selText
}

getSelectedTextOrPrompt(title, label) {
	selText := getSelectedText()
	if (selText == "") {
		hWnd := getHwnd()
		selText := ask(title, label, 500)
		WinActivate, ahk_id %hWnd%
	}
	return selText
}

getSelf(offset:="") {
	offset := -2 - (is(offset, "number") ? abs(offset) : 0)
	e := Exception(".", offset)
	return e.what
}

getSelfHwnd() {
	return WinExist("ahk_pid " . DllCall("GetCurrentProcessId"))
}

getSize(value) {
	size := 0
	if (IsObject(value)) {
		for key, val in value {
			size++
		}
	}
	else {
		size := is(value, "number") ? value : StrLen(value)
	}
	return size
}

getStackTrace() {
	stack := []
	idx := 0
	n := (A_AhkVersion < "2" ? 1 : 2)
	Loop {
		e := Exception(".", offset := -(A_Index + n))
		if (e.What == offset) {
			break
		}
		stack[++idx] := {"file": e.file, "line": e.Line, "caller": e.What, "offset": offset + n}
	}
	return stack
}

getStackTraceStr() {
	frames := getStackTrace()
	history := "`n"
	for k, frame in frames {
		SplitPath(frame.file, file)
		caller := pad(frame.caller == A_ThisFunc ? "Error occurred on..." : "Called by: " . frame.caller . "()", 34) . "`t"
		history .= "`n" . caller . pad(file, 20) . "`tLine: " . frame.line
	}
	return history
}

getUniqueNewName(ByRef path, type:="file") {
	if (!endsWith(path, "\")) {
		path .= "\"
	}
	if (!equalsIgnoreCase(type, "folder")) {
		type := "file"
	}
	name := "New " . type
	result := name
	i := 2
	while (FileExist(path . result)) {
		result := Format("{1} ({2})", name, i)
		i++
	}
	return result
}

getVar(name) {
	keyArray := StrSplit(name, ".")
	varName := keyArray.RemoveAt(1)
	tmp := %varName%
	if (IsObject(tmp)) {
		tmpName := varName
		for idx, key in keyArray {
			if (!ObjHasKey(tmp, key)) {
				message("The object '" . tmpName . "' does not contain the key '" . key . "'.", "Invalid key", 48)
			}
			tmpName .= "." . key
			if (!IsObject(tmp[key])) {
				if (idx != keyArray.Length()) {
					message("The requested object '" . tmpName . "' is a simple value not an object.", "Invalid object name", 48)
				}
			}
			tmp := tmp[key]
		}
	}
	return tmp
}

getVarType(obj) {
	if (IsFunc(obj)) {
		result := (IsObject(obj) ? "Function" : "String")
	}
	else if (IsLabel(obj)) {
		result := "Label"
	}
	else if (IsObject(obj)) {
		result := "Object"
	}
	else {
		if (is(obj, "number")) {
			result := "Number"
		}
		else {
			result := "String"
		}
	}
	return result
}

getWindowInfo(hWnd:="") {
	hWnd := getHwnd(hWnd, true)
	match := "ahk_id " . hWnd
	win := {}
	win.hWnd := hWnd
	win.pid := WinGet("PID", match)
	win.class := WinGetClass(match)
	win.exStyle := WinGet("ExStyle", match)
	win.isHung := DllCall("IsHungAppWindow", "uint", hWnd)
	win.isSuspended := isProcessSuspended(win.pid)
	win.monitor := getMonitorForWindow(hWnd)
	win.processName := WinGet("ProcessName", match)
	win.processPath := WinGet("ProcessPath", match)
	minMax := WinGet("MinMax", match)
	win.state := (minMax == -1 ? "Minimized" : minMax == 1 ? "Maximized" : "Windowed")
	win.style := WinGet("Style", match)
	win.title := WinGetTitle(match)
	WinGetPos, x, y, w, h, % match
	win.height := h
	win.width := w
	win.x := x
	win.y := y
	win.isAppWindow := (win.style & hs.const.WS.EX_APPWINDOW > 0)
	win.isChild := (win.style & hs.const.WS.CHILD > 0)
	win.isControlParent := (win.style & hs.const.WS.EX_CONTROLPARENT > 0)
	win.isDisabled := (win.style & hs.const.WS.DISABLED > 0)
	win.isPopup := (win.style & hs.const.WS.POPUP > 0)
	win.isToolWindow := (win.style & hs.const.WS.EX_TOOLWINDOW > 0)
	win.isVisible := (win.style & hs.const.WS.VISIBLE > 0)
	return win
}

group(name) {
	return ("ahk_group " . name . "Group")
}

guiRows(rows:="") {
	return (rows == -1 ? "" : " r" . rows)
}

hasEol(str) {
	return strCount(str, "\r\n|\n|\r", true)
}

helpPrep(html) {
	nonBreakingHyphen := "&#x2011;"
	jiraDefault := extractJiraStyle(hs.config.user.jiraPanels.format)
	jiraBlue := extractJiraStyle(hs.config.user.jiraPanels.formatBlue)
	jiraGreen := extractJiraStyle(hs.config.user.jiraPanels.formatGreen)
	jiraRed := extractJiraStyle(hs.config.user.jiraPanels.formatRed)
	jiraYellow := extractJiraStyle(hs.config.user.jiraPanels.formatYellow)

	html := RegexReplace(html, "\]-", "]" + nonBreakingHyphen)
	html := RegexReplace(html, "([\[\]])\1", "<span class='keys'>$1</span>")

	html := RegexReplace(html, "i)(?:\[)([aclrsw]+)(?:\])", "<span class='mod'>$1</span>")

	html := RegexReplace(html, "___(.*?)___", "<span class='italic bold'>$1</span>")
	html := RegexReplace(html, "__(.*?)__", "<span class='italic'>$1</span>")

	html := StrReplace(html, "{gt}", "&gt;")
	html := StrReplace(html, "{lt}", "&lt;")

	html := StrReplace(html, "{arrow_down}", "&#x21e9;")
	html := StrReplace(html, "{arrow_left}", "&#x21e6;")
	html := StrReplace(html, "{arrow_right}", "&#x21e8;")
	html := StrReplace(html, "{arrow_up}", "&#x21e7;")

	html := StrReplace(html, "{curly_dquote_open}", "&#x201c;")
	html := StrReplace(html, "{curly_dquote_close}", "&#x201d;")
	html := StrReplace(html, "{curly_squote_open}", "&#x2018;")
	html := StrReplace(html, "{curly_squote_close}", "&#x2019;")

	html := StrReplace(html, "{dtms}", prepText("${A_YYYY}${A_MM}${A_DD}_${A_Hour}${A_Min}${A_Sec}"))
	html := StrReplace(html, "{dts}", prepText("${A_YYYY}${A_MM}${A_DD}"))
	html := StrReplace(html, "{tms}", prepText("${A_Hour}${A_Min}${A_Sec}"))
	html := StrReplace(html, "{date}", prepText("${A_MM}/${A_DD}/${A_YYYY}"))
	html := StrReplace(html, "{day}", prepText("${A_DDDD}"))
	html := StrReplace(html, "{ddd}", prepText("${A_DDD}"))
	html := StrReplace(html, "{mmm}", prepText("${A_MMM}"))
	html := StrReplace(html, "{month}", prepText("${A_MMMM}"))
	html := StrReplace(html, "{now}", prepText("${A_MM}/${A_DD}/${A_YYYY} at ${A_Hour}:${A_Min}:${A_Sec}"))
	html := StrReplace(html, "{time}", prepText("${A_Hour}:${A_Min}:${A_Sec}"))

	html := RegexReplace(html, "({(end(Key|Space))})", "<span class='$2'>&nbsp;</span>")

	html := StrReplace(html, "{ip}", prepText("${A_IPAddress1}"))

	html := RegexReplace(html, "{(jiraDefault)}(.*?){\1}", "<span class='jiraPanel' style='" . jiraDefault . "'>$2</span>")
	html := RegexReplace(html, "{(jiraBlue)}(.*?){\1}", "<span class='jiraPanel' style='" . jiraBlue . "'>$2</span>")
	html := RegexReplace(html, "{(jiraGreen)}(.*?){\1}", "<span class='jiraPanel' style='" . jiraGreen . "'>$2</span>")
	html := RegexReplace(html, "{(jiraRed)}(.*?){\1}", "<span class='jiraPanel' style='" . jiraRed . "'>$2</span>")
	html := RegexReplace(html, "{(jiraYellow)}(.*?){\1}", "<span class='jiraPanel' style='" . jiraYellow . "'>$2</span>")

	html := RegexReplace(html, "{(note)}(.*?){\1}", "<div class='span bold italic $1'>$2</div>")

	html := StrReplace(html, "{pointer}", "&#x2514;&#x2500;&#x25ba;&nbsp;")
	;html := StrReplace(html, "{pointer_extend}", "&#x2502;") ; not used, but keep it for future?

	html := StrReplace(html, "{wheel_down}", "&dArr;")
	html := StrReplace(html, "{wheel_left}", "&lArr;")
	html := StrReplace(html, "{wheel_right}", "&rArr;")
	html := StrReplace(html, "{wheel_up}", "&uArr;")

	nestedRegex := "{\b(base|bold|center|code|explorer|frac|hex|indent|italic|keys|keyText|live|mod|mono|mouse|myVar|panelRow|right|span|symlist|uni|uni uniAlt|wheel)\b}(.*?){\1}"
	while (true) {
		html := RegexReplace(html, nestedRegex, "<span class='$1'>$2</span>")
		if (!RegexMatch(html, nestedRegex)) {
			break
		}
	}
	return html
}

hexToBin(ByRef bytes, hex, num:=0) {
	needed := Ceil(StrLen(hex) / 2)
	if (num < 1 || num > needed) {
		num := needed
	}
	alloc := VarSetCapacity(bytes, num, 1)
	if (alloc < num) {
		ErrorLevel = Mem=%Granted%
		message("hexToBin() allocated [" . alloc . "] memory, but needed [" . num . "]")
		return
	}
	StringLeft, bytes, bytes, num
	addr := &bytes
	Loop, % num {
		StringLeft, ch, hex, 2
		StringTrimLeft, hex, hex, 2
		DllCall("RtlFillMemory", "UInt", addr, "UInt", 1, "UChar", "0x" . ch)
		addr++
	}
}

hideWindow(title:="") {
	hWnd := getHwnd(title)
	; TODO - this should be an array and persist across reloads, but not across reboots
	; may need to capture last reboot date/time, and compare
	hs.internal.hiddenWindows .= (hs.internal.hiddenWindows ? "|" : "") . hWnd
	WinHide, ahk_id %hWnd%
	GroupActivate("AllWindows")
}

horizontalScroll(direction:="left") {
	direction := (equalsIgnoreCase(direction, "right") ? 1 : 0)
	ControlGetFocus, ctrl, A
	Loop, 8 {
		PostMessage, % hs.const.WM.HSCROLL, % direction, 0, % ctrl, A
	}
}

hotKey(hotKeyStr, action, condition:="", params*) {
	if (hotKeyStr != "") {
		if (action == "") {
			hs.hotKeys.actions.Delete(hotKeyStr)
			hs.hotKeys.conditions.Delete(hotKeyStr)
			hs.hotKeys.functions.Delete(hotKeyStr)
			hs.hotKeys.params.Delete(hotKeyStr)
			return
		}
		else if (IsFunc(action)) {
			hs.hotKeys.functions[hotKeyStr] := Func(action)
			if (params.MaxIndex != "") {
				hs.hotKeys.params[hotKeyStr] := params
			}
		}
		else {
			hs.hotKeys.actions[hotKeyStr] := action
		}
		isAhkCondition := false
		if (condition != "") {
			if (IsFunc(condition)) {
				hs.hotKeys.conditions[hotKeyStr] := Func(condition)
				; checking will occur in hotKeyAction()
			}
			else {
				; if condition does not start with "ahk_" then it is treated as the WinTitle
				Hotkey, IfWinActive, % condition
				isAhkCondition := true
			}
		}
;		 else {
;			 isEclipse := true
;			 HotKey, IfWinNotActive, Java - Eclipse
;			 debug("Registering Eclipse filtering for: " . hotKeyStr)
;		 }
		; TODO - rewrite this to use Hotkey, If % funcName
		/*
			; This GUI allows you to register primitive three-key combination hotkeys:
			Gui Add, Text, xm, Prefix key:
			Gui Add, Edit, yp x100 w100 vPrefix, Space
			Gui Add, Text, xm, Suffix hotkey:
			Gui Add, Edit, yp x100 w100 vSuffix, f & j
			Gui Add, Button, Default, Register
			Gui Show
			return

			ButtonRegister() {
				global
				Gui, Submit, NoHide
				local fn
				fn := Func("HotkeyShouldFire").Bind(Prefix)
				Hotkey If,% fn
				Hotkey % Suffix, FireHotkey
			}

			HotkeyShouldFire(prefix, thisHotkey) {
				return GetKeyState(prefix)
			}

			FireHotkey() {
				MsgBox %A_ThisHotkey%
			}

			GuiClose:
			GuiEscape:
			ExitApp
		*/
		Hotkey, % hotKeyStr, hotKeyAction
		if (isAhkCondition) {
			Hotkey, IfWinActive
		}
	}
}

hotKeyAction() {
	static hasWhiteList := ""
	if (hasWhiteList == "") {
		hasWhiteList := IsFunc("isWhiteListHK")
	}
	RegexMatch(A_ThisHotKey, "[~$]*(.*)", match)
	hk := match1
	if (hk == "Escape & h" || hk == "Escape & k" || hk == "Escape & s" || hk == "#F12" || hk == "#h" || hk == "^v" || hk == "+Insert" || hk == "^!v") {
		; always let these through even if hs.internal.hotKeysPaused is true
		;	toggle HotScript
		;	toggle HotKeys
		;	toggle HotStrings
		;	show HotScript menu
		;	show HotScript help screen
		;	paste
		;	preview clipboard
		;debug("hotKeyAction() - allowing selected hotkey: " . hk)
	}
;	else if (hs.internal.hotScriptPaused || hs.internal.hotKeysPaused) {
;		make this call a common passThru() ???
;	}
	else if (hasWhiteList && Func("isWhiteListHK").(hk)) {
		; let it thru
	}
	;else if (contains(hk, "#", "CapsLock", "LButton", "RButton", "Wheel", "^RCtrl")) {
		; actions exempt from blacklist
		;debug("hotKeyAction() - allowing exempted hotkey: " . hk)
	;}
	else if (hs.internal.hotScriptPaused || hs.internal.hotKeysPaused || isActiveBlacklistAll() || isActiveBlacklistHK()) {
;		make this call a common passThru() ???
		static regex1 := "^([!#^{}+])$"
		static regex2 := "i)(appskey|asc \d{1,5}|backspace|browser_\w+|bs|[lmr]button|(?:caps|num|scroll)lock|Click(?:(?:\s+|,)\s*(?:up|down|left|right|\d+)?){0,5}|ctrlbreak|del(?:ete)?|down|end|enter|esc(?:ape)?|f(?:2[0-4]|1[0-9]|[1-9])|home|ins(?:ert)?|launch_\w+|left|media_\w+|numpad(?:[0-9]|[a-z]+)|pause|pg(?:up|dn)|printscreen|right|sleep|space|tab|u\+[\da-f]{4}|up|vk[\da-f]{2}sc[\da-f]{3}|vk[\da-f]{2}|sc[\da-f]{3}|volume_\w+|wheel\w+|xbutton[1-2]|[lr]?(?:alt|control|ctrl|shift|win))"
		tmpKey := A_ThisHotkey
		if (RegexMatch(tmpKey, regex1)) {
			tmpKey := RegexReplace(tmpKey, regex1, "{$1}")
		}
		else if (RegexMatch(tmpKey, regex2)) {
			tmpkey := RegexReplace(tmpKey, regex2, "{$1}")
		}
		SendInput, %tmpKey%
		return
	}
	;debug("hotKeyAction() - hotKey is allowed, checking for: " . hk)
	conditionFunc := hs.hotKeys.conditions[hk]
	if (IsObject(conditionFunc)) {
		result := conditionFunc.Call(hk)
		if (!result) {
			return
		}
	}
	hs.vars.lastHotKey := hk
	addHotKey()
	func := hs.hotKeys.functions[hk]
	action := hs.hotKeys.actions[hk]
	if (IsObject(func)) {
		func.Call(hs.hotKeys.params[hk]*)
	}
	else if (IsLabel(action)) {
		GoSub, % action
	}
	else if (action != "") {
		SendInput, %action%
	}
	else {
		message("Unable to execute hotkey:`n`nhotkey: " . A_ThisHotkey . "`nmatch: " . hk . "`n`nfunction:`t[" . toString(func) . "]`naction:`t[" . toString(action) . "]")
	}
}

/*
	trigger			- string or regex to trigger the action
	replace			- string to replace trigger, OR label to go to, OR function to call, OR object containing function name and optional parameters
	mode			- Normal (case-insensitive), Case (case-sensitive), Regex (regular expression) (default = Normal)
	clearTrigger	- true if the trigger should be erased (default = true)
	condition		- function name that should return true/false if the action should be executed
*/
hotString(trigger, replace, mode:=1, clearTrigger:=true, condition:= "") {
	hsObj := {
		(LTrim Join,
			trigger: trigger
			replace: replace
			mode: mode
			clearTrigger: clearTrigger
			condition: condition
		)}
	hs.hotStrings.Item(trigger) := hsObj
	hotStringDo(hsObj)
}

debugTyped(msg) {
	if (devDebug) {
		debug("(" . msg . ") typed -> [" . hs.internal.typed . "]")
	}
}

hotStringDo(incoming) {
	static modes := {}
	static keysBound := false
	static keys := {
		(LTrim Join,
			alpha: "abcdefghijklmnopqrstuvwxyz"
			breakKeys: "LAlt|RAlt|LButton|RButton|LControl|RControl|Del|Down|End|Enter|Esc|Home|Ins|Left|PgDn|PgUp|Return|Right|Up|LWin|RWin"
			chars: "``~!@#$%^&*()-_=+[]{}\|;:'"",.<>/?0123456789"
			other: "BS,Numpad0,Numpad1,Numpad2,Numpad3,Numpad4,Numpad5,Numpad6,Numpad7,Numpad8,Numpad9,NumpadAdd,NumpadDiv,NumpadDot,NumpadEnter,NumpadMult,NumpadSub,Return,Space,Tab"
		)}
	static effect := {
		(LTrim Join,
			Enter: "`n"
			Return: "`n"
			Space: A_Space
			Tab: A_Tab
			Add: "+"
			Div: "/"
			Dot: "."
			Mult: "*"
			Sub: "-"
		)}
	if (hs.internal.hotScriptPaused || hs.internal.hotStringsPaused || isActiveBlacklistAll() || isActiveBlacklistHS()) {
		return
	}
	if (!keysBound) {
		modes := hs.const.REPLACE_MODE
		callBackHandler := Func("hotStringDo").Bind(modes.Callback)
		hkPrefix := "~$"
		Loop, Parse, % keys.alpha
		{
			Hotkey, %hkPrefix%%A_Loopfield%, % callBackHandler
			Hotkey, %hkPrefix%+%A_Loopfield%, % callBackHandler
		}
		Loop, Parse, % keys.chars
		{
			Hotkey, %hkPrefix%%A_LoopField%, % callBackHandler
		}
		for k, v in ["other", "breakKeys"] {
			keyList := keys[v]
			Loop, Parse, keyList, `,|
			{
				Hotkey, %hkPrefix%%A_LoopField%, % callBackHandler
			}
		}
		keysBound := true
	}
	hotStrings := hs.hotStrings
	if (incoming == modes.Reset) {
		hs.internal.typed := ""
		debugTyped("incoming = reset")
		return
	}
	else if (incoming == modes.Callback) {
		hk := (startsWith(A_ThisHotkey, "~$") ? SubStr(A_ThisHotkey, 3) : A_ThisHotkey)
		if (hk ~= keys.breakKeys) {
			hs.internal.typed := ""
			debugTyped("break key: " . hk)
			return
		}
		else if (hk == "BS" || hk == "Backspace") {
			hs.internal.typed := StringTrimRight(hs.internal.typed, 1)
			debugTyped("backspace")
			return
		}
		if (StrLen(hk) == 2 && Substr(hk, 1, 1) == "+" && Instr(keys.alpha, Substr(hk, 2, 1))) {
			hk := SubStr(hk, 2)
			if (!GetKeyState("CapsLock", "T")) {
				hk := setCase(hk, "U")
			}
		}
		shiftState := GetKeyState("Shift", "P")
		upperCase := GetKeyState("CapsLock", "T") ? !shiftState : shiftState
		; if capslock is down, shift's function is reversed (pressing shift and a key while capslock is on will provide the lowercase key)
		if (upperCase && Instr(keys.alpha, hk)) {
			hk := setCase(hk, "U")
		}
		if (RegExMatch(hk, "Numpad(.+)", numKey)) {
			if (numkey1 ~= "\d") {
				hs.internal.typed .= numkey1
			}
			else {
				hs.internal.typed .= effect[numKey1]
			}
		}
		else if (hk ~= "i)Space|Tab") {
			hs.internal.typed .= effect[hk]
		}
		else {
			hs.internal.typed .= hk
		}
		if (devDebug) {
			debug("typed -> [" . hs.internal.typed . "]")
		}
		matched := false
		for k in hotStrings {
			hsObj := hotStrings.Item(k)
			matchRegex := (hsObj.mode == modes.Normal ? "Oi)" : "") . (hsObj.mode == modes.Regex ? RegExReplace(hsObj.trigger, "\$$", "") : "\Q" . hsObj.trigger . "\E") . "$"
			if (hsObj.mode == modes.Regex) {
				if (matchRegex ~= "^[^\s\)\(\\]+?\)") {
					matchRegex := "O" . matchRegex
				}
				else {
					matchRegex := "O)" . matchRegex
				}
			}
			if (RegExMatch(hs.internal.typed, matchRegex, match)) {
				matched := true
				if (hsObj.mode == modes.Case) {
					returnValue := (match == "" ? match.value(0) : match)
				}
				else {
					returnValue := (match.count > 0 ? match : match.value(0))
				}

				; TODO - this could be determined in hotString() and have the parameters bound to the function
				if (hsObj.condition != "" && IsFunc(hsObj.condition)) {
					conditionalFunc := Func(hsObj.condition)
					if (conditionalFunc.minParams >= 1) {
						; if the function has at least 1 parameters
						conditionalValue := conditionalFunc.Call(returnValue)
					}
					else {
						conditionalValue := conditionalFunc.Call()
					}
					if (!toBool(conditionalValue)) {
						matched := false
						continue
					}
				}
				addHotString()
				StringRight, lastChar, % hs.internal.typed, 1
				hs.vars.hotStringEndChar := lastChar
				hs.vars.lastHotString := hs.internal.typed
				if (hsObj.clearTrigger) {
					if (hsObj.mode == modes.Regex) {
						if (match.count == "" && match.value(0) == "" && match != "") {
							triggerStr := match
						}
						else {
							triggerStr := (match.count > 0 ? match.value(0) : returnValue)
						}
					}
					else {
						triggerStr := returnValue
					}
					StringRight, lastChar, triggerStr, 1
					hs.vars.hotStringEndChar := lastChar
					if (lastChar == A_Tab) {
						if (isActiveDos()) {
							return
						}
						else {
							tmpTrigger := StringTrimRight(triggerStr, 1)
							len := StrLen(tmpTrigger)
							SendInput, +{Left %len%}
							while (!startsWith(getSelectedText(), tmpTrigger)) {
								SendInput, +{Left}
							}
						}
					}
					else {
						SendInput % "{Backspace " . StrLen(triggerStr) . "}"
					}
				}
				if (IsFunc(hsObj.replace)) {
					$ := match
					callbackFunc := Func(hsObj.replace)
					; TODO - add support for sending parameters to the function
					if (callbackFunc.minParams >= 1) {
						funcResult := callbackFunc.(returnValue)
					}
					else {
						funcResult := callbackFunc.()
					}
					if (funcResult != "") {
						pasteText(funcResult)
					}
				}
				else if (IsLabel(hsObj.replace)) {
					$ := returnValue
					GoSub, % hsObj.replace
				}
				else {
					static udlr := "up|down|left|right"
					str := hsObj.replace
					;replace the back-references
					if (match.count() == 0) {
						str := StrReplace(str, "$0", match.value(0))
					}
					Loop, % match.count() {
						str := StrReplace(str, "$" . A_Index, match.value(A_Index))
					}
					if (startsWith(str, "{RAW}", true)) {
						pasteText(SubStr(str, 6))
					}
					else {
						str := prepText(str)
						; TODO - this does not handle ${var.subVar} or ${var[0]}
						RegexMatch(str, "iO)({(?:\w+(?: *\d+|\w+)?|asc \d{1,5}|u\+\d{4}|[!#+^{}]|Click (?:(?:\d+(?:,? ?\d+){0,2})|(?:\d+(?:[, ]*\d+){2}(?:[, ]+(?:" . udlr . ")))|(?:" . udlr . "| )*))})", token)
						if (token.Count() > 0) {
							pos := token.Pos(1) - 1
							if (pos > 0) {
								pasteStr := SubStr(str, 1, pos)
								sendStr := SubStr(str, pos + 1)
								pasteText(pasteStr)
								SendInput, % sendStr
							}
							else {
								SendInput, % str
							}
						}
						else {
							pasteText(str)
						}
					}
				}
				break
			}
		}
		if (matched) {
			hs.internal.typed := ""
			debugTyped("matched")
		}
		else if (StrLen(hs.internal.typed) > 100) {
			hs.internal.typed := StringTrimLeft(hs.internal.typed, 75)
			debugTyped("auto trimmed")
		}
		if (hk ~= "i)Space" && isActiveCommandLine()) {
			; this is to allow hotstrings to be reset in a DOS window by typing a space, which makes sense for DOS but perhaps not other windows
			; it is being done at the bottom to allow a hotstring to end with a space and still be triggered
			hs.internal.typed := ""
			debugTyped("commandline break key: Space")
		}
	}
	else {
		if (hotStrings.Exists(incoming.trigger) && incoming.replace == "") {
			hotStrings.Remove(incoming.trigger)
		}
	}
}

htmlEncode(text) {
	text := StrReplace(text, "&", "&amp;")
	text := StrReplace(text, "<", "&lt;")
	text := StrReplace(text, ">", "&gt;")
	text := StrReplace(text, """", "&quot;")
	return text
}

init() {
	;debug("DBGVIEWCLEAR")
	SetWorkingDir, %A_ScriptDir%

	initInternalVars()
	if (hs.config.user.enableHkClipboard) {
		OnClipboardChange("clipChange", -1)
	}

;	 GroupAdd, BlacklistAllGroup, ahk_exe i)SomeImprobableName_All-Black.exe
;	 GroupAdd, BlacklistHKGroup, ahk_class SunAwtFrame
;	 GroupAdd, BlacklistHSGroup, ahk_exe i)Eclipse.exe

	GroupAdd, BrowserGroup, ahk_exe i)Chrome.exe ahk_class Chrome_WidgetWin_1
	GroupAdd, BrowserGroup, ahk_exe i)Firefox.exe ahk_class MozillaWindowClass

	GroupAdd, DesktopGroup, ahk_class Progman
	GroupAdd, DesktopGroup, ahk_exe i)Explorer.exe ahk_class WorkerW

	; expected to behave like DOS
	GroupAdd, DosGroup, ahk_class ConsoleWindowClass
	GroupAdd, DosGroup, ahk_exe i)cmd.exe

	GroupAdd, EditPadGroup, ahk_exe i)EditPadPro\d*\.exe
;	 GroupAdd, EditPadGroup, ahk_class TEditPadProEditorMain1  ; (main editor window)
;	 GroupAdd, EditPadGroup, ahk_class TJGFileEditorControl1  ; (search panel)
;	 GroupAdd, EditPadGroup, ahk_class TJGFileEditorControl2  ; (replace panel)

	GroupAdd, ExplorerGroup, ahk_class CabinetWClass ahk_exe i)Explorer.exe
	GroupAdd, ExplorerGroup, ahk_class ExploreWClass ahk_exe i)Explorer.exe
	GroupAdd, ExplorerGroup, ahk_class #32770 ahk_exe i)Explorer.exe

	GroupAdd, MSExcelGroup, ahk_exe i)Excel.exe

	GroupAdd, MSWordGroup, ahk_exe i)WinWord.exe

	; expected to behave like PowerShell
	GroupAdd, PowerShellGroup, ahk_exe i)PowerShell.exe

	GroupAdd, RdpGroup, ahk_exe i)mstsc.exe
	GroupAdd, RdpGroup, ahk_class TscShellContainerClass

	; expected to behave like Cygwin & Git Bash
	GroupAdd, ShellGroup, ahk_class mintty

	; expected to behave like SSH clients
	GroupAdd, SshGroup, ahk_exe i)Kitty.exe
	GroupAdd, SshGroup, ahk_exe i)Putty.exe

	; Windows Subsystem for Linux aka WSL
	GroupAdd, UbuntuGroup, ahk_exe i)bash.exe

	; composite groups
	; ----------------------------------------------

	; uses Shift-Insert instead of Ctrl-V to paste
	GroupAdd, AltPasteGroup, ahk_group ShellGroup
	GroupAdd, AltPasteGroup, ahk_group SshGroup

	; uses a special API for pasting
	GroupAdd, ApiPasteGroup, ahk_group DosGroup
	GroupAdd, ApiPasteGroup, ahk_group UbuntuGroup

	; uses the Command Line HotKeys and HotStrings
	GroupAdd, CommandLineGroup, ahk_group DosGroup
	GroupAdd, CommandLineGroup, ahk_group PowerShell
	GroupAdd, CommandLineGroup, ahk_group ShellGroup
	GroupAdd, CommandLineGroup, ahk_group SshGroup
	GroupAdd, CommandLineGroup, ahk_group UbuntuGroup

	; can run DOS and Windows *.exe files
	GroupAdd, DosLikeGroup, ahk_group DosGroup
	GroupAdd, DosLikeGroup, ahk_group PowerShellGroup
	GroupAdd, CommandLineGroup, ahk_group ShellGroup

	; expected to behave like a Unix-style shell
	GroupAdd, NixGroup, ahk_group ShellGroup
	GroupAdd, NixGroup, ahk_group SshGroup
	GroupAdd, NixGroup, ahk_group UbuntuGroup

	refreshMonitors()
	SetTimer("refreshMonitors", 30000)
	createUserFiles()
	loadConfig()
	createStartupLink()
	updateRegistry()
	addMissingVariables()
	icon := hs.file.ICON
	tip := hs.TITLE . " v" . hs.VERSION . " (AHK v" . A_AhkVersion . ") - enabled"
	Menu, Tray, Icon, %icon%,, 1
	Menu, Tray, Tip, % tip
	Menu, Tray, NoStandard
	hkHotScriptMenu("Tray")
	initHotStrings()
	checkVersions()
	if (FileExist(hs.config.user.editor) == "") {
		if (findOnPath(hs.config.user.editor) = "") {
			msg := "The configured editor cannot be found: " . hs.config.user.editor . "`n`nTo change this, edit the " . hs.config.user.file . " file and add the 'editor' value in the [config] section."
			message(msg,, 48)
		}
	}
	if (FileExist(hs.file.UPDATE) != "") {
		hsUpdate := FileRead(hs.file.UPDATE)
		versionRegex := "(\d\.\d{8}\.\d+)"
		RegExMatch(hsUpdate, "last: " . versionRegex, lastVer)
		RegExMatch(hsUpdate, "new: " . versionRegex, newVer)
		msg := "
			(LTrim
				A new version of " . hs.TITLE . " has been installed.

				" . A_Tab . "Previous`t: " . lastVer1 . "
				" . A_Tab . "Current`t: " . newVer1 . "

				Would you like to see the list changes?
			)"
		if (message(msg, hs.TITLE . ": New version installed", 36, 30) == "Yes") {
			Run(hs.vars.url[hs.TITLE].history)
		}
		FileDelete(hs.file.UPDATE)
	}
	if (FileExist(hs.internal.clipPath) == "") {
		FileCreateDir, % hs.internal.clipPath
	}
	else {
		stackFiles := ""
		first := true
		Loop, Files, % hs.internal.clipPath . "multiClip*.clip"
		{
			stackFiles .= (first ? "" : hs.const.EOL_WIN) . A_LoopFileLongPath
			first := false
		}
		if (stackFiles != "") {
			Sort(stackFiles, "F compareStrAscNoCase")
			Loop, Parse, stackFiles, `n, `r
			{
				hs.internal.multiClip.Push(A_LoopField)
				RegexMatch(A_LoopField, "(\d+)", num)
				hs.internal.stackNum := num
			}
		}
	}
}

initHotStrings() {
	mode := hs.const.REPLACE_MODE
	if (toBool(hs.config.user.enableHsAlias)) {
		hotString(regexStartBoundary("bbl"), "be back later", mode.Regex)
		hotString(regexStartBoundary("bbs"), "be back soon", mode.Regex)
		hotString(regexStartBoundary("bi(\d+)") . regexEndBoundary(), "hsAliasBackInX", mode.Regex)
		hotString(regexStartBoundary("brb"), "be right back", mode.Regex)
		hotString(regexStartBoundary("brt"), "be right there", mode.Regex)
		hotString(regexStartBoundary("g2g"), "Good to go!", mode.Regex)
		hotString(regexStartBoundary("gtg"), "Got to go...", mode.Regex)
		hotString(regexStartBoundary("idk"), "I don't know.", mode.Regex)
		hotString(regexStartBoundary("lmc"), "Let me check on that...", mode.Regex)
		hotString(regexStartBoundary("lmk"), "Let me know ", mode.Regex)
		hotString(regexStartBoundary("nm") . regexEndBoundary(), "never mind...", mode.Regex)
		hotString(regexStartBoundary("nmif"), "Never mind, I found it.", mode.Regex)
		hotString(regexStartBoundary("np") . regexEndBoundary(), "no problem$1", mode.Regex)
		hotString(regexStartBoundary("nw"), "no worries", mode.Regex)
		hotString(regexStartBoundary("okt"), "OK, thanks...", mode.Regex)
		hotString(regexStartBoundary("thok"), "That's OK...", mode.Regex)
		hotString(regexStartBoundary("thx"), "thanks", mode.Regex)
		hotString(regexStartBoundary("ty") . regexEndBoundary(), "Thank you$1", mode.Regex)
		hotString(regexStartBoundary("vg") . regexEndBoundary(), "very good$1", mode.Regex)
		hotString(regexStartBoundary("yw") . regexEndBoundary(), "You're welcome$1", mode.Regex)
		hotString(regexStartBoundary("wyb"), "Please let me know when you are back...", mode.Regex)
	}
	if (toBool(hs.config.user.enableHsAutoCorrect)) {
		hotString("(\d+)\/(\d+)%", "hsDivPercent", mode.Regex)
		hotString("(\d+)%(\d+)" . regexEndBoundary(), "hsPercentOf", mode.Regex)
		hotString(regexStartBoundary("([a-z])L"), "$1:", mode.Regex)
		hotString(regexStartBoundary("rc(.)(\d{1,7})") . regexEndBoundary(), "hsRepeatString", mode.Regex)
		hotString(regexStartBoundary("rs(.*)~(\d{1,7})") . regexEndBoundary(), "hsRepeatString", mode.Regex)
		hotString("@(\d+)\/(\d+)" . regexEndBoundary(), "hsFraction", mode.Regex)
		hotString("@ip", A_IPAddress1, mode.Case)
		hotString("@shrug", hs.internal.SHRUG)

		hotString("@+-", Chr(177))
		hotString("@bullet", Chr(0x2022), mode.Case)
		hotString("@cent", Chr(0x00A2), mode.Case)
		hotString("@check", Chr(0x2713), mode.Case)
		hotString("@club", Chr(0x2663), mode.Case)
		hotString("@copy", Chr(0x00A9), mode.Case)
		hotString("@diam", Chr(0x2666), mode.Case)
		hotString("@div", Chr(0x00f7), mode.Case)
		hotString("@ellip", Chr(0x2026), mode.Case)
		hotString("@euro", Chr(0x20AC), mode.Case)
		hotString("@gte", Chr(0x2265), mode.Case)
		hotString("@heart", Chr(0x2665), mode.Case)
		hotString("@inf", Chr(0x221e), mode.Case)
		hotString("@lte", Chr(0x2264), mode.Case)
		hotString("@mdash", Chr(0x2014), mode.Case)
		hotString("@mult", Chr(0x00d7), mode.Case)
		hotString("@ndash", Chr(0x2013), mode.Case)
		hotString("@neq", Chr(0x2260), mode.Case)
		hotString("@pound", Chr(0x00A3), mode.Case)
		hotString("@reg", Chr(0x00AE), mode.Case)
		hotString("@spade", Chr(0x2660), mode.Case)
		hotString("@tm", Chr(0x2122), mode.Case)
		hotString("@yen", Chr(0x00A5), mode.Case)
		hotString("i)@uni([\dA-F]{4})", "hsUnicode", mode.Regex)

		hotString("@darr", Chr(0x2193), mode.Case)
		hotString("@dArr", Chr(0x21D3), mode.Case)
		hotString("@odarr", Chr(0x21E9), mode.Case)
		hotString("@harr", Chr(0x2194), mode.Case)
		hotString("@hArr", Chr(0x21D4), mode.Case)
		hotString("@larr", Chr(0x2190), mode.Case)
		hotString("@lArr", Chr(0x21D0), mode.Case)
		hotString("@olarr", Chr(0x21E6), mode.Case)
		hotString("@nearr", Chr(0x2197), mode.Case)
		hotString("@neArr", Chr(0x21D7), mode.Case)
		hotString("@nwarr", Chr(0x2196), mode.Case)
		hotString("@nwArr", Chr(0x21D6), mode.Case)
		hotString("@rarr", Chr(0x2192), mode.Case)
		hotString("@rArr", Chr(0x21D2), mode.Case)
		hotString("@orarr", Chr(0x21E8), mode.Case)
		hotString("@searr", Chr(0x2198), mode.Case)
		hotString("@seArr", Chr(0x21D8), mode.Case)
		hotString("@swarr", Chr(0x2199), mode.Case)
		hotString("@swArr", Chr(0x21D9), mode.Case)
		hotString("@uarr", Chr(0x2191), mode.Case)
		hotString("@uArr", Chr(0x21D1), mode.Case)
		hotString("@ouarr", Chr(0x21E7), mode.Case)
		hotString("@varr", Chr(0x2195), mode.Case)
		hotString("@vArr", Chr(0x21D5), mode.Case)
	}
	if (toBool(hs.config.user.enableHsCode)) {
		hotString("@html", "templateHtml", mode.Case)
		hotString("@java", "templateJava", mode.Case)
		hotString("@perl", "templatePerl", mode.Case)
		hotString("@sql", "templateSql", mode.Case)
		hotString("${", "hsCodeToken",, false)
		hotString(regexStartBoundary("chp"), "hsCommentHeaderPerl", mode.Regex)
		hotString(regexStartBoundary("chs"), "hsCommentHeaderSql", mode.Regex)
		hotString(regexStartBoundary("(for|if|while) ?\("), "hsCodeBlock", mode.Regex, false)
		hotString(regexStartBoundary("elif"), "hsCodeElseIf", mode.Regex)
		hotString(regexStartBoundary("func ?\("), "hsCodeFunction", mode.Regex)
		hotString(regexStartBoundary("ifel"), "hsCodeIfElse", mode.Regex)
		hotString(regexStartBoundary("sf\."), "hsCodeStringFormat", mode.Regex)
		hotString(regexStartBoundary("switch ?\("), "hsCodeSwitch", mode.Regex, false)
		hotString("sysout", "hsCodeSysOut", mode.Case)
	}
	if (toBool(hs.config.user.enableHsDates)) {
		hotString(regexStartBoundary("dtms"), "${A_YYYY}${A_MM}${A_DD}_${A_Hour}${A_Min}${A_Sec}", mode.Regex)
		hotString(regexStartBoundary("dts"), "${A_YYYY}${A_MM}${A_DD}", mode.Regex)
		hotString(regexStartBoundary("tms"), "${A_Hour}${A_Min}${A_Sec}", mode.Regex)
		hotString("@date", "${A_MM}/${A_DD}/${A_YYYY}", mode.Case)
		hotString("@day", "${A_DDDD}", mode.Case)
		hotString("@ddd", "${A_DDD}", mode.Case)
		hotString("@mmm", "${A_MMM}", mode.Case)
		hotString("@month", "${A_MMMM}", mode.Case)
		hotString("@now", "${A_MM}/${A_DD}/${A_YYYY} at ${A_Hour}:${A_Min}:${A_Sec}", mode.Case)
		hotString("@time", "${A_Hour}:${A_Min}:${A_Sec}", mode.Case)
	}
	if (toBool(hs.config.user.enableHsDos)) {
		hotString(regexStartBoundary("cd "), "hsCommandLineCd", mode.Regex, false, "isActiveDos")
		hotString(regexStartBoundary("rd "), "hsCommandLineRd", mode.Regex, false, "isActiveDos")
	}
	if (toBool(hs.config.user.enableHsJira)) {
		; code
		hotString("{code", "hsJiraCode", mode.Case)
		hotString("{java", "hsJiraCode", mode.Case)
		hotString("{js", "hsJiraCode", mode.Case)
		hotString("{py", "hsJiraCode", mode.Case)
		hotString("{sql", "hsJiraCode", mode.Case)
		hotString("{xml", "hsJiraCode", mode.Case)
		; color
		hotString("{color", "hsJiraColor", mode.Case, false)
		; noformat
		hotString("{nof", "hsJiraNoFormat", mode.Case, false)
		; panel
		hotString("{bpan", "hsJiraPanel", mode.Case)
		hotString("{gpan", "hsJiraPanel", mode.Case)
		hotString("{pan", "hsJiraPanel", mode.Case)
		hotString("{rpan", "hsJiraPanel", mode.Case)
		hotString("{ypan", "hsJiraPanel", mode.Case)
		; quote
		hotString("{quo", "hsJiraQuote", mode.Case, false)
		; special panel
		hotString("{info", "hsJiraSpecialPanel", mode.Case, false)
		hotString("{note", "hsJiraSpecialPanel", mode.Case, false)
		hotString("{tip", "hsJiraSpecialPanel", mode.Case, false)
		hotString("{warn", "hsJiraSpecialPanel", mode.Case, false)
		; table
		hotString("{table", "hsJiraTable", mode.Case)
	}
	if (toBool(hs.config.user.enableHsVariables)) {
		if (MY_EMAIL != "") {
			hotString("@@", MY_EMAIL)
		}
		if (MY_PHONE != "") {
			hotString("@#", MY_PHONE)
		}
		if (MY_HOME_ADDRESS != "") {
			hotString("@home", MY_HOME_ADDRESS, mode.Case)
		}
		if (MY_DOB != "") {
			hotString("@dob", MY_DOB, mode.Case)
		}
		if (MY_NAME != "") {
			hotString("@me", MY_NAME, mode.Case)
		}
		if (MY_PASSWORD != "") {
			hotString("@pw", crypt(MY_PASSWORD), mode.Case)
		}
		if (MY_SIGNATURE != "") {
			hotString("@sig", MY_SIGNATURE, mode.Case)
		}
		if (MY_WORK_ADDRESS != "") {
			hotString("@work", MY_WORK_ADDRESS, mode.Case)
		}
		if (MY_WORK_EMAIL != "") {
			hotString("@W@", MY_WORK_EMAIL, mode.Case)
		}
		if (MY_WORK_PHONE != "") {
			hotString("@W#", MY_WORK_PHONE, mode.Case)
		}
	}
}

initInternalVars() {
	hs := {
		(LTrim Comments Join,
			TITLE: "HotScript"
			VERSION: "1.20190417.1"
		)}
	hs.BASENAME := A_ScriptDir . "\" . hs.TITLE

	emObj := {
		(LTrim Comments Join,
			HIDEBALLOONTIP: 0x1504
			SETCUEBANNER: 0x1501
			SHOWBALLOONTIP: 0x1503
		)}

	wmObj := {
		(LTrim Comments Join,
			COMMAND: 0x0111
			HSCROLL: 0x0114
			VSCROLL: 0x0115
		)}

	wsObj := {
		(LTrim Comments Join,
			CHILD: 0x40000000
			DISABLED: 0x08000000
			EX_APPWINDOW: 0x00040000
			EX_CONTROLPARENT: 0x00010000
			EX_TOOLWINDOW: 0x00000080
			POPUP: 0x80000000
			VISIBLE: 0x10000000
		)}

	htmlColors := {
		(LTrim Comments Join,
			AliceBlue: 0xF0F8FF
			AntiqueWhite: 0xFAEBD7
			Aqua: 0x00FFFF
			Aquamarine: 0x7FFFD4
			Azure: 0xF0FFFF
			Beige: 0xF5F5DC
			Bisque: 0xFFE4C4
			Black: 0x000000
			BlanchedAlmond: 0xFFEBCD
			Blue: 0x0000FF
			BlueViolet: 0x8A2BE2
			Brown: 0xA52A2A
			BurlyWood: 0xDEB887
			CadetBlue: 0x5F9EA0
			Chartreuse: 0x7FFF00
			Chocolate: 0xD2691E
			Coral: 0xFF7F50
			CornflowerBlue: 0x6495ED
			Cornsilk: 0xFFF8DC
			Crimson: 0xDC143C
			Cyan: 0x00FFFF
			DarkBlue: 0x00008B
			DarkCyan: 0x008B8B
			DarkGoldenRod: 0xB8860B
			DarkGray: 0xA9A9A9
			DarkGrey: 0xA9A9A9
			DarkGreen: 0x006400
			DarkKhaki: 0xBDB76B
			DarkMagenta: 0x8B008B
			DarkOliveGreen: 0x556B2F
			DarkOrange: 0xFF8C00
			DarkOrchid: 0x9932CC
			DarkRed: 0x8B0000
			DarkSalmon: 0xE9967A
			DarkSeaGreen: 0x8FBC8F
			DarkSlateBlue: 0x483D8B
			DarkSlateGray: 0x2F4F4F
			DarkSlateGrey: 0x2F4F4F
			DarkTurquoise: 0x00CED1
			DarkViolet: 0x9400D3
			DeepPink: 0xFF1493
			DeepSkyBlue: 0x00BFFF
			DimGray: 0x696969
			DimGrey: 0x696969
			DodgerBlue: 0x1E90FF
			FireBrick: 0xB22222
			FloralWhite: 0xFFFAF0
			ForestGreen: 0x228B22
			Fuchsia: 0xFF00FF
			Gainsboro: 0xDCDCDC
			GhostWhite: 0xF8F8FF
			Gold: 0xFFD700
			GoldenRod: 0xDAA520
			Gray: 0x808080
			Grey: 0x808080
			Green: 0x008000
			GreenYellow: 0xADFF2F
			HoneyDew: 0xF0FFF0
			HotPink: 0xFF69B4
			IndianRed : 0xCD5C5C
			Indigo : 0x4B0082
			Ivory: 0xFFFFF0
			Khaki: 0xF0E68C
			Lavender: 0xE6E6FA
			LavenderBlush: 0xFFF0F5
			LawnGreen: 0x7CFC00
			LemonChiffon: 0xFFFACD
			LightBlue: 0xADD8E6
			LightCoral: 0xF08080
			LightCyan: 0xE0FFFF
			LightGoldenRodYellow: 0xFAFAD2
			LightGray: 0xD3D3D3
			LightGrey: 0xD3D3D3
			LightGreen: 0x90EE90
			LightPink: 0xFFB6C1
			LightSalmon: 0xFFA07A
			LightSeaGreen: 0x20B2AA
			LightSkyBlue: 0x87CEFA
			LightSlateGray: 0x778899
			LightSlateGrey: 0x778899
			LightSteelBlue: 0xB0C4DE
			LightYellow: 0xFFFFE0
			Lime: 0x00FF00
			LimeGreen: 0x32CD32
			Linen: 0xFAF0E6
		)}
	htmlColors2 := {
		(LTrim Comments Join,
			Magenta: 0xFF00FF
			Maroon: 0x800000
			MediumAquaMarine: 0x66CDAA
			MediumBlue: 0x0000CD
			MediumOrchid: 0xBA55D3
			MediumPurple: 0x9370DB
			MediumSeaGreen: 0x3CB371
			MediumSlateBlue: 0x7B68EE
			MediumSpringGreen: 0x00FA9A
			MediumTurquoise: 0x48D1CC
			MediumVioletRed: 0xC71585
			MidnightBlue: 0x191970
			MintCream: 0xF5FFFA
			MistyRose: 0xFFE4E1
			Moccasin: 0xFFE4B5
			NavajoWhite: 0xFFDEAD
			Navy: 0x000080
			OldLace: 0xFDF5E6
			Olive: 0x808000
			OliveDrab: 0x6B8E23
			Orange: 0xFFA500
			OrangeRed: 0xFF4500
			Orchid: 0xDA70D6
			PaleGoldenRod: 0xEEE8AA
			PaleGreen: 0x98FB98
			PaleTurquoise: 0xAFEEEE
			PaleVioletRed: 0xDB7093
			PapayaWhip: 0xFFEFD5
			PeachPuff: 0xFFDAB9
			Peru: 0xCD853F
			Pink: 0xFFC0CB
			Plum: 0xDDA0DD
			PowderBlue: 0xB0E0E6
			Purple: 0x800080
			RebeccaPurple: 0x663399
			Red: 0xFF0000
			RosyBrown: 0xBC8F8F
			RoyalBlue: 0x4169E1
			SaddleBrown: 0x8B4513
			Salmon: 0xFA8072
			SandyBrown: 0xF4A460
			SeaGreen: 0x2E8B57
			SeaShell: 0xFFF5EE
			Sienna: 0xA0522D
			Silver: 0xC0C0C0
			SkyBlue: 0x87CEEB
			SlateBlue: 0x6A5ACD
			SlateGray: 0x708090
			SlateGrey: 0x708090
			Snow: 0xFFFAFA
			SpringGreen: 0x00FF7F
			SteelBlue: 0x4682B4
			Tan: 0xD2B48C
			Teal: 0x008080
			Thistle: 0xD8BFD8
			Tomato: 0xFF6347
			Turquoise: 0x40E0D0
			Violet: 0xEE82EE
			Wheat: 0xF5DEB3
			White: 0xFFFFFF
			WhiteSmoke: 0xF5F5F5
			Yellow: 0xFFFF00
			YellowGreen: 0x9ACD32
		)}
	; const
	hs.const := {
		(LTrim Comments Join,
			COMMENT_HEADER_LINE: repeatStr("-", 70)
			END_CHARS_REGEX: "([``~!@#$%^&*\(\)\-_=+[\]{}\\|;:'"",.<>/?\s])"
			EOL_MAC: "`r"
			EOL_NIX: "`n"
			EOL_WIN: "`r`n"
			HTML_COLORS: merge(htmlColors, htmlColors2)
			INDENT: "    "
			MENU_COLORS: [{color: "FFFEE3", name: "yellow"}
				{color: "D7DEEF", name: "blue"}
				{color: "FFE2E3", name: "red"}
				{color: "D9F4DC", name: "green"}
				{color: "E4D6EF", name: "purple"}
				{color: "D2EAEC", name: "cyan"}
				{color: "FFE3D1", name: "orange"}]
			VIRTUAL_SPACE: Chr(160)
			EM: emObj
			WM: wmObj
			WS: wsObj
		)}

	hs.const.MARKER := {
		(LTrim Comments Join,
			always_on_top: Chr(0x16C2) . hs.const.VIRTUAL_SPACE
			click_through: Chr(0x16BE) . hs.const.VIRTUAL_SPACE
			pinned: Chr(0x1368) . hs.const.VIRTUAL_SPACE  ; reserved for future use
			transparent: Chr(0x2261) . hs.const.VIRTUAL_SPACE
		)}

	; mode
	hs.const.REPLACE_MODE := {
		(LTrim Comments Join,
			Normal: 1
			Case: 2
			Regex: 3
			Callback: "!CALLBACK!"  ; not to be used directly, for internal use only
			Reset: "!RESET!"  ; not to be used directly, for internal use only
		)}

	; file
	hs.file := {
		(LTrim Comments Join,
			CONFIG_DEFAULT: hs.BASENAME . "Default.ini"
			CONFIG_USER: hs.BASENAME . "User.ini"
			ICON: hs.BASENAME . ".ico"
			UPDATE: hs.BASENAME . "Update.txt"
			USER_FUNCTIONS: hs.BASENAME . "Functions.ahk"
			CUSTOM_HELP: hs.BASENAME . "CustomHelp.html"
			USER_INCLUDES: hs.BASENAME . "Includes.ahk"
			USER_KEYS: hs.BASENAME . "Keys.ahk"
			USER_STRINGS: hs.BASENAME . "Strings.ahk"
			USER_VARIABLES: hs.BASENAME . "Variables.ahk"
		)}
	; help
	hs.help := {
		(LTrim Comments Join,
			width: 1340
			height: 740
			title: hs.TITLE . " - Quick Help"
		)}
	; HotKeys
	hs.hotKeys := {}
	hs.hotKeys.actions := {}
	hs.hotKeys.conditions := {}
	hs.hotKeys.functions := {}
	hs.hotKeys.params := {}
	; HotStrings
	hs.hotStrings := ComObjCreate("Scripting.Dictionary")
	; vars
	ahkHome := "https://autohotkey.com/"
	urls := {}
	urls.ahk := {
		(LTrim Comments Join,
			download: ahkHome . "download/1.1/"
			install: ahkHome . "download/ahk-install.exe"
		)}
	urls.ahk.version := urls.ahk.download . "version.txt"
	urls[hs.TITLE] := {
		(LTrim Comments Join,
			home: "https://github.com/mviens/" . hs.TITLE
		)}
	homeRaw := urls[hs.TITLE].home . "/raw/master/"
	urls[hs.TITLE].download := homeRaw . hs.TITLE . ".ahk"
	urls[hs.TITLE].forum := "https://hotscript.prophpbb.com/"
	urls[hs.TITLE].history := urls[hs.TITLE].home . "/blob/master/changes.md"
	urls[hs.TITLE].userManual := urls[hs.TITLE].home . "/blob/master/UserManual.md"
	urls[hs.TITLE].version := homeRaw . "version.txt"
	myVars := {
		(LTrim Comments Join,
			DOB: "01/01/1980"
			EMAIL: "firstlast@mail.com"
			HOME_ADDRESS: "123 Main Street"
			NAME: "First Last"
			PASSWORD: Chr(209) . Chr(193) . Chr(165) . Chr(165) . Chr(246) . Chr(177) . Chr(243) . Chr(229) . Chr(190)
			PHONE: "789-456-0123"
			SIGNATURE: """Sincerely,``n"" . MY_NAME"
			WORK_ADDRESS: "789 Working Way"
			WORK_EMAIL: "firstlast@work.com"
			WORK_PHONE: "123-456-7890"
		)}
	hs.vars := {
		(LTrim Comments Join,
			hotStringEndChar: ""
			lastHotKey: ""
			lastHotString: ""
			monitors: {}
			uniqueId: "_" . A_Year . "_" . A_ComputerName
			url: urls
		)}
	; config
	hs.config := {
		(LTrim Comments Join,
			default: new Config(hs.TITLE)
			user: new Config()
		)}
	hs.config.default.file := hs.file.CONFIG_DEFAULT
	hs.config.user.file := hs.file.CONFIG_USER
	; internal
	clipPath := hs.BASENAME . "-clips\"
	hs.internal := {
		(LTrim Comments Join,
			clipboard: clipPath . "clipboard.clip"
			clipIgnore: false
			clipPath: clipPath
			clipSleep: 30
			customResHeight: ""
			customResWidth: ""
			defaultMyVars: myVars
			hiddenWindows: ""  ; TODO - this should persist, because if windows were hidden and the script was reloaded, they would be lost
			hotKeysPaused: false
			hotScriptPaused: false
			hotStringsPaused: false
			isMultiClip: false
			isNumClip: false
			multiClip: []
			multiClipQueue: true
			numClip: 1
			numClips: {}
			SHRUG: Chr(0xAF) . "\_(" . Chr(0x30C4) . ")_/" . Chr(0xAF)
			stackNum: 0
			typed: ""
		)}
	Loop, 10 {
		hs.internal.numClips[A_Index] := clipPath . "numClip" . A_Index . ".clip"
	}
}

is(value, type) {
	result := false
	if value is %type%
	{
		result := true
	}
;	 debug("is() - value: [" . value . "], type: " . type . ", result: " . (result == 0 ? "false" : "true"))
	return result
}

isActive(title) {
	dhw := A_DetectHiddenWindows
	DetectHiddenWindows, Off
	result := WinActive(title)
	DetectHiddenWindows, %dhw%
	return result
}

isActiveAltPaste() {
	return isActive(group("AltPaste"))
}

isActiveApiPaste() {
	return (isActiveDos() && !isWin10()) || isActiveUbuntu()
}

isActiveBrowser() {
	return isActive(group("Browser"))
}

isActiveCalculator() {
	procName := getActiveProcessName()
	return (equalsIgnoreCase(procName, "calc.exe") || equalsIgnoreCase(procName, "calculator.exe"))
}

isActiveCommandLine() {
	return isActive(group("CommandLine"))
}

isActiveDesktop() {
	return isActive(group("Desktop"))
}

isActiveDialog() {
	return isActive("ahk_class #32770")
}

isActiveDos() {
	return isActive(group("Dos")) && !isActivePowerShell() && !isActiveUbuntu()
}

isActiveDosLike() {
	return !isActiveUbuntu() && (isActiveDos() || isActivePowerShell() || isActiveShell())
}

isActiveBlacklistAll() {
	return isActive(group("BlacklistAll"))
}

isActiveBlacklistHK() {
	return isActive(group("BlacklistHK"))
}

isActiveBlacklistHS() {
	return isActive(group("BlacklistHS"))
}

isActiveEditPad() {
	return isActive(group("EditPad"))
}

isActiveExplorer() {
	return isActive(group("Explorer"))
}

isActiveMSExcel() {
	return isActive(group("MSExcel"))
}

isActiveMSWord() {
	return isActive(group("MSWord"))
}

isActiveNix() {
	return isActive(group("Nix"))
}

isActivePowerShell() {
	return isActive(group("PowerShell"))
}

isActiveRdp() {
	return isActive(group("Rdp"))
}

isActiveShell() {
	return isActive(group("Shell"))
}

isActiveSsh() {
	return isActive(group("Ssh"))
}

isActiveUbuntu() {
	return isActive(group("Ubuntu"))
}

isArray(obj) {
	result := false
	if (IsObject(obj) && !isDictionary(obj)) {
		; TODO - this fails to correctly determine an empty array, but until AHK v2.0, this seems to be the best solution
		result := (obj.SetCapacity(0) == (obj.MaxIndex() - obj.MinIndex() + 1))
	}
	return result
}

isDictionary(obj) {
	result := false
	if (IsObject(obj)) {
		try {
			class := ComObjType(obj, "Class")
			result := (class == "Dictionary")
		}
		catch e {
			debug("Error while testing object for dictionary: " . toString(e))
		}
	}
	return result
}

isNotActiveCalculator() {
	; this is negated because hotString()'s "condition" parameter can only run a function, not negate it
	return !isActiveCalculator()
}

isDirectory(text) {
	return (InStr(FileExist(text), "D") > 0)
}

isEmpty(value) {
	result := false
	if (isObject(value)) {
		result := !value._NewEnum()[k, v]
	}
	else if (value == "") {
		result := true
	}
	return result
}

isFile(text) {
	return ((FileExist(text) != "") && !isDirectory(text))
}

isProcessSuspended(pid) {
	for thread in ComObjGet("winmgmts:").ExecQuery("SELECT ThreadWaitReason from Win32_Thread WHERE ProcessHandle = " . pid) {
		return (thread.ThreadWaitReason == 5 || thread.ThreadWaitReason == 12)
	}
}

isRunningDos() {
	return isActive(group("Dos")) && !isActivePowerShell() && !isActiveUbuntu()
}

isSelf() {
	win := getWindowInfo()
	return (win.title == hs.TITLE . ".ahk")
}

isSortASCII() {
	return (hs.config.user.sortType == "ASCII")
}

isSortNatural() {
	return (hs.config.user.sortType == "Natural")
}

isSortRandom() {
	return (hs.config.user.sortType == "Random")
}

isUNC(text) {
	return RegexMatch(text, "\\\\[\\~`!@#$%^&\(\)\-_=+\[\]\{\};',.\d\w ]+")
}

isUrl(text) {
	; this does not support mailto urls
	pos := RegexMatch(text, "i)^(?:\b[a-z\d.-]+://[^<>\s]+|\b(?:(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'"",.<>/?]+)\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)|(?:(?:[0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}(?:[0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5]))(?:[;/][^#?<>\s]*)?(?:\?[^#<>\s]*)?(?:#[^<>\s]*)?(?!\w))$", matchStr)
	return (pos == 1)
}

isWin10() {
	return startsWith(A_OSVersion, "10")
}

isWindowVisible(hWnd:="") {
	return DllCall("IsWindowVisible", UInt, getHwnd(hWnd))
}

isWord(str) {
	return (RegexMatch(str, "^\w+$") > 0)
}

lineUnwrapSelected() {
	selText := getSelectedText()
	selText := StrReplace(selText, A_Space . hs.const.EOL_WIN, A_Space)
	pasteText(selText)
}

lineWrapSelected() {
	selText := getSelectedText()
	static width := 80
	tmpWidth := ask("Wrap Text", "Max characters per line:",,, width)
	if (ErrorLevel) {
		return
	}
	width := tmpWidth
	tmpWidth := "(?=.{" . width + 1 . ",})(.{1," . width - 1 . "}[^ ]) +"
	regexReplaceStr := "$1 " . getEol(selText)
	selText := RegExReplace(selText, tmpWidth, regexReplaceStr)
	pasteText(selText)
}

listToArray(list, delim:="", doTrim:=false) {
	delim := (delim == "" ? hs.const.EOL_WIN : delim)
	arr := {}
	Loop, Parse, list, %delim%
	{
		item := (toBool(doTrim) ? Trim(A_LoopField) : A_LoopField)
		arr[A_Index] := item
	}
	return arr
}

loadConfig() {
	file := hs.config.default.file
	saveDefault := false
	if (FileExist(hs.config.default.file) == "") {
		saveDefault := true
		hs.config.default.version := hs.VERSION
	}
	else {
		; check version in default
		hs.config.default.version := IniRead(hs.config.default.file, "config", "version")
		if (hs.config.default.version != hs.VERSION) {
			; different version so need to delete it
			FileDelete(file)
			saveDefault := true
			hs.config.default.version := hs.VERSION
		}
	}
	; load from default config first
	hs.config.default.defaultHelpTab := IniRead(hs.config.default.file, "config", "defaultHelpTab", hs.config.default.defaultHelpTab)
	hs.config.default.lastHelpTab := IniRead(hs.config.default.file, "config", "lastHelpTab", hs.config.default.lastHelpTab)
	hs.config.default.editor := IniRead(hs.config.default.file, "config", "editor", hs.config.default.editor)
	hs.config.default.enableAutoStart := toBool(IniRead(hs.config.default.file, "config", "enableAutoStart", hs.config.default.enableAutoStart))
	hs.config.default.enableAutoUpdate := toBool(IniRead(hs.config.default.file, "config", "enableAutoUpdate", hs.config.default.enableAutoUpdate))
	hs.config.default.enableHkAutomation := toBool(IniRead(hs.config.default.file, "config", "enableHkAutomation", hs.config.default.enableHkAutomation))
	hs.config.default.enableHkClipboard := toBool(IniRead(hs.config.default.file, "config", "enableHkClipboard", hs.config.default.enableHkClipboard))
	hs.config.default.enableHkCommandLine := toBool(IniRead(hs.config.default.file, "config", "enableHkCommandLine", hs.config.default.enableHkCommandLine))
	hs.config.default.enableHkEpp := toBool(IniRead(hs.config.default.file, "config", "enableHkEpp", hs.config.default.enableHkEpp))
	hs.config.default.enableHkMisc := toBool(IniRead(hs.config.default.file, "config", "enableHkMisc", hs.config.default.enableHkMisc))
	hs.config.default.enableHkMouse := toBool(IniRead(hs.config.default.file, "config", "enableHkMouse", hs.config.default.enableHkMouse))
	hs.config.default.enableHkText := toBool(IniRead(hs.config.default.file, "config", "enableHkText", hs.config.default.enableHkText))
	hs.config.default.enableHkTransform := toBool(IniRead(hs.config.default.file, "config", "enableHkTransform", hs.config.default.enableHkTransform))
	hs.config.default.enableHkWindow := toBool(IniRead(hs.config.default.file, "config", "enableHkWindow", hs.config.default.enableHkWindow))
	hs.config.default.enableHsAlias := toBool(IniRead(hs.config.default.file, "config", "enableHsAlias", hs.config.default.enableHsAlias))
	hs.config.default.enableHsAutoCorrect := toBool(IniRead(hs.config.default.file, "config", "enableHsAutoCorrect", hs.config.default.enableHsAutoCorrect))
	hs.config.default.enableHsCode := toBool(IniRead(hs.config.default.file, "config", "enableHsCode", hs.config.default.enableHsCode))
	hs.config.default.enableHsDates := toBool(IniRead(hs.config.default.file, "config", "enableHsDates", hs.config.default.enableHsDates))
	hs.config.default.enableHsDos := toBool(IniRead(hs.config.default.file, "config", "enableHsDos", hs.config.default.enableHsDos))
	hs.config.default.enableHsJira := toBool(IniRead(hs.config.default.file, "config", "enableHsJira", hs.config.default.enableHsJira))
	hs.config.default.enableHsVariables := toBool(IniRead(hs.config.default.file, "config", "enableHsVariables", hs.config.default.enableHsVariables))
	hs.config.default.enableVersionCheck := toBool(IniRead(hs.config.default.file, "config", "enableVersionCheck", hs.config.default.enableVersionCheck))
	hs.config.default.shiftWindowPixels := IniRead(hs.config.default.file, "config", "shiftWindowPixels", hs.config.default.shiftWindowPixels)
	hs.config.default.sortCase := toBool(IniRead(hs.config.default.file, "config", "sortCase", hs.config.default.sortCase))
	hs.config.default.sortType := IniRead(hs.config.default.file, "config", "sortType", hs.config.default.sortType)
	hs.config.default.hkTotalCount := 0
	hs.config.default.hsTotalCount := 0
	hs.config.default.jiraPanels.format := IniRead(hs.config.default.file, "jira", "panelFormat", hs.config.default.jiraPanels.format)
	hs.config.default.jiraPanels.formatBlue := IniRead(hs.config.default.file, "jira", "panelFormatBlue", hs.config.default.jiraPanels.formatBlue)
	hs.config.default.jiraPanels.formatGreen := IniRead(hs.config.default.file, "jira", "panelFormatGreen", hs.config.default.jiraPanels.formatGreen)
	hs.config.default.jiraPanels.formatRed := IniRead(hs.config.default.file, "jira", "panelFormatRed", hs.config.default.jiraPanels.formatRed)
	hs.config.default.jiraPanels.formatYellow := IniRead(hs.config.default.file, "jira", "panelFormatYellow", hs.config.default.jiraPanels.formatYellow)
	hs.config.default.options.mySqlTransformRemainderToLower := toBool(IniRead(hs.config.default.file, "options", "mySqlTransformRemainderToLower", hs.config.default.options.mySqlTransformRemainderToLower))
	hs.config.default.options.oracleTransformRemainderToLower := toBool(IniRead(hs.config.default.file, "options", "oracleTransformRemainderToLower", hs.config.default.options.oracleTransformRemainderToLower))
	hs.config.default.options.resolutions := IniRead(hs.config.default.file, "options", "resolutions")
	if (hs.config.default.options.resolutions == "ERROR" || getSize(hs.config.default.options.resolutions) == 0) {
		hs.config.default.options.resolutions := "640x480,768x1024,&800x600,&1024x768,1280x720,1280x768,1280x800,1280x960,1&280x1024,1360x768,1&366x768,1&440x900,1600x900,1&600x1024,1680x1050,1&768x992,1&920x1080"
		saveDefault := true
	}
	hs.config.default.options.resolutions := listToArray(hs.config.default.options.resolutions, ",")
	hs.config.default.templates.html := IniRead(hs.config.default.file, "templates", "html", hs.config.default.templates.html)
	hs.config.default.templates.htmlKeys := IniRead(hs.config.default.file, "templates", "htmlKeys", hs.config.default.templates.htmlKeys)
	hs.config.default.templates.java := IniRead(hs.config.default.file, "templates", "java", hs.config.default.templates.java)
	hs.config.default.templates.javaKeys := IniRead(hs.config.default.file, "templates", "javaKeys", hs.config.default.templates.javaKeys)
	hs.config.default.templates.perl := IniRead(hs.config.default.file, "templates", "perl", hs.config.default.templates.perl)
	hs.config.default.templates.perlKeys := IniRead(hs.config.default.file, "templates", "perlKeys", hs.config.default.templates.perlKeys)
	hs.config.default.templates.sql := IniRead(hs.config.default.file, "templates", "sql", hs.config.default.templates.sql)
	hs.config.default.templates.sqlKeys := IniRead(hs.config.default.file, "templates", "sqlKeys", hs.config.default.templates.sqlKeys)
	if (loadHotKeyDefs(hs.config.default)) {
		saveDefault := true
	}
	sites := loadQuickLookupSites(hs.config.default)
	if (sites == "") {
		sites =
		(LTrim
			&Google
			https://www.google.com/search?q=@selection@
			Google &Images
			https://www.google.com/search?q=@selection@&tbm=isch
			Google &Maps
			https://www.google.com/maps/search/@selection@
			Google Trans&late
			https://translate.google.com/#auto/en/@selection@
			-
			-
			&Dictionary
			http://dictionary.reference.com/browse/@selection@
			&Thesaurus
			http://thesaurus.com/browse/@selection@
			&Wikipedia
			https://en.wikipedia.org/w/wiki.phtml?search=@selection@
			&Urban Dictionary
			http://www.urbandictionary.com/define.php?term=@selection@
			-
			-
			IMD&B
			http://www.imdb.com/find?q=@selection@
			&YouTube
			https://www.youtube.com/results?search_query=@selection@
			-
			-
			As &Application
			@selection@
			-
			-
			AutoHotkey Manual
			https://autohotkey.com/docs/commands/@selection@.htm
			AutoHotkey Forum
			https://autohotkey.com/boards/search.php?keywords=@selection@
			-
			-
			Cancel
			Cancel
		)
		saveDefault := true
	}
	hs.config.default.quickLookupSites := sites
	if (saveDefault) {
		saveConfig(hs.config.default)
	}
	; the clipboard is special in that it get persisted when it is changed by the user
	hs.config.user.clipboard := IniRead(hs.config.user.file, "config", "clipboard", "Windows")
	; now load from the user config, using the values from default if necessary
	hs.config.user.defaultHelpTab := IniRead(hs.config.user.file, "config", "defaultHelpTab", hs.config.default.defaultHelpTab)
	hs.config.user.lastHelpTab := IniRead(hs.config.user.file, "config", "lastHelpTab", hs.config.default.lastHelpTab)
	hs.config.user.editor := IniRead(hs.config.user.file, "config", "editor", hs.config.default.editor)
	hs.config.user.enableAutoStart := toBool(IniRead(hs.config.user.file, "config", "enableAutoStart", hs.config.default.enableAutoStart))
	hs.config.user.enableAutoUpdate := toBool(IniRead(hs.config.user.file, "config", "enableAutoUpdate", hs.config.default.enableAutoUpdate))
	hs.config.user.enableHkAutomation := toBool(IniRead(hs.config.user.file, "config", "enableHkAutomation", hs.config.default.enableHkAutomation))
	hs.config.user.enableHkClipboard := toBool(IniRead(hs.config.user.file, "config", "enableHkClipboard", hs.config.default.enableHkClipboard))
	hs.config.user.enableHkCommandLine := toBool(IniRead(hs.config.user.file, "config", "enableHkCommandLine", hs.config.default.enableHkCommandLine))
	hs.config.user.enableHkEpp := toBool(IniRead(hs.config.user.file, "config", "enableHkEpp", hs.config.default.enableHkEpp))
	hs.config.user.enableHkMisc := toBool(IniRead(hs.config.user.file, "config", "enableHkMisc", hs.config.default.enableHkMisc))
	hs.config.user.enableHkMouse := toBool(IniRead(hs.config.user.file, "config", "enableHkMouse", hs.config.default.enableHkMouse))
	hs.config.user.enableHkText := toBool(IniRead(hs.config.user.file, "config", "enableHkText", hs.config.default.enableHkText))
	hs.config.user.enableHkTransform := toBool(IniRead(hs.config.user.file, "config", "enableHkTransform", hs.config.default.enableHkTransform))
	hs.config.user.enableHkWindow := toBool(IniRead(hs.config.user.file, "config", "enableHkWindow", hs.config.default.enableHkWindow))
	hs.config.user.enableHsAlias := toBool(IniRead(hs.config.user.file, "config", "enableHsAlias", hs.config.default.enableHsAlias))
	hs.config.user.enableHsAutoCorrect := toBool(IniRead(hs.config.user.file, "config", "enableHsAutoCorrect", hs.config.default.enableHsAutoCorrect))
	hs.config.user.enableHsCode := toBool(IniRead(hs.config.user.file, "config", "enableHsCode", hs.config.default.enableHsCode))
	hs.config.user.enableHsDates := toBool(IniRead(hs.config.user.file, "config", "enableHsDates", hs.config.default.enableHsDates))
	hs.config.user.enableHsDos := toBool(IniRead(hs.config.user.file, "config", "enableHsDos", hs.config.default.enableHsDos))
	hs.config.user.enableHsJira := toBool(IniRead(hs.config.user.file, "config", "enableHsJira", hs.config.default.enableHsJira))
	hs.config.user.enableHsVariables := toBool(IniRead(hs.config.user.file, "config", "enableHsVariables", hs.config.default.enableHsVariables))
	hs.config.user.enableVersionCheck := toBool(IniRead(hs.config.user.file, "config", "enableVersionCheck", hs.config.default.enableVersionCheck))
	hs.config.user.sortCase := toBool(IniRead(hs.config.user.file, "config", "sortCase", hs.config.default.sortCase))
	hs.config.user.sortType := IniRead(hs.config.user.file, "config", "sortType", hs.config.default.sortType)
	hs.config.user.shiftWindowPixels := IniRead(hs.config.user.file, "config", "shiftWindowPixels", hs.config.default.shiftWindowPixels)
	hs.config.user.hkTotalCount := IniRead(hs.config.user.file, "config", "hkTotalCount" . hs.vars.uniqueId, hs.config.default.hkTotalCount)
	hs.config.user.hsTotalCount := IniRead(hs.config.user.file, "config", "hsTotalCount" . hs.vars.uniqueId, hs.config.default.hsTotalCount)
	hs.config.user.jiraPanels.format := IniRead(hs.config.user.file, "jira", "panelFormat", hs.config.default.jiraPanels.format)
	hs.config.user.jiraPanels.formatBlue := IniRead(hs.config.user.file, "jira", "panelFormatBlue", hs.config.default.jiraPanels.formatBlue)
	hs.config.user.jiraPanels.formatGreen := IniRead(hs.config.user.file, "jira", "panelFormatGreen", hs.config.default.jiraPanels.formatGreen)
	hs.config.user.jiraPanels.formatRed := IniRead(hs.config.user.file, "jira", "panelFormatRed", hs.config.default.jiraPanels.formatRed)
	hs.config.user.jiraPanels.formatYellow := IniRead(hs.config.user.file, "jira", "panelFormatYellow", hs.config.default.jiraPanels.formatYellow)
	hs.config.user.lastUpdateCheck := IniRead(hs.config.user.file, "config", "lastUpdateCheck", " ")
	hs.config.user.options.mySqlTransformRemainderToLower := toBool(IniRead(hs.config.user.file, "options", "mySqlTransformRemainderToLower", hs.config.default.options.mySqlTransformRemainderToLower))
	hs.config.user.options.oracleTransformRemainderToLower := toBool(IniRead(hs.config.user.file, "options", "oracleTransformRemainderToLower", hs.config.default.options.oracleTransformRemainderToLower))
	hs.config.user.options.resolutions := listToArray(IniRead(hs.config.user.file, "options", "resolutions", arrayToList(hs.config.default.options.resolutions, ",")), ",")
	hs.config.user.templates.html := IniRead(hs.config.user.file, "templates", "html", hs.config.default.templates.html)
	hs.config.user.templates.java := IniRead(hs.config.user.file, "templates", "java", hs.config.default.templates.java)
	hs.config.user.templates.perl := IniRead(hs.config.user.file, "templates", "perl", hs.config.default.templates.perl)
	hs.config.user.templates.sql := IniRead(hs.config.user.file, "templates", "sql", hs.config.default.templates.sql)
	; set HotKeys to equal defaults, then override any from the user
	hs.config.user.hotKeys := hs.config.default.hotKeys
	loadHotKeyDefs(hs.config.user)
	setActiveClipboard(hs.config.user.clipboard, false)
	sites := loadQuickLookupSites(hs.config.user)
	hs.config.user.quickLookupSites := (sites == "" ? hs.config.default.quickLookupSites : sites)
	; save after loading to make sure any new values are persisted
	saveConfig(hs.config.user, hs.config.default)
	registerKeys()

	if (saveDefault) {
		createUserFiles()
		FileDelete(hs.file.CUSTOM_HELP)
	}
	if (!FileExist(hs.file.CUSTOM_HELP)) {
		createCustomHelp()
	}
	if (!FileExist(hs.file.ICON)) {
		createIcon()
	}
}

loadHotKeyDefs(config) {
	needToSave := false
	if (!loadHotKeys(config, "hkAutomation")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkClipboard")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkCommandLine")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkEpp")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkHotScript")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkMisc")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkMouse")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkText")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkTransform")) {
		needToSave := true
	}
	if (!loadHotKeys(config, "hkWindow")) {
		needToSave := true
	}
	return needToSave
}

loadHotKeys(config, section) {
	file := config.file
	keys := IniRead(file, section)
	keyArr := {}
	isDefault := containsIgnoreCase(config.file, "default")
	found := false
	Loop, Parse, keys, % hs.const.EOL_NIX
	{
		pos := InStr(A_LoopField, "=")
		key := SubStr(A_LoopField, 1, (pos - 1))
		value := SubStr(A_LoopField, (pos + 1))
		keyArr[(key)] := value
		found := true
	}
	if (not IsObject(config.hotKeys[(section)])) {
		config.hotKeys[(section)] := {}
	}
;	 if (isDefault && !found) {
	if (isDefault) {
		keyArr := getDefaultHotKeyDefs(section)
	}
	for key, value in keyArr {
		config.hotKeys[(section)][(key)] := value
	}
	return found
}

loadQuickLookupSites(config) {
	file := config.file
	allSites := ""
	sites := IniRead(file, "quickLookup")
	Loop, Parse, sites, % hs.const.EOL_NIX
	{
		value := Trim(SubStr(A_LoopField, (InStr(A_LoopField, "=") + 1)))
		if (value != "") {
			allSites .= value . hs.const.EOL_NIX
		}
	}
	return allSites
}

maximize(hWnd:="") {
	hWnd := getHwnd(hWnd)
	WinGet, minMaxState, MinMax, ahk_id %hWnd%
	if (minMaxState == 1) {
		WinRestore, ahk_id %hWnd%
	}
	else {
		WinMaximize, ahk_id %hWnd%
	}
}

menuBuilder(menu, parent:="", parentHandler:="") {
	static colors := {}
	handler := parentHandler
	tmpName := (menu == "" ? menu.name : menu)
	static level := 0
	static menus := Object()
	if (IsObject(menu)) {
		if (menu.name != "") {
			; this is the top-level menu
			level := 0
			; add something blank in case it does not yet exist; otherwise it throws an error
			Menu, % menu.name, Add
			Menu, % menu.name, DeleteAll
			if (menu.handler != "") {
				if (IsFunc(menu.handler)) {
					handler := menu.handler
				}
				else {
					msg := "Warning: menu.handler defined (" . menu.handler . ") for`nmenu '" . menu.name . "' but it is not a function."
					message(msg, "Menu handler not found", 48)
				}
			}
			if (handler == "") {
				if (IsFunc(parentHandler)) {
					handler := parentHandler
				}
				else if (IsFunc(menu.name) && menu.name != "InternalUserMenu") {
					handler := menu.name
				}
				else if (IsFunc(menu.name . "Handler")) {
					handler := menu.name . "Handler"
				}
				else {
					handler := "menuHandler"
				}
			}
			level++
			colors[menu.name] := (menu.color != "" ? menu.color : hs.const.MENU_COLORS[level].color)
			; build the menu
			menuBuilder(menu.entries, toSafeName(menu.name), handler)
			menus.insert(menu.name)
			for name, color in colors {
				Menu, %name%, Color, %color%, Single
			}
			if (menu.name != "Tray") {
				Menu, % menu.name, Show
				for k, v in menus {
					Menu, % v, DeleteAll
				}
			}
			colors := {}
			level := 0
			menus := Object()
		}
		else {
			if (menu.text != "") {
				menuName := toSafeName(parent . menu.text)
				if (IsObject(menu.entries)) {
					;debug("object.handler -> [" . menu.handler . "] for menu: " . menuName)
					if (menu.handler != "") {
						if (IsFunc(menu.handler)) {
							handler := menu.handler
						}
						else {
							msg := "Warning: menu.handler defined (" . menu.handler . ") for`nmenu '" . parent . "' but it is not a function.`n`nUsing default handler '" . handler . "'."
							message(msg, "Menu handler not found", 48)
						}
					}
					level++
					; build the sub-menu
					; add something blank in case it does not yet exist; otherwise it throws an error
					Menu, % menuName, Add
					; this is needed here because sub-menus that have previously been shown retail any separators and need to be cleared out; other entries overwrite but not separators
					Menu, % menuName, DeleteAll
					menuBuilder(menu.entries, menuName, handler)
					Menu, %parent%, Add, % menu.text, % ":" . menuName
					menus.insert(menuName)
					if (menu.iconFile != "") {
						;debug("object has icon -> " . toString(menu))
						Menu, %parent%, Icon, % menu.text, % menu.iconFile, % menu.iconNumber, % menu.iconWidth
					}
					colors[menuName] := (menu.color != "" ? menu.color : hs.const.MENU_COLORS[level].color)
					level--
				}
				else {
					if (menu.handler != "") {
						if (IsFunc(menu.handler)) {
							handler := menu.handler
						}
						else {
							msg := "Warning: menu.handler defined (" . menu.handler . ") for`nmenuItem '" . menu.text . "' on menu '" . parent . "'`nbut it is not a function.`n`nUsing default handler '" . handler . "'."
							message(msg, "Menu handler not found", 48)
						}
					}
					Menu, %parent%, Add, % menu.text, %handler%, % menu.options
					if (menu.iconFile != "") {
						;debug("entry has icon -> " . toString(menu))
						iconCmd := "Menu, " . parent . ", Icon, " . menu.text . ", " . menu.iconFile . ", " . menu.iconNumber . ", " . menu.iconWidth
						;debug("iconCmd -> " . iconCmd)
						Menu, %parent%, Icon, % menu.text, % menu.iconFile, % menu.iconNumber, % menu.iconWidth
					}
					if (toBool(menu.disabled)) {
						Menu, %parent%, Disable, % menu.text
					}
				}
			}
			else {
				; iterate over the actual entries
				for i, entry in menu {
					menuBuilder(entry, parent, handler)
				}
			}
		}
	}
	else {
		if (menu != "") {
			Menu, %parent%, Add, %menu%, %handler%
		}
		else {
			Menu, %parent%, Add
		}
	}
}

menuHandler() {
	if (A_ThisMenuItem != "&Cancel") {
		funcName := A_ThisMenu . toSafeName(A_ThisMenuItem)
		if (IsFunc(funcName)) {
			%funcName%()
		}
		else {
			msg =
			(LTrim Join`r`n
				Function for '%funcName%' has not yet been defined...

				Add this function definition to your script:

				%funcName%() {
					%A_Space%   ; TODO - implement this function
					%A_Space%   message(A_ThisFunc . "() has not been implemented yet.")
				}
			)
			output(msg)
		}
	}
}

merge(target, values*) {
	newTarget := deepCopy(target)
	if (isArray(target)) {
		mergeArray(newTarget, values*)
	}
	else if (IsObject(target)) {
		mergeObject(newTarget, values*)
	}
	return newTarget
}

mergeArray(target, values*) {
	if (isArray(target)) {
		for i, val in values {
			if (isArray(val)) {
				for j, val2 in val {
					target.push(val2)
				}
			}
			else {
				target.push(val)
			}
		}
	}
	else {
		message("Target is not an array: " . toString(target), "Invalid target", 48)
	}
}

mergeObject(target, obj) {
	if (IsObject(target)) {
		for k, v in obj {
			if (IsObject(v)) {
				if (!target.hasKey(k)) {
					;message("Creating key '" . k . "' for object: " . toString(target))
					target[k] := {}
				}
				mergeObject(target[k], v)
			}
			else {
				target[k] := v
			}
		}
	}
	else {
		message("Target is not an object: " . toString(target), "Invalid target", 48)
	}
}

message(msg, title:="", options:="0", timeout:="0") {
	orig_hWnd := getHwnd()
	activeMon := getMonitorForWindow()
	if (title == "") {
		title := hs.TITLE
	}
	SetTimer, CenterMsgBox, 10
	MsgBox, % options, % title, % msg, % timeout
	WinActivate, ahk_id %orig_hWnd%
	IfMsgBox, Abort
		return "Abort"
	IfMsgBox, Cancel
		return "Cancel"
	IfMsgBox, Continue
		return "Continue"
	IfMsgBox, Ignore
		return "Ignore"
	IfMsgBox, No
		return "No"
	IfMsgBox, OK
		return "OK"
	IfMsgBox, Retry
		return "Retry"
	IfMsgBox, Timeout
		return "Timeout"
	IfMsgBox, TryAgain
		return "TryAgain"
	IfMsgBox, Yes
		return "Yes"

	CenterMsgBox:
		hWnd := getHwnd()
		SetTimer, CenterMsgBox, Off
		centerWindow(, activeMon)
		return
}

minimize(hWnd:="") {
	hWnd := getHwnd(hWnd)
	WinGet, minMaxState, MinMax, ahk_id %hWnd%
	if (minMaxState == -1) {
		WinRestore, ahk_id %hWnd%
	}
	else {
		WinMinimize, ahk_id %hWnd%
	}
}

moveCurrentLineDown() {
	if (isActiveCommandLine()) {
		splash("Unable to move line within a command-line window...", 2000)
		return
	}
	selText := getCurrentLine()
	eol := getEol(selText)
	hasEol := endsWith(selText, eol)
	if (!hasEol) {
		SendInput, {End}
		return
	}
	SendInput, ^x
	curText := getCurrentLine()
	eol := getEol(curText)
	hasEol := endsWith(curText, eol)
	if (hasEol) {
		SendInput, {Home}
	}
	else {
		SendInput, {End}{Enter}
	}
	SendInput, ^v
	if (hasEol) {
		SendInput, {Up}
	}
	else {
		SendInput, {Backspace}{Home}
	}
}

moveCurrentLineUp() {
	if (isActiveCommandLine()) {
		splash("Unable to move line within a command-line window...", 2000)
		return
	}
	selText := getCurrentLine()
	eol := getEol(selText)
	hasEol := endsWith(selText, eol)
	SendInput, ^x{Up}^v
	if (!hasEol) {
		SendInput, {Enter}{Down}{Backspace}{Home}
	}
	SendInput, {Up}
}

moveMouseForMonitor(x, y) {
	origMode := A_CoordModeMouse
	CoordMode("Mouse", "screen")
	mon := hs.vars.monitors[getMonitorForWindow()]
	MouseMove(mon.workLeft + x, mon.workTop + y, 0)
	CoordMode("Mouse", origMode)
	; not sure why, but Sleep is needed here otherwise accelators are not displayed in menus
	Sleep(100)
}

moveToEdge(edge:="T", hWnd:="") {
	hWnd := getHwnd(hWnd)
	if (hWnd) {
		origDelay := A_WinDelay
		SetWinDelay, 0
		WinGetPos, winX, winY, winW, winH, ahk_id %hWnd%
		monitor := getMonitorForWindow()
		targetMon := hs.vars.monitors[monitor]
		if (equalsIgnoreCase(edge, "B")) {
			winY := (targetMon.workBottom - winH)
		}
		else if (equalsIgnoreCase(edge, "L")) {
			winX := targetMon.workLeft
		}
		else if (equalsIgnoreCase(edge, "R")) {
			winX := (targetMon.workRight - winW)
		}
		else {
			winY := targetMon.workTop
		}
		if (isWin10()) {
			if (equalsIgnoreCase(edge, "L")) {
				winX += -7
			}
			else if (equalsIgnoreCase(edge, "R")) {
				winX += 7
			}
			else if (equalsIgnoreCase(edge, "B")) {
				winY += 6
			}
		}
		WinMove, ahk_id %hWnd%,, winX, winY, winW, winH
		SetWinDelay, %origDelay%
	}
}

moveToMonitor(hWnd:="", monitor:="") {
	origDelay := A_WinDelay
	SetWinDelay, 0
	hWnd := getHwnd(hWnd)
	if (is(monitor, "number")) {
		if (monitor < 1) {
			monitor := 1
		}
		else if (monitor > hs.vars.monitors.count) {
			monitor := hs.vars.monitors.count
		}
	}
	else {
		monitor := getMonitorForWindow(hWnd)
	}
	targetMon := hs.vars.monitors[monitor]
	win := getWindowInfo(hWnd)
	if (win.state == "Minimized") {
		WinRestore, ahk_id %hWnd%
	}
	newX := targetMon.workLeft
	newY := targetMon.workTop
	newW := win.width
	newH := win.height
	WinMove, ahk_id %hWnd%,, %newX%, %newY%, %newW%, %newH%
	SetWinDelay, %origDelay%
}

moveWindowNextPrevMonitor(hWnd:="", direction:=1, keepRelativeSize:=true) {
	if (equalsIgnoreCase(hWnd, "M")) {
		MouseGetPos(MouseX, MouseY, hWnd)
	}
	else {
		hWnd := getHwnd(hWnd)
	}
	direction := (direction == -1 ? -1 : 1)
	if (!WinExist("ahk_id " . hWnd)) {
		SoundPlay, *64
		;MsgBox, 16, moveWindowNextPrevMonitor() - Error, Specified window does not exist. Window ID = %hWnd%
		return
	}
	refreshMonitors()
	monCount := hs.vars.monitors.count
	if (monCount <= 1) {
		return
	}
	Loop, % monCount {
		SysGet, Monitor%A_Index%, MonitorWorkArea, %A_Index%
		Monitor%A_Index%Width := Monitor%A_Index%Right - Monitor%A_Index%Left
		Monitor%A_Index%Height := Monitor%A_Index%Bottom - Monitor%A_Index%Top
	}
	WinGet, origMinMax, MinMax, ahk_id %hWnd%
	if (origMinMax == -1) {
		return
	}
	origDelay := A_WinDelay
	SetWinDelay, 0
	if (origMinMax == 1) {
		WinRestore, ahk_id %hWnd%
	}
	WinGetPos, WinX, WinY, WinW, WinH, ahk_id %hWnd%
	WinCenterX := WinX + WinW / 2
	WinCenterY := WinY + WinH / 2
	curMonitor := 0
	Loop, % monCount {
		if ((WinCenterX >= Monitor%A_Index%Left) && (WinCenterX < Monitor%A_Index%Right) && (WinCenterY >= Monitor%A_Index%Top) && (WinCenterY < Monitor%A_Index%Bottom)) {
			curMonitor := A_Index
			break
		}
	}
	nextMonitor := curMonitor + direction
	if (nextMonitor > monCount) {
		nextMonitor := 1
	}
	else if (nextMonitor <= 0) {
		nextMonitor := monCount
	}
	WinMoveX := (WinX - Monitor%curMonitor%Left) * Monitor%NextMonitor%Width // Monitor%curMonitor%Width + Monitor%NextMonitor%Left
	WinMoveY := (WinY - Monitor%curMonitor%Top) * Monitor%NextMonitor%Height // Monitor%curMonitor%Height + Monitor%NextMonitor%Top
	WinGetClass, winClass, A
	; TODO - this is only for Calculator before Windows 10
	if (winClass == "CalcFrame") {
		; TODO - also for Windows Start menu (check Start Menu for Win10 too)
		keepRelativeSize := false
	}
	if (keepRelativeSize) {
		WinMoveW := WinW * Monitor%NextMonitor%Width // Monitor%curMonitor%Width
		WinMoveH := WinH * Monitor%NextMonitor%Height // Monitor%curMonitor%Height
	}
	else {
		WinMoveW := WinW
		WinMoveH := WinH
	}
	WinMove, ahk_id %hWnd%,, WinMoveX, WinMoveY, WinMoveW, WinMoveH
	if (origMinMax == 1) {
		WinMaximize, ahk_id %hWnd%
	}
	SetWinDelay, %origDelay%
}

numberRemoveSelected() {
	selText := getSelectedText()
	if (selText == "") {
		SendInput, {End}{Home}+{End}
		selText := getSelectedText()
	}
	if (selText != "") {
		eol := getEol(selText)
		first := true
		newText := ""
		Loop, Parse, selText, % hs.const.EOL_NIX, % hs.const.EOL_MAC
		{
			if (first) {
				first := false
			}
			else {
				newText .= eol
			}
			newText .= RegExReplace(A_LoopField, "^\d+\.\s?", "")
		}
		replaceSelected(newText)
	}
}

numberSelected(start:="1") {
	selText := getSelectedText()
	if (selText == "") {
		SendInput, {End}{Home}+{End}
		selText := getSelectedText()
	}
	if (selText != "") {
		eol := getEol(selText)
		hasEol := endsWith(selText, eol)
		if (hasEol) {
			selText := SubStr(selText, 1, 0 - StrLen(eol))
		}
		;first := 1
		newText := ""
		count := start
		Loop, Parse, selText, % hs.const.EOL_NIX, % hs.const.EOL_MAC
		{
			newText .= count . ". " . A_LoopField . eol
			count++
		}
		if (!hasEol) {
			newText := SubStr(newText, 1, 0 - StrLen(eol))
		}
		replaceSelected(newText)
	}
}

numberSelectedPrompt() {
	promptNumber:
	start := ask("Auto-Number", "Starting number",,, 1)
	if (ErrorLevel) {
		return
	}
	if !is(start, "integer") {
		Sleep(100)
		message("Invalid starting number (" . start . ") - must be an integer.")
		goto promptNumber
	}
	else {
		numberSelected(start)
	}
}

output(msg, title:="Output") {
	static baseFont := new Font().size(11).name("Consolas")
	rows := strCount(msg, "\r\n|\n|\r", true) + 1
	if (rows > 30) {
		rows := 30
	}
	fields := [new FormField().name("output").hideLabel().rows(rows).default(msg).readOnly()]
	activeMon := getMonitorForWindow()
	buttons := ["Copy", "outputCopy", "Close", "outputClose"]
	; without the noButtons(), the text in the edit control is automatically highlighted
	outputForm := new Form()
		.title(title).vertical().noWait().noButtons().buttons(buttons)
		.color("EFEFFF").inputColor("black", "FFFEE3").inputFont(baseFont)
		.inputWidth(hs.vars.monitors[activeMon].workWidth * 0.9)
		.fields(fields).send("^{Home}")
	buildForm(outputForm)
}

outputClose(theForm) {
	return true
}

outputCopy(theForm) {
	ControlGetText, value, Edit1
	Clipboard := value
	return false
}

pad(value, width, char:=" ", type:="R") {
	if (StrLen(char) != 1) {
		char := A_Space
	}
	type := (equalsIgnoreCase(type, "l") || equalsIgnoreCase(type, "left") ? "L" : "R")
	spaces := repeatStr(char, width - StrLen(value))
	return (type == "L" ? spaces . value : value . spaces)
}

passThru(key) {
	; TODO - this is sending mouseWheel events (WheelLeft, XButton1, Win-Shift-LButton, etc) as text
	; TODO - also sending as text: ^LCtrl, ^AppsKey
	; TODO - how will this handle multi-key, like: Esc & H, or ^CapsLock

	; this does NOT handle "Click [options]"
	;debug("Blacklisted window - key: " . hk)
	; TODO - this doesn't work for everything; !End gets matched, but comes out as just End - for now, using HotKey with SendInput asd a work-around
	; this still doesn't seem to work, at least for Java Swing apps

	static regexKeys := "i)^[!#+^]*(Alt(?: down)?|AppsKey|ASC (?:[0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])|Backspace|Browser_(?:Back|F(?:avorites|orward)|Home|Refresh|S(?:earch|top))|BS|(?:Caps|Num|Scroll)Lock|Control(?: down)?|Ctrl(?: down|Break)?|Del(?:ete)?|Down|E(?:nd|nter)|Esc(?:ape)?|F(?:2[0-4]|1[0-9]|[1-9])|Home|Ins(?:ert)?|[LR]Alt|Launch_(?:App[1-2]|Mail|Media)|[LMR]Button|[LR]C(?:ontro|tr)l||Left|[LR]Shift|[LR]Win(?: down)?|Media_(?:Next|P(?:lay_Pause|rev)|Stop)|NumPad(?:[0-9]|Add|Clear|D(?:el|iv|ot|own)|E(?:nd|nter)|Home|Ins|Left|Mult|Pg(?:Dn|Up)|Right|Sub|Up)|Pause|Pg(?:Dn|Up)|PrintScreen|Right|Shift(?: down)?|S(?:leep|pace)|Tab|U\+[0-9A-F]{4}|Up|(?:vk[0-9A-F]{2})?(?:sc[0-9A-F]{3})?|Volume_(?:Down|Mute|Up)|Wheel(?:Down|Left|Right|Up)|XButton[1-2])$"
	keys := RegexReplace(key, regexKeys, "{$1}")
	if (keys != "{}") {
		hasAlt := (contains(key, "!"))
		hasCtrl := (contains(key, "^"))
		hasShift := (contains(key, "+"))
		hasWin := (contains(key, "#"))
		preKeys := ""
		postKeys := ""
		if (hasAlt) {
			preKeys .= "{LAlt down}"
			postKeys .= "{LAlt up}"
		}
		if (hasCtrl) {
			preKeys .= "{LCtrl down}"
			postKeys .= "{LCtrl up}"
		}
		if (hasShift) {
			preKeys .= "{LShift down}"
			postKeys .= "{LShift up}"
		}
		if (hasWin) {
			preKeys .= "{LWin down}"
			postKeys .= "{LWin up}"
		}
		keyStr := preKeys . keys . postKeys
		SendInput, %keyStr%
	}
	else {
		debug("Warning - unable to passthru key: [" . key . "]")
	}
;	 SendInput, %key%
}

pasteTemplate(tmpl, tokens:="deprecated", keys:="deprecated", delay:="deprecated") {
	if (deprecatedParam("tokens", tokens)) {
		if (deprecatedParam("keys", keys)) {
			deprecatedParam("delay", delay)
		}
	}
	if (tmpl.__Class != "Template") {
		func := A_ThisFunc
		message("The old implementation of " . func . "() has been deprecated!`n`n`tOld:`t" . func . "(template, keys, delay)`n`n" . func . "() must be called with a single Template parameter.`n`n`tNew:`t" . func . "(Template)" . getStackTraceStr(), "Deprecation error - " . func . "()", 16)
	}
	else {
		if (tmpl._linePrefix ~= "( |\t)+") {
			indent := getIndent()
			if (indent != "") {
				indentLen := StrLen(indent)
				Send, {Left %indentLen%}{Delete %indentLen%}
			}
		}
		sendText(prepTemplate(tmpl), tmpl._keys)
	}
}

pasteText(text:="", delay:="deprecated") {
	deprecatedParam("delay", delay)
	if (text != "") {
		origIgnore := hs.internal.clipIgnore
		clipIgnore()
		eol := getEol(text)
		if (eol == hs.const.EOL_NIX) {
			; because templates are often from a continuation section, convert EOLs to Windows (CRLF)
			text := StrReplace(text, hs.const.EOL_NIX, hs.const.EOL_WIN)
		}
		Clipboard := text
		clipSleep()
		if (isActiveAltPaste()) {
			SendInput, +{Insert}
		}
		else if (isActiveApiPaste()) {
			tmpCtrl := ControlGetFocus("A")
			; https://blogs.msdn.microsoft.com/bill/2012/06/09/programmatically-paste-clipboard-text-to-a-cmd-window-c-or-c/
			PostMessage, hs.const.WM.COMMAND, 0xfff1, 0, % tmpCtrl, A
			Sleep(50)
		}
		else {
			SendInput, ^v
		}
		 clipIgnore(origIgnore)
	}
	else {
		SendInput, {Del}
	}
	return
}

prepTemplate(tmpl) {
	; don't update the object variables
	cutLeft := tmpl._cutLeft
	cutRight := tmpl._cutRight
	eol := tmpl._eol

	if (!hasEol(tmpl._text)) {
		eol := ""
	}
	newText := tmpl._prepend
	if (cutLeft > 0) {
		cutLeft++
	}
	if (cutRight > 0) {
		cutRight *= -1
	}
	text := tmpl._text
	Loop, Parse, text, `n
	{
		line := A_LoopField
		hadEol := hasEol(line)
		if (hadEol) {
			line := stripEol(line)
		}
		if (tmpl._trimLeft) {
			line := LTrim(line)
		}
		if (cutLeft != 0) {
			line := SubStr(line, cutLeft)
		}
		if (tmpl._trimRight) {
			line := RTrim(line)
		}
		if (cutRight != 0) {
			line := SubStr(line, 1, cutRight)
		}
		line := tmpl._linePrefix . line . tmpl._lineSuffix
		; do this again because linePrefix could add whitespace to blank lines or lineSuffix may have added trailing whitespace
		if (tmpl._trimRight) {
			line := RTrim(line)
		}
		newText .= line . (hadEol ? eol : "")
	}
	newText .= tmpl._append
	return prepText(newText, tmpl._tokens)
}

prepText(text, tokens:="") {
	newText := text
	; replace tokens with passed in values
	for name, value in tokens {
		token := "${" . name . "}"
		; TODO - how to handle when token value is object and token variable is dotted?
		; use something like getVar()
		; ${someObj.someVal}

		; TODO - how to handle when token value is array and token variable is indexed?
		; ${someArr[3]}

		; TODO - should this use RegexReplace() instead? be careful about special characters: $ { } [ ] ( ) \ |, etc
		newText := StrReplace(newText, token, value)
	}

	; replace tokens with global variables
	pos := 1
	while (pos > 0) {
		pos := RegexMatch(newText, "i)\$\{([a-z_\$][\w\.\$]{0,252})\}", matched, pos)
		if (pos > 0) {
			value := getVar(matched1)
			; TODO - this mostly works, unless the token actually exists and is truly empty
			; until AHK can support checking if a variable exists versus empty, this will not be able to replace tokens using global vars with empty
			; it does work above with passed in tokens
			if (value != "") {
				newText := StrReplace(newText, matched, value)
			}
			else {
				pos++
			}
		}
	}

	; TODO - replace array tokens
	/*
		${someArr[3]}
	*/

	; TODO - replace object.value[array] tokens
	/*
		${hs.const.MENU_COLORS[3]}
	*/

	; replace tokens with function values
	pos := 1
	while (pos > 0) {
		pos := RegexMatch(newText, "i)\$\{([a-z_\$][\w\$]{0,252})\(\)\}", matched, pos)
		if (pos > 0) {
			if (isFunc(matched1)) {
				func := Func(matched1)
				result := func.Call()
				newText := StrReplace(newText, matched, result)
			}
		}
	}

	; TODO - improved support for function tokens
	/*
		is it a function?
			yes, how to handle parameters?

		${myFunc(p1, p2)}
		${myFunc(p1 + p2)}
		${myFunc(p1 - p2)}
		look at eval.ahk
	*/

	; TODO - replace ternary operations
	/*
		${hs.monitors.count > 1 ? "Multiple" : "Single"}
	*/
;	 debug("newText = " . newText)
	return newText
}

refreshMonitors() {
	SysGet, monCount, MonitorCount
	SysGet, monPrimary, MonitorPrimary
	SysGet, virtualWidth, 78
	SysGet, virtualHeight, 79
	hs.vars.monitors.count := monCount
	hs.vars.monitors.primary := monPrimary
	hs.vars.monitors.desktopHeight := virtualHeight
	hs.vars.monitors.desktopWidth := virtualWidth
	Loop, % hs.vars.monitors.count {
		SysGet, monName, MonitorName, %A_Index%
		SysGet, mon, Monitor, %A_Index%
		SysGet, monWork, MonitorWorkArea, %A_Index%
		curMon := {}
		curMon.idx := A_Index
		curMon.name := monName
		curMon.left := monLeft
		curMon.right := monRight
		curMon.top := monTop
		curMon.bottom := monBottom
		curMon.height := (monBottom - monTop)
		curMon.width := (monRight - monLeft)
		curMon.workLeft := monWorkLeft
		curMon.workRight := monWorkRight
		curMon.workTop := monWorkTop
		curMon.workBottom := monWorkBottom
		curMon.workHeight := (monWorkBottom - monWorkTop)
		curMon.workWidth := (monWorkRight - monWorkLeft)
		hs.vars.monitors[curMon.idx] := curMon
	}
}

regexStartBoundary(str:="") {
	return "(?<=^|[^a-zA-Z0-9])" . str
}

regexEndBoundary(str:="") {
	return str . hs.const.END_CHARS_REGEX
}

registerKeys() {
	for section, svalue in hs.config.user.hotKeys {
		category := "enable" . setCase(SubStr(section, 1, 1), "U") . SubStr(section, 2)
		if (section == "hkHotScript" || hs.config.user[(category)]) {
			for action, kvalue in hs.config.user.hotKeys[(section)] {
				if (kvalue != "") {
					if (section == "hkCommandLine") {
						condition := group("CommandLine")
					}
					else if (section == "hkEpp") {
						condition := group("EditPad")
					}
					else if (action == "hkAutomationDosPromptInExplorer" || action == "hkMiscExplorerBack" || action == "hkMiscExplorerUpOneLevel") {
						condition := group("Explorer")
					}
					else if (action == "hkAutomationUserMenu") {
						if (!IsFunc("userMenu")) {
							continue
						}
					}
					else {
						condition := ""
					}
					hotKey(kvalue, RegExReplace(action, "-\d+$", "$1"), condition)
				}
			}
		}
	}
	hotKey("RButton", "clipPasteApi", group("ApiPaste"))
	hotKey("^Left", "quickHelpPrev", hs.help.title)
	hotKey("^Right", "quickHelpNext", hs.help.title)
	Loop, 10 {
		idx := (A_Index == 0 ? 10 : A_Index - 1)
		hotKey("^" . idx, "quickHelpTab" . idx, hs.help.title)
	}
}

repeatStr(value, count) {
	result := ""
	if (count <= 10) {
		Loop, % count {
			result .= value
		}
	}
	else {
		remainder := count
		millions := Floor(remainder / 1000000)
		remainder -= (millions * 1000000)
		thousands := Floor(remainder / 1000)
		remainder -= (thousands * 1000)
		hundreds := Floor(remainder / 100)
		remainder -= (hundreds * 100)
		tens := Floor(remainder / 10)
		remainder -= (tens * 10)
		ones := remainder
		tenStr := ""
		hundredStr := ""
		thousandStr := ""
		millionStr := ""
		Loop, 10 {
			tenStr .= value
		}
		if (count >= 100) {
			Loop, 10 {
				hundredStr .= tenStr
			}
		}
		if (count >= 1000) {
			Loop, 10 {
				thousandStr .= hundredStr
			}
		}
		if (count >= 1000000) {
			Loop, 1000 {
				millionStr .= thousandStr
			}
		}
		Loop, % millions {
			result .= millionStr
		}
		millionStr := ""
		Loop, % thousands {
			result .= thousandStr
		}
		thousandStr := ""
		Loop, % hundreds {
			result .= hundredStr
		}
		hundredStr := ""
		Loop, % tens {
			result .= tenStr
		}
		tenStr := ""
		Loop, % ones {
			result .= value
		}
	}
	return result
}

replaceCurlyQuotes(str) {
	result := str
	result := StrReplace(result, Chr(0x201C), """")
	result := StrReplace(result, Chr(0x201D), """")
	result := StrReplace(result, Chr(0x2018), "'")
	result := StrReplace(result, Chr(0x2019), "'")
	return result
}

replaceEachLine(value, line) {
	eol := getEol(value)
	hasEol := endsWith(value, eol)
	newText := ""
	Loop, Parse, value, % hs.const.EOL_NIX, % hs.const.EOL_MAC
	{
		newText .= line . eol
	}
	if (!hasEol) {
		newText := SubStr(newText, 1, 0 - StrLen(eol))
	}
	return newText
}

replaceSelected(text) {
	pasteText(text)
	;len := StrLen(text)
	; TODO - how to select multiple lines?
	; get text before pasting
	;	create an array to store leftCount
	;	in a loop
	;		increment leftCount for everything that is not an EOL
	;			once an EOL is found, create new array entry for leftCount
	;	after pasting, for each value in the array
	;		do a Shift-Left x leftCount
	;		then one more to handle the EOL
	;SendInput, {Left %len%}+{Right %len%}
}

resizeTo1x2_01() {
	extractLocationAndResize()
}

resizeTo1x2_02() {
	extractLocationAndResize()
}

resizeTo1x3_01() {
	extractLocationAndResize()
}

resizeTo1x3_02() {
	extractLocationAndResize()
}

resizeTo1x3_03() {
	extractLocationAndResize()
}

resizeTo1x4_01() {
	extractLocationAndResize()
}

resizeTo1x4_02() {
	extractLocationAndResize()
}

resizeTo1x4_03() {
	extractLocationAndResize()
}

resizeTo1x4_04() {
	extractLocationAndResize()
}

resizeTo2x1_01() {
	extractLocationAndResize()
}

resizeTo2x1_02() {
	extractLocationAndResize()
}

resizeTo2x2_01() {
	extractLocationAndResize()
}

resizeTo2x2_02() {
	extractLocationAndResize()
}

resizeTo2x2_03() {
	extractLocationAndResize()
}

resizeTo2x2_04() {
	extractLocationAndResize()
}

resizeTo2x3_01() {
	extractLocationAndResize()
}

resizeTo2x3_02() {
	extractLocationAndResize()
}

resizeTo2x3_03() {
	extractLocationAndResize()
}

resizeTo2x3_04() {
	extractLocationAndResize()
}

resizeTo2x3_05() {
	extractLocationAndResize()
}

resizeTo2x3_06() {
	extractLocationAndResize()
}

resizeTo2x4_01() {
	extractLocationAndResize()
}

resizeTo2x4_02() {
	extractLocationAndResize()
}

resizeTo2x4_03() {
	extractLocationAndResize()
}

resizeTo2x4_04() {
	extractLocationAndResize()
}

resizeTo2x4_05() {
	extractLocationAndResize()
}

resizeTo2x4_06() {
	extractLocationAndResize()
}

resizeTo2x4_07() {
	extractLocationAndResize()
}

resizeTo2x4_08() {
	extractLocationAndResize()
}

resizeTo3x1_01() {
	extractLocationAndResize()
}

resizeTo3x1_02() {
	extractLocationAndResize()
}

resizeTo3x1_03() {
	extractLocationAndResize()
}

resizeTo3x2_01() {
	extractLocationAndResize()
}

resizeTo3x2_02() {
	extractLocationAndResize()
}

resizeTo3x2_03() {
	extractLocationAndResize()
}

resizeTo3x2_04() {
	extractLocationAndResize()
}

resizeTo3x2_05() {
	extractLocationAndResize()
}

resizeTo3x2_06() {
	extractLocationAndResize()
}

resizeTo3x3_01() {
	extractLocationAndResize()
}

resizeTo3x3_02() {
	extractLocationAndResize()
}

resizeTo3x3_03() {
	extractLocationAndResize()
}

resizeTo3x3_04() {
	extractLocationAndResize()
}

resizeTo3x3_05() {
	extractLocationAndResize()
}

resizeTo3x3_06() {
	extractLocationAndResize()
}

resizeTo3x3_07() {
	extractLocationAndResize()
}

resizeTo3x3_08() {
	extractLocationAndResize()
}

resizeTo3x3_09() {
	extractLocationAndResize()
}

resizeTo3x4_01() {
	extractLocationAndResize()
}

resizeTo3x4_02() {
	extractLocationAndResize()
}

resizeTo3x4_03() {
	extractLocationAndResize()
}

resizeTo3x4_04() {
	extractLocationAndResize()
}

resizeTo3x4_05() {
	extractLocationAndResize()
}

resizeTo3x4_06() {
	extractLocationAndResize()
}

resizeTo3x4_07() {
	extractLocationAndResize()
}

resizeTo3x4_08() {
	extractLocationAndResize()
}

resizeTo3x4_09() {
	extractLocationAndResize()
}

resizeTo3x4_10() {
	extractLocationAndResize()
}

resizeTo3x4_11() {
	extractLocationAndResize()
}

resizeTo3x4_12() {
	extractLocationAndResize()
}

resizeTo4x1_01() {
	extractLocationAndResize()
}

resizeTo4x1_02() {
	extractLocationAndResize()
}

resizeTo4x1_03() {
	extractLocationAndResize()
}

resizeTo4x1_04() {
	extractLocationAndResize()
}

resizeTo4x2_01() {
	extractLocationAndResize()
}

resizeTo4x2_02() {
	extractLocationAndResize()
}

resizeTo4x2_03() {
	extractLocationAndResize()
}

resizeTo4x2_04() {
	extractLocationAndResize()
}

resizeTo4x2_05() {
	extractLocationAndResize()
}

resizeTo4x2_06() {
	extractLocationAndResize()
}

resizeTo4x2_07() {
	extractLocationAndResize()
}

resizeTo4x2_08() {
	extractLocationAndResize()
}

resizeTo4x3_01() {
	extractLocationAndResize()
}

resizeTo4x3_02() {
	extractLocationAndResize()
}

resizeTo4x3_03() {
	extractLocationAndResize()
}

resizeTo4x3_04() {
	extractLocationAndResize()
}

resizeTo4x3_05() {
	extractLocationAndResize()
}

resizeTo4x3_06() {
	extractLocationAndResize()
}

resizeTo4x3_07() {
	extractLocationAndResize()
}

resizeTo4x3_08() {
	extractLocationAndResize()
}

resizeTo4x3_09() {
	extractLocationAndResize()
}

resizeTo4x3_10() {
	extractLocationAndResize()
}

resizeTo4x3_11() {
	extractLocationAndResize()
}

resizeTo4x3_12() {
	extractLocationAndResize()
}

resizeTo4x4_01() {
	extractLocationAndResize()
}

resizeTo4x4_02() {
	extractLocationAndResize()
}

resizeTo4x4_03() {
	extractLocationAndResize()
}

resizeTo4x4_04() {
	extractLocationAndResize()
}

resizeTo4x4_05() {
	extractLocationAndResize()
}

resizeTo4x4_06() {
	extractLocationAndResize()
}

resizeTo4x4_07() {
	extractLocationAndResize()
}

resizeTo4x4_08() {
	extractLocationAndResize()
}

resizeTo4x4_09() {
	extractLocationAndResize()
}

resizeTo4x4_10() {
	extractLocationAndResize()
}

resizeTo4x4_11() {
	extractLocationAndResize()
}

resizeTo4x4_12() {
	extractLocationAndResize()
}

resizeTo4x4_13() {
	extractLocationAndResize()
}

resizeTo4x4_14() {
	extractLocationAndResize()
}

resizeTo4x4_15() {
	extractLocationAndResize()
}

resizeTo4x4_16() {
	extractLocationAndResize()
}

resizeToHeight() {
	extractLocationAndResize()
}

resizeToWidth() {
	extractLocationAndResize()
}

resizeWindow(width:=0, height:=0, title:="A", center:=true) {
	if (isSelf()) {
		splash("Cannot resize " . hs.TITLE . " windows...")
		return
	}
	origDelay := A_WinDelay
	SetWinDelay, 0
	WinGetPos, x, y, w, h, %title%
	width := (width < 1 ? w : width)
	height := (height < 1 ? h : height)
	WinMove, %title%,, %x%, %y%, %width%, %height%
	if (center) {
		centerWindow()
	}
	SetWinDelay, %origDelay%
	splash("Window resized to " . width . "x" . height . "...")
}

restoreHiddenWindows() {
	Loop, Parse, % hs.internal.hiddenWindows, |
	{
		WinShow, ahk_id %A_LoopField%
		WinActivate, ahk_id %A_LoopField%
	}
	hs.internal.hiddenWindows := ""
}


reverse(ByRef value) {
	if (isObject(value)) {
		clone := deepCopy(value)
		result := []
		size := getSize(value)
		if (size > 0) {
			Loop, % size {
				result.Push(clone.Pop())
			}
		}
	}
	else {
		valLen := StrLen(value)
		dataType := A_IsUnicode ? "UShort" : "UChar"
		dataLen := A_IsUnicode ? 2 : 1
		VarSetCapacity(result, valLen * dataLen, 0)
		while (A_Index <= valLen) {
			v := NumGet(value, (valLen - A_Index) * dataLen, dataType)
			NumPut(v, result, (A_Index - 1) * dataLen, dataType)
		}
		VarSetCapacity(result, -1)
	}
	return result
}

runAhkHelp() {
	hWnd := getHwnd("AutoHotkey Help")
	if (!hWnd) {
		SplitPath(A_AhkPath, , ahkPath)
		runTarget(ahkPath . "\AutoHotkey.chm")
		hWnd := getHwnd("AutoHotkey Help")
	}
	WinActivate, ahk_id %hWnd%
	WinWaitActive, ahk_id %hWnd%
	Send, !n
}

runCapture(command, includeStdErr:=false) {
	origIgnore := hs.internal.clipIgnore
	clipIgnore()
	redirect := " " . (includeStdErr ? "2>&1 " : "")
	cmd := ComSpec . " /c " . command . redirect . "| clip"
	RunWait, %cmd%,, Hide
	clipSleep()
	result := Trim(Clipboard, " `t`r`n")
	clipIgnore(origIgnore)
	return result
}

runDos(path:="") {
	dhw := A_DetectHiddenWindows
	DetectHiddenWindows, Off
	winArray := findWindows(group("Dos"))
	hWnd := ""
	for k, v in winArray {
		win := getWindowInfo("ahk_id " . v)
		if (RegexMatch(win.processName, "i)Bash")) {
			continue
		}
		hWnd := win.hWnd
		break
	}
	if (path == "" && hWnd && !isActiveDos()) {
		WinActivate, ahk_id %hWnd%
	}
	else {
		if (!FileExist(path)) {
			path := ""
		}
		if (path == "") {
			path := EnvGet("SystemDrive") . "\"
		}
		runTarget(ComSpec, path)
	}
	DetectHiddenWindows, % dhw
}

runEditor(file:="") {
	SplitPath(hs.config.user.editor, editorName, editorPath)
	regExe := "i)" . StrReplace(editorName, ".", "\.")
	hWnd := getHwnd("ahk_exe " . regExe)
	if (hWnd) {
		WinActivate, ahk_id %hWnd%
	}
	target := hs.config.user.editor
	if (FileExist(target) == "") {
		target := findOnPath(target)
	}
	if (target != "") {
		target := """" . target . """"
		if (file != "") {
			target .= " """ file . """"
		}
		runTarget(target)
	}
	else {
		message("Unable to locate the configured editor: " . hs.config.user.editor)
	}
}

runForum() {
	Run(hs.vars.url[hs.TITLE].forum)
}

runFunction(value:="", params*) {
	if (value == "") {
		funcName := trim(ask(hs.TITLE . " - Debug Function", "Enter the name of the function to execute:", 500))
	}
	else if (IsObject(value)) {
		message("Unable to run a function for type 'object'...", "Invalid parameter", 48)
		funcName := ""
	}
	if (funcName != "") {
		func := Func(funcName)
		if (func == 0) {
			message("'" . funcName . "' is not a known function.", "Error", 48)
		}
		else {
			try {
				msg := funcName . "() is: " . (func.IsBuiltIn ? "built-in" : "user-defined") . hs.const.EOL_WIN . hs.const.EOL_WIN
				if (func.minParams >= 1) {
					msg .= "Parameters: " . toString(params)
					result := func.Call(params*)
				}
				else {
					result := func.Call()
				}
				msg .= "Result: " . toString(result)
				output(msg)
			}
			catch e {
				message("Unable to execute the function: " . funcName . "`n`n" . e.Message, "Error", 48)
			}
		}
	}
}

runHistory() {
	Run(hs.vars.url[hs.TITLE].history)
}

runHomePage() {
	Run(hs.vars.url[hs.TITLE].home)
}

runHotScriptFolder() {
	runTarget("explore " . A_ScriptDir)
}

runQuickLookup() {
	text := getSelectedTextOrPrompt("Quick Lookup", "Enter a keyword or phrase...")
	text := Trim(text, (" `t" . hs.const.EOL_WIN))
	if (text != "") {
		text := urlEncode(text)
		menuDef := hs.config.user.quickLookupSites
		Loop, Parse, menuDef, % hs.const.EOL_NIX
		{
			if (Mod(A_Index, 2) == 1) {
				qtext := (A_LoopField == "-" ? "" : A_LoopField)
				Menu, qLookupMenu, Add, %qtext%, doQuickLookup
			}
		}
		Menu qlookupMenu, Color, FFFEE3
		Menu qlookupMenu, Show
		Menu qlookupMenu, Delete
	}
	return

	doQuickLookup:
		Loop, Parse, menuDef, % hs.const.EOL_NIX
		{
			if (A_ThisMenuItemPos * 2 == A_Index) {
				if (A_LoopField != "Cancel") {
					command := StrReplace(A_LoopField, "@selection@", text)
					Run(command)
					break
				}
			}
		}
		return
}

runSelectedText() {
	selText := getSelectedTextOrPrompt("Google Search or Goto", "Enter a keyword, phrase, url, or file path...")
	selText := Trim(selText, (" `t" . hs.const.EOL_WIN))
	if (selText != "") {
		if (isUrl(selText)) {
			if (!startsWith(selText, "http", true) && !startsWith(selText, "ftp", true) && !startsWith(selText, "www.", true)) {
				selText := "http://" . selText
			}
			Run(selText)
		}
		else {
			tmpPath := RegexReplace(selText, "/", "\")
			if (isFile(tmpPath) || isDirectory(tmpPath) || isUNC(tmpPath)) {
				Run(tmpPath)
			}
			else {
				searchText := urlEncode(selText)
				Run("https://www.google.com/search?q=" . searchText)
			}
		}
	}
}

runServices() {
	hWnd := getHwnd("Services")
	if (hWnd) {
		WinActivate, ahk_id %hWnd%
	}
	else {
		runTarget("services.msc")
	}
}

runTarget(target, workDir:="", activate:="") {
	pid := Run(target, workDir)
	if (pid != "") {
		if (activate != "") {
			WinWaitActive, %activate%,, 15
			if (ErrorLevel == 0) {
				pid := getHwnd()
			}
		}
	}
	return pid
}

runUserManual() {
	Run(hs.vars.url[hs.TITLE].userManual)
}

runWindowSpy() {
	ahkDir := RegRead("HKEY_LOCAL_MACHINE\SOFTWARE\AutoHotkey", "InstallDir")
;	 runTarget(ahkDir . "\AU3_Spy.exe")
	runTarget(ahkDir . "\WindowSpy.ahk")
}

saveConfig(config, defaultConfig:=-1) {
	file := config.file
	; always save these values
	IniWrite(config.file, "config", "version", hs.VERSION)
	if (defaultConfig == -1) {
		; save it, since nothing to compare against
		IniWrite(config.file, "config", "clipboard", whichClipboard())
		IniWrite(config.file, "config", "defaultHelpTab", config.defaultHelpTab)
		IniWrite(config.file, "config", "lastHelpTab", config.lastHelpTab)
		IniWrite(config.file, "config", "editor", config.editor)
		IniWrite(config.file, "config", "enableAutoStart", boolToStr(config.enableAutoStart))
		IniWrite(config.file, "config", "enableAutoUpdate", boolToStr(config.enableAutoUpdate))
		IniWrite(config.file, "config", "enableHkAutomation", boolToStr(config.enableHkAutomation))
		IniWrite(config.file, "config", "enableHkClipboard", boolToStr(config.enableHkClipboard))
		IniWrite(config.file, "config", "enableHkCommandLine", boolToStr(config.enableHkCommandLine))
		IniWrite(config.file, "config", "enableHkEpp", boolToStr(config.enableHkEpp))
		IniWrite(config.file, "config", "enableHkMisc", boolToStr(config.enableHkMisc))
		IniWrite(config.file, "config", "enableHkMouse", boolToStr(config.enableHkMouse))
		IniWrite(config.file, "config", "enableHkText", boolToStr(config.enableHkText))
		IniWrite(config.file, "config", "enableHkTransform", boolToStr(config.enableHkTransform))
		IniWrite(config.file, "config", "enableHkWindow", boolToStr(config.enableHkWindow))
		IniWrite(config.file, "config", "enableHsAlias", boolToStr(config.enableHsAlias))
		IniWrite(config.file, "config", "enableHsAutoCorrect", boolToStr(config.enableHsAutoCorrect))
		IniWrite(config.file, "config", "enableHsCode", boolToStr(config.enableHsCode))
		IniWrite(config.file, "config", "enableHsDates", boolToStr(config.enableHsDates))
		IniWrite(config.file, "config", "enableHsDos", boolToStr(config.enableHsDos))
		IniWrite(config.file, "config", "enableHsJira", boolToStr(config.enableHsJira))
		IniWrite(config.file, "config", "enableHsVariables", boolToStr(config.enableHsVariables))
		IniWrite(config.file, "config", "enableVersionCheck", boolToStr(config.enableVersionCheck))
		IniWrite(config.file, "config", "sortCase", boolToStr(config.sortCase))
		IniWrite(config.file, "config", "sortType", config.sortType)
		IniWrite(config.file, "config", "shiftWindowPixels", config.shiftWindowPixels)
		IniWrite(config.file, "jira", "panelFormat", config.jiraPanels.format)
		IniWrite(config.file, "jira", "panelFormatBlue", config.jiraPanels.formatBlue)
		IniWrite(config.file, "jira", "panelFormatGreen", config.jiraPanels.formatGreen)
		IniWrite(config.file, "jira", "panelFormatRed", config.jiraPanels.formatRed)
		IniWrite(config.file, "jira", "panelFormatYellow", config.jiraPanels.formatYellow)
		IniWrite(config.file, "options", "mySqlTransformRemainderToLower", boolToStr(config.options.mySqlTransformRemainderToLower))
		IniWrite(config.file, "options", "oracleTransformRemainderToLower", boolToStr(config.options.oracleTransformRemainderToLower))
		IniWrite(config.file, "options", "resolutions", arrayToList(config.options.resolutions, ","))
		IniWrite(config.file, "templates", "html", config.templates.html)
		IniWrite(config.file, "templates", "htmlKeys", config.templates.htmlKeys)
		IniWrite(config.file, "templates", "java", config.templates.java)
		IniWrite(config.file, "templates", "javaKeys", config.templates.javaKeys)
		IniWrite(config.file, "templates", "perl", config.templates.perl)
		IniWrite(config.file, "templates", "perlKeys", config.templates.perlKeys)
		IniWrite(config.file, "templates", "sql", config.templates.sql)
		IniWrite(config.file, "templates", "sqlKeys", config.templates.sqlKeys)
		saveQuickLookupSites(config)
		saveHotKeyDefs(config)
	}
	else {
		; compare current against default, saving only the values that are different
		saveOrDeleteSetting("config", "defaultHelpTab")
		saveOrDeleteSetting("config", "lastHelpTab")
		saveOrDeleteSetting("config", "editor")
		saveOrDeleteSetting("config", "enableAutoStart", true)
		saveOrDeleteSetting("config", "enableAutoUpdate", true)
		saveOrDeleteSetting("config", "enableHkAutomation", true)
		saveOrDeleteSetting("config", "enableHkClipboard", true)
		saveOrDeleteSetting("config", "enableHkCommandLine", true)
		saveOrDeleteSetting("config", "enableHkEpp", true)
		saveOrDeleteSetting("config", "enableHkMisc", true)
		saveOrDeleteSetting("config", "enableHkMouse", true)
		saveOrDeleteSetting("config", "enableHkText", true)
		saveOrDeleteSetting("config", "enableHkWindow", true)
		saveOrDeleteSetting("config", "enableHsAlias", true)
		saveOrDeleteSetting("config", "enableHsAutoCorrect", true)
		saveOrDeleteSetting("config", "enableHsCode", true)
		saveOrDeleteSetting("config", "enableHsDates", true)
		saveOrDeleteSetting("config", "enableHsDos", true)
		saveOrDeleteSetting("config", "enableHsVariables", true)
		saveOrDeleteSetting("config", "enableHsVersionCheck", true)
		saveOrDeleteSetting("config", "sortCase")
		saveOrDeleteSetting("config", "sortType")
		saveOrDeleteSetting("config", "shiftWindowPixels")
		; always save these values
		IniWrite(config.file, "config", "hkTotalCount" . hs.vars.uniqueId, config.hkTotalCount)
		IniWrite(config.file, "config", "hsTotalCount" . hs.vars.uniqueId, config.hsTotalCount)
		if (config.jiraPanels.format != defaultConfig.jiraPanels.format) {
			IniWrite(config.file, "jira", "panelFormat", config.jiraPanels.format)
		}
		if (config.jiraPanels.formatBlue != defaultConfig.jiraPanels.formatBlue) {
			IniWrite(config.file, "jira", "panelFormatBlue", config.jiraPanels.formatBlue)
		}
		if (config.jiraPanels.formatGreen != defaultConfig.jiraPanels.formatGreen) {
			IniWrite(config.file, "jira", "panelFormatGreen", config.jiraPanels.formatGreen)
		}
		if (config.jiraPanels.formatRed != defaultConfig.jiraPanels.formatRed) {
			IniWrite(config.file, "jira", "panelFormatRed", config.jiraPanels.formatRed)
		}
		if (config.jiraPanels.formatYellow != defaultConfig.jiraPanels.formatYellow) {
			IniWrite(config.file, "jira", "panelFormatYellow", config.jiraPanels.formatYellow)
		}
		saveOrDeleteSetting("options", "mySqlTransformRemainderToLower", true)
		saveOrDeleteSetting("options", "oracleTransformRemainderToLower", true)
		if (arrayToList(config.options.resolutions, ",") != arrayToList(defaultConfig.options.resolutions, ",")) {
			IniWrite(config.file, "options", "resolutions", arrayToList(config.options.resolutions, ","))
		}
		saveOrDeleteSetting("templates", "html")
		saveOrDeleteSetting("templates", "htmlKeys")
		saveOrDeleteSetting("templates", "java")
		saveOrDeleteSetting("templates", "javaKeys")
		saveOrDeleteSetting("templates", "perl")
		saveOrDeleteSetting("templates", "perlKeys")
		saveOrDeleteSetting("templates", "sql")
		saveOrDeleteSetting("templates", "sqlKeys")
		if (config.quickLookupSites != defaultConfig.quickLookupSites) {
			saveQuickLookupSites(config)
		}
		saveHotKeyDefs(config, defaultConfig)
	}
}

saveHotKeyDefs(config, defaultConfig:=false) {
	IniDelete(config.file, "hotKeys")
	for section, sectionValue in config.hotKeys {
		for key, keyValue in config.hotKeys[(section)] {
			doSave := false
			if (!defaultConfig) {
				doSave := true
			}
			else {
				defKeyValue := defaultConfig.hotKeys[(section)][(key)]
				if (keyValue != defKeyValue) {
					doSave := true
				}
			}
			if (doSave) {
				IniWrite(config.file, section, key, keyValue)
			}
		}
	}
}

saveOrDeleteSetting(section, value, isBoolean:=false) {
	isBoolean := toBool(isBoolean)
	isSame := (isBoolean ? boolToStr(hs.config.default[value]) == boolToStr(hs.config.user[value]) : hs.config.default[value] == hs.config.user[value])
	if (!isSame) {
		IniWrite(hs.config.user.file, section, value, (isBoolean ? boolToStr(hs.config.user[value]) : hs.config.user[value]))
	}
	else {
		IniDelete(hs.config.user.file, section, value)
	}
}

saveQuickLookupSites(config) {
	sites := config.quickLookupSites
	keyCount := 1
	key := ""
	IniDelete(config.file, "quickLookup")
	Loop, Parse, sites, % hs.const.EOL_NIX
	{
		value := Trim(A_LoopField)
		if (value != "") {
			key := "site" . keyCount . (endsWith(key, "Name") ? "URL" : "Name")
			IniWrite(config.file, "quickLookup", key, value)
			if (endsWith(key, "URL")) {
				keyCount++
			}
		}
	}
}

scrollWindow(direction, title:="A") {
	; see https://msdn.microsoft.com/en-us/library/windows/desktop/bb787577(v=vs.85).aspx
	if (equalsIgnoreCase(direction, "bottom")) {
		scroll := 7
	}
	else if (equalsIgnoreCase(direction, "down")) {
		scroll := 1
	}
	else if (equalsIgnoreCase(direction, "pgup")) {
		scroll := 2
	}
	else if (equalsIgnoreCase(direction, "pgdn")) {
		scroll := 3
	}
	else if (equalsIgnoreCase(direction, "top")) {
		scroll := 6
	}
	else if (equalsIgnoreCase(direction, "up")) {
		scroll := 0
	}
	control := ControlGetFocus("A")
	PostMessage, hs.const.WM.VSCROLL, % scroll, 0, % control, A
}

selectCurrentLine() {
	SendInput, {Home}+{Down}
	selText := getSelectedText()
	if (selText == "") {
		SendInput, {Home}+{End}
		selText := getSelectedText()
	}
	return selText
}

selectInExplorer(list) {
	if (isActiveExplorer()) {
		hWnd := getHwnd()
		for win in ComObjCreate("Shell.Application").Windows {
			if (win.hWnd != hWnd) {
				continue
			}
			win.Refresh()
			doc := win.Document
			items := doc.Folder.Items
			for item in items {
				doc.SelectItem(item, contains(item.Name, list))
			}
		}
	}
}

selectOnDesktop(list) {
	if (isActiveDesktop()) {
		shellWindows := ComObjCreate("Shell.Application").Windows
		VarSetCapacity(hWnd, 4, 0)
		desktop := shellWindows.FindWindowSW(0, "", 8, ComObj(0x4003, &hWnd), 1)
		doc := desktop.Document
		items := doc.SelectedItems
		Loop % items.Count {
			doc.SelectItem(items.Item(A_Index - 1), 0)
		}
		desktop.Refresh()
		items := doc.Folder.Items
		for item in items {
			doc.SelectItem(item, contains(item.Name, list))
		}
	}
}

selfReload(silent:=false) {
	if (!toBool(silent)) {
		splash("Reloading " . hs.TITLE . "...", 500)
	}
	Reload
}

sendText(text, keys:="", delay:="deprecated") {
	deprecatedParam("delay", delay)
	pasteText(text)
	if (keys != "") {
		SendInput, %keys%
	}
}

setActiveClipboard(name, update:=true) {
	if (startsWith(name, "Windows")) {
		hs.internal.isMultiClip := false
		hs.internal.isNumClip := false
	}
	else if (startsWith(name, "NumClip")) {
		hs.internal.isMultiClip := false
		hs.internal.isNumClip := true
		RegexMatch(name, "\d+", num)
		hs.internal.numClip := num
	}
	else if (startsWith(name, "MultiClip")) {
		hs.internal.isMultiClip := true
		hs.internal.isNumClip := false
		hs.internal.multiClipQueue := contains(name, "Queue")
	}
	else {
		message("Unknown clipboard: " . name)
		return
	}
	; always set the in-memory value
	hs.config.user.clipboard := name
	if (update) {
		IniWrite(hs.config.user.file, "config", "clipboard", name)
		splash("Setting current clipboard to " . name . "...")
	}
}

setCase(value, case) {
	StringUpper, case, case
	result := ""
	if (case == "I") {
		Loop, Parse, value
		{
			if is(A_LoopField, "upper") {
				result .= Chr(Asc(A_LoopField) + 32)
			}
			else if is(A_LoopField, "lower") {
				result .= Chr(Asc(A_LoopField) - 32)
			}
			else {
				result .= A_LoopField
			}
		}
	}
	else if (case == "L") {
		StringLower, result, value
	}
	else if (case == "S") {
		result := setCase(value, "L")
		result := RegExReplace(result, "((?:^|[.!?]\s+)[a-z])", "$u1")
		result := RegExReplace(result, "(\bi\b)", "$u1")
	}
	else if (case == "T") {
		StringUpper, result, value, T
	}
	else if (case == "U") {
		StringUpper, result, value
	}
	else {
		result := value
	}
	return result
}

setInputCue(hWnd, cue, showWhileFocused:=true) {
	DllCall("SendMessageW", "Ptr", hWnd, "Uint", hs.const.EM.SETCUEBANNER, "Ptr", showWhileFocused, "WStr", cue)
}

setLastUpdateCheck(date) {
	hs.config.user.lastUpdateCheck := date
	IniWrite(hs.config.user.file, "config", "lastUpdateCheck", hs.config.user.lastUpdateCheck)
}

setResolution(itemName, itemPos, menuName) {
	static savedWidth := ""
	static savedHeight := ""
	global customResWidth
	global customResHeight
	if (itemName != "") {
		itemName := StrReplace(itemName, "&", "")
		if (itemName == "Custom") {
			title := "Custom Resolution"
			activeMon := getMonitorForWindow()
			; TODO - replace this with formBuilder
			Gui, CustomRes: New,, %title%
			Gui, CustomRes: -MaximizeBox -MinimizeBox +LabelCustomRes_
			Gui, CustomRes: Margin, 5
			Gui, CustomRes: Add, Text, w240 y10 center section, To keep the current width or height,
			Gui, CustomRes: Add, Text, w240 y+1 center, leave the input value blank.
			Gui, CustomRes: Margin, 0
			Gui, CustomRes: Add, Text, x0 y+5 w245 h1 0x5
			Gui, CustomRes: Margin, 10
			Gui, CustomRes: Add, Text, xm+20 y+20 section w75 +right, New Width:
			Gui, CustomRes: Add, Text, w75 +right, New Height:
			Gui, CustomRes: Add, Edit, ys-3 w80 vcustomResWidth, %savedWidth%
			Gui, CustomRes: Add, Edit, w80 vcustomResHeight , %savedHeight%
			Gui, CustomRes: Margin, 0
			Gui, CustomRes: Add, Text, x0 y+15 w245 h1 0x5
			Gui, CustomRes: Add, Button, xm hwndokButtonHwnd gCustomRes_OK section default, &OK
			Gui, CustomRes: Add, Button, x+1 hwndcancelButtonHwnd gCustomRes_Escape, &Cancel
			centerControls(title, "CustomRes",,,, okButtonHwnd, cancelButtonHwnd)
			Gui, CustomRes: Show, autosize
			centerWindow(title, activeMon)
		}
		else {
			if (isSelf()) {
				splash("Cannot resize " . hs.TITLE . " windows...")
				return
			}
			newRes := listToArray(itemName, "x")
			;debug("newRes: " . toString(newRes))
			;resizeWindow(newRes[1], newRes[2],, false)
		}
	}
	return

	CustomRes_Escape:
		Gui, CustomRes: Cancel
		return

	CustomRes_OK:
		Gui, CustomRes: Submit
		if (isSelf()) {
			splash("Cannot resize " . hs.TITLE . " windows...")
			return
		}
		customResWidth := Trim(customResWidth)
		customResHeight := Trim(customResHeight)
		if (customResWidth != "" || customResHeight != "") {
			widthOK := RegexMatch(customResWidth, "^\d{1,5}$") && (customResWidth > 10)
			heightOK := RegexMatch(customResHeight, "^\d{1,5}$") && (customResHeight > 10)
			Sleep(100)
			WinGetPos, x, y, w, h, A
			if (customResWidth == "" && heightOK) {
				resizeWindow(w, customResHeight,, false)
				savedWidth := w
				savedheight := customResHeight
			}
			else if (customResHeight == "" && widthOK) {
				resizeWindow(customResWidth, h,, false)
				savedWidth := customResWidth
				savedheight := h
			}
			else if (widthOK && heightOK) {
				resizeWindow(customResWidth, customResHeight,, false)
				savedWidth := customResWidth
				savedheight := customResHeight
			}
		}
		return
}

setTransparency(increase:=true, hWnd:="") {
	MAX := 255
	MIN := 7
	hWnd := getHwnd(hWnd)
	WinGet, curTrans, Transparent, ahk_id %hWnd%
	if (!curTrans) {
		curTrans := MAX
	}
	newTrans := curTrans + (increase ? 8 : -8)
	if (newTrans > MAX) {
		newTrans := MAX
	}
	else if (newTrans < MIN) {
		newTrans := MIN
	}
	if (newTrans != curTrans) {
		WinGetTitle, currentTitle, ahk_id %hWnd%
		newTitle := RegExReplace(currentTitle, hs.const.MARKER.transparent . "\(\d{1,3}%\) ")
		WinSet, Transparent, %newTrans%, ahk_id %hWnd%
		if (newTrans < MAX) {
			percent := Round((newTrans / MAX) * 100)
			newTitle := hs.const.MARKER.transparent . "(" . percent . "%) " + newTitle
		}
		WinSetTitle, ahk_id %hWnd%, , %newTitle%
	}
}

shiftWindow(direction, hWnd:="", pixels:=-1) {
	origDelay := A_WinDelay
	SetWinDelay, 0
	hWnd := getHwnd(hWnd)
	curMon := hs.vars.monitors[getMonitorForWindow()]
	WinGetPos, WinX, WinY, WinW, WinH, ahk_id %hWnd%
	if (!is(pixels, "number") || pixels < 0) {
		pixels := hs.config.user.shiftWindowPixels
	}
	direction := setCase(direction, "L")
	if (direction == "d" || direction == "down") {
		bottom := (WinY + WinH)
		workBottom := curMon.workBottom
		if (isWin10()) {
			workBottom += 6
		}
		if ((bottom + pixels) < workBottom || bottom >= workBottom) {
			diff := pixels
		}
		else {
			diff := (workBottom - bottom)
		}
		newX := WinX
		newY := (WinY + diff)
	}
	else if (direction == "l" || direction == "left") {
		left := WinX
		workLeft := curMon.workLeft
		if (isWin10()) {
			workLeft -= 7
		}
		if ((left - pixels) > workLeft || left <= workLeft) {
			diff := pixels
		}
		else {
			diff := (left - workLeft)
		}
		newX := (left - diff)
		newY := WinY
	}
	else if (direction == "r" || direction == "right") {
		right := (WinX + WinW)
		workRight := curMon.workRight
		if (isWin10()) {
			workRight += 7
		}
		if ((right + pixels) < workRight || right >= workRight) {
			diff := pixels
		}
		else {
			diff := (workRight - right)
		}
		newX := (WinX + diff)
		newY := WinY
	}
	else {
		top := WinY
		workTop := curMon.workTop
		if ((top - pixels) > workTop || top <= workTop) {
			diff := pixels
		}
		else {
			diff := (top - workTop)
		}
		newX := WinX
		newY := (top - diff)
	}
	WinMove, ahk_id %hWnd%,, newX, newY, winW, winH
	SetWinDelay, %origDelay%
}

quickHelpMove(direction) {
	SendMessage, 0x1304,,, SysTabControl321
	tabCount := ErrorLevel
	ControlGet, curTab, Tab,, SysTabControl321
	newTab := (curTab + direction)
	if (newTab < 1) {
		newTab := tabCount
	}
	else if (newTab > tabCount) {
		newTab := 1
	}
	quickHelpTab(newTab)
}

quickHelpNext() {
	quickHelpMove(1)
}

quickHelpPrev() {
	quickHelpMove(-1)
}

quickHelpTab(newTab) {
	SendMessage, 0x1304,,, SysTabControl321
	tabCount := ErrorLevel
	if (newTab > tabCount) {
		newTab := tabCount
	}
	if (newTab > 0) {
		; SendMessage is zero based, so subtract one
		newTab--
		SendMessage, 0x1330, %newTab%,, SysTabControl321
	}
}

quickHelpTab0() {
	quickHelpTab(10)
}

quickHelpTab1() {
	quickHelpTab(1)
}

quickHelpTab2() {
	quickHelpTab(2)
}

quickHelpTab3() {
	quickHelpTab(3)
}

quickHelpTab4() {
	quickHelpTab(4)
}

quickHelpTab5() {
	quickHelpTab(5)
}

quickHelpTab6() {
	quickHelpTab(6)
}

quickHelpTab7() {
	quickHelpTab(7)
}

quickHelpTab8() {
	quickHelpTab(8)
}

quickHelpTab9() {
	quickHelpTab(9)
}

closeQuickHelp() {
	Gui, QuickHelp: Hide
	hs.config.user.lastHelpTab := ControlGet("Tab",, "SysTabControl321")
	IniWrite(hs.config.user.file, "config", "lastHelpTab", hs.config.user.lastHelpTab)
}

showQuickHelp() {
	static helpTab, htmlHK, htmlHS, htmlVar, contentHK, contentHS
	static htmlUser1, htmlUser2, htmlUser3, htmlUser4, htmlUser5, htmlUser6, htmlUser7, htmlUser8, htmlUser9, htmlUser10
	static htmlUser11, htmlUser12, htmlUser13, htmlUser14, htmlUser15, htmlUser16, htmlUser17, htmlUser18, htmlUser19, htmlUser20
	static htmlUser21, htmlUser22, htmlUser23, htmlUser24, htmlUser25, htmlUser26, htmlUser27, htmlUser28, htmlUser29, htmlUser30
	static htmlUser31, htmlUser32, htmlUser33, htmlUser34, htmlUser35, htmlUser36, htmlUser37, htmlUser38, htmlUser39, htmlUser40
	static htmlUser41, htmlUser42, htmlUser43, htmlUser44, htmlUser45, htmlUser46, htmlUser47, htmlUser48, htmlUser49, htmlUser50
	static maxCustomTabs := 50
	static isShowing := false
	static isCreating := true
	static defaultTab, helpWidth, helpHeight, tabControlWidth, tabControlHeight, tabWidth, tabHeight, tabOpt

	if (isCreating) {
		defaultTab := hs.config.user.defaultHelpTab
		lastTab := hs.config.user.lastHelpTab
		helpWidth := hs.help.width
		helpHeight := hs.help.height
		tabControlWidth := (helpWidth + 7)
		tabControlHeight := (helpHeight - 3)
		tabWidth := helpWidth
		tabHeight := (helpHeight - 20)
		tabOpt := "x0 y0 w" . tabWidth . " h" . tabHeight
		contentHK := getHelpContentHotKeys()
	}
	if (isShowing) {
		KeyWait("h")
		closeQuickHelp()
		isShowing := false
		return
	}

	activeMon := getMonitorForWindow()
	contentHS := getHelpContentHotStrings()
	contentVar := getHelpContentVariables()
	if (IsFunc("getUserHelpTabs")) {
		customTabs := Func("getUserHelpTabs").()
		if (customTabs.MaxIndex() > maxCustomTabs) {
			message("Too many (" . customTabs.MaxIndex() . ") user-defined tabs returned by: getUserHelpTabs()", "Limit Exceeded", 48)
		}
	}
	else {
		customTabs := []
		customTabs.push({name: "User", content: StrReplace(getHelpCommon(), "{content}", getHelpContentCustom())})
	}
	customTabNames := "HotKeys|HotStrings|Variables"
	for i, tab in customTabs {
		customTabNames .= "|" . tab.name
	}

	if (isCreating) {
		tabNum := 1
		chosenTab := "choose" . (defaultTab == "" ? lastTab : defaultTab)
		Gui, QuickHelp: New, +Border -Caption, % hs.help.title
		Gui, QuickHelp: Add, Tab2, x0 y0 w%tabControlWidth% h%tabControlHeight% bottom -wrap vhelpTab %chosenTab%, %customTabNames%
		Gui, QuickHelp: Tab, % tabNum++
		Gui, QuickHelp: Add, ActiveX, %tabOpt% vhtmlHK, HtmlFile
		Gui, QuickHelp: Tab, % tabNum++
		Gui, QuickHelp: Add, ActiveX, %tabOpt% vhtmlHS, HtmlFile
		Gui, QuickHelp: Tab, % tabNum++
		Gui, QuickHelp: Add, ActiveX, %tabOpt% vhtmlVar, HtmlFile
		for i, tab in customTabs {
			if (i <= maxCustomTabs) {
				Gui, QuickHelp: Tab, % tabNum++
				Gui, QuickHelp: Add, ActiveX, %tabOpt% vhtmlUser%i%, HtmlFile
			}
		}
		Gui, QuickHelp: Color, FFD392
		writeHelpContent(htmlHK, contentHK)
	}
	else if (defaultTab != "") {
		GuiControl, QuickHelp:Choose, helpTab, % defaultTab
	}
	writeHelpContent(htmlHS, contentHS)
	writeHelpContent(htmlVar, contentVar)
	for i, tab in customTabs {
		if (i <= maxCustomTabs) {
			tabVar := "htmlUser" . i
			writeHelpContent(%tabVar%, tab.content)
		}
	}

	Gui, QuickHelp: Show, x-10000 y-10000
	Gui, QuickHelp: Show, Center w%helpWidth% h%helpHeight%
	centerWindow(, activeMon)
	isCreating := false
	isShowing := true
	return

	QuickHelpGuiEscape:
		closeQuickHelp()
		isShowing := false
		return
}

splash(msg, timeout:=1000, width:=400) {
	title := hs.TITLE . "Splash"
	Progress("B1 CT000000 CWFFA7A3 FS12 W" . width . " ZH0", msg, "", title)
	centerWindow(title)
	Sleep(timeout)
	Progress("off")
}

showVariable(value:="") {
	type := "Parameter"
	if (!IsObject(value) && value == "") {
		varName := trim(ask(hs.TITLE . " - Debug Variable", "Enter the name of the variable to inspect:", 500))
		if (varName == "") {
			return
		}
		try {
			value := getVar(varName)
		}
		catch e {
			message(e.Message, "Unable to show variable", 48)
			return
		}
		type := varName
	}
	output(type . " = " . toString(value))
}

showWindow(title:="") {
	hWnd := getHwnd(title)
	if (hWnd != "") {
		WinShow, ahk_id %A_LoopField%
	}
}

showWindowInfo(hWnd:="") {
	static fixedFont := new Font().name("Consolas").size(11)
	hWnd := getHwnd(hWnd)
	if (!hWnd) {
		return
	}
	win := getWindowInfo(hWnd)
	maxLen := StrLen(win.processPath)
	if (maxLen < StrLen(win.title)) {
		maxLen := StrLen(win.title)
	}
	position := "top  : " . win.y . "`tbottom: " . (win.y + win.height) . "`tleft: " . win.x . "`tright: " . (win.x + win.width)
	if (maxLen < StrLen(position)) {
		maxLen := StrLen(position)
	}
	maxLen := (maxLen < 75 ? 75 : maxLen + 18)
	line := repeatStr(Chr(0x2500), maxLen)

	WinGet, ExStyle, ExStyle, ahk_id %hWnd%
	alwaysOnTop := (ExStyle & 0x8 ? "on" : "off")
	clickThrough := (ExStyle & 0x20 ? "on" : "off")
	WinGet, transparent, Transparent, ahk_id %hWnd%
	if (is(transparent, "number") && transparent < 255) {
		transPercent := Round((transparent / 255) * 100)
		transparent := "on"
	}
	else {
		transparent := "off"
		transPercent := 0
	}
	classLen := StrLen(win.class)

	dpiRes := getDpiResolution(win.width, win.height)
	dpi := (dpiRes.factor * 100) . "% (" . dpiRes.width . "x" . dpiRes.height . ")"

	info := "
	(LTrim
		Resolution      : width: " win.width "`theight: " win.height "`tDPI: " dpi "
		Coordinates     : x    : " win.x "  `ty     : " win.y "
		Position        : " position "
		Window State    : " win.state "
		Monitor #       : " win.monitor "
		" line "
		Title           : " win.title "
		Executable      : " win.processPath "
		" line "
		hWnd            : " pad(win.hWnd, classLen) "`tAlways-on-Top   : " alwaysOnTop "
		Process ID      : " pad(win.pid, classLen) "`tClick-Through   : " clickThrough "
		Class           : " pad(win.class, classLen) "`tTransparent     : " transparent " (" transPercent "%)
		Style           : " pad(win.style, classLen) "
		ExStyle         : " pad(win.exStyle, classLen) "
		" line "
		isAppWindow     : " boolToStr(win.isAppWindow) "`t`t`tisAltPasteGroup     : " boolToStr(isActiveAltPaste()) "
		isChild         : " boolToStr(win.isChild) "`t`t`tisApiPasteGroup     : " boolToStr(isActiveApiPaste()) "
		isControlParent : " boolToStr(win.isControlParent) "`t`t`tisBrowserGroup      : " boolToStr(isActiveBrowser()) "
		isDisabled      : " boolToStr(win.isDisabled) "`t`t`tisCalculatorGroup   : " boolToStr(isActiveCalculator()) "
		isHung          : " boolToStr(win.isHung) "`t`t`tisCommandLineGroup  : " boolToStr(isActiveCommandLine()) "
		isPopup         : " boolToStr(win.isPopup) "`t`t`tisDesktopGroup      : " boolToStr(isActiveDesktop()) "
		isSuspended     : " boolToStr(win.isSuspended) "`t`t`tisDialogGroup       : " boolToStr(isActiveDialog()) "
		isToolWindow    : " boolToStr(win.isToolWindow) "`t`t`tisDosGroup          : " boolToStr(isActiveDos()) "
		isVisible       : " boolToStr(win.isVisible) "`t`t`tisDosLikeGroup      : " boolToStr(isActiveDosLike()) "
		`t`t`t`t`tisBlacklistAllGroup : " boolToStr(isActiveBlacklistAll()) "
		`t`t`t`t`tisBlacklistHKGroup  : " boolToStr(isActiveBlacklistHK()) "
		`t`t`t`t`tisBlacklistHSGroup  : " boolToStr(isActiveBlacklistHS()) "
		`t`t`t`t`tisExplorerGroup     : " boolToStr(isActiveExplorer()) "
		`t`t`t`t`tisMSExcelGroup      : " boolToStr(isActiveMSExcel()) "
		`t`t`t`t`tisMSWordGroup       : " boolToStr(isActiveMSWord()) "
		`t`t`t`t`tisNixGroup          : " boolToStr(isActiveNix()) "
		`t`t`t`t`tisPowerShellGroup   : " boolToStr(isActivePowerShell()) "
		`t`t`t`t`tisRdpGroup          : " boolToStr(isActiveRdp()) "
		`t`t`t`t`tisShellGroup        : " boolToStr(isActiveShell()) "
		`t`t`t`t`tisSshGroup          : " boolToStr(isActiveSsh()) "
		`t`t`t`t`tisUbuntuGroup       : " boolToStr(isActiveUbuntu()) "
	)"

	wiField := new FormField("text").textSpan().label(info . A_SPACE).inputFont(fixedFont)
	wiForm := new Form().addField(wiField).vertical().title("Window Information").noButtons()
	buildForm(wiForm)
}

sortByValue(arr, ignoreCase:=true) {
	valueArr := {}
	for key, value in arr {
		valueArr[RegExReplace(value, "\s")] := value
	}
	sortedArr := {}
	for key, value in valueArr {
		sortedArr[A_Index] := value
	}
	return sortedArr
}

sortSelected(direction:="") {
	selText := getSelectedText()
	if (selText != "") {
		if (isSortNatural()) {
			Sort(selText, "F compareStr" . (equalsIgnoreCase(direction, "d") ? "Desc" : "Asc") . (hs.config.user.sortCase ? "" : "NoCase"))
		}
		else if (isSortASCII()) {
			Sort(selText, (equalsIgnoreCase(direction, "d") ? "R" : "") . " " . (hs.config.user.sortCase ? "C" : ""))
		}
		else {
			Sort(selText, "Random " . (hs.config.user.sortCase ? "C" : ""))
		}
		replaceSelected(selText)
	}
}

startsWith(str, value, caseInsensitive:="") {
	if (toBool(caseInsensitive)) {
		str := setCase(str, "L")
		value := setCase(value, "L")
	}
	return (SubStr(str, 1, StrLen(value)) == value)
}

stop() {
	hkSession := toComma(hs.config.user.hkSessionCount)
	hkTotal := toComma(hs.config.user.hkTotalCount)
	hsSession := toComma(hs.config.user.hsSessionCount)
	hsTotal := toComma(hs.config.user.hsTotalCount)
	msg := "Shutting down...`n`nSession Usage`n    HotKeys: " . hkSession . "`n    HotStrings: " . hsSession . "`n`nTotal Usage`n    HotKeys: " . hkTotal . "`n    HotStrings: " . hsTotal
	message(msg, hs.VERSION)
	ExitApp
}

strCount(str, find, isRegex:=false, caseSensitive:=true) {
	RegExReplace(str, (caseSensitive ? "" : "i)") . (isRegex ? "" : "\Q") . find . (isRegex ? "" : "\E"),, count)
	return count
}

stretchToEdge(direction, hWnd:="") {
	if (isSelf()) {
		splash("Cannot resize " . hs.TITLE . " windows...")
		return
	}
	origDelay := A_WinDelay
	SetWinDelay, 0
	direction := Trim(setCase(direction, "L"))
	win := getWindowInfo(hWnd)
	hWnd := win.hWnd
	mon := hs.vars.monitors[win.monitor]
	if (direction == "top") {
		newX := win.x
		newY := mon.workTop
		newH := (win.height + (win.y - mon.workTop))
		newW := win.width
	}
	else if (direction == "bottom") {
		newX := win.x
		newY := win.y
		newH := (mon.workBottom - win.y)
		newW := win.width
	}
	else if (direction == "left") {
		newX := mon.workLeft
		newY := win.y
		newH := win.height
		newW := (win.width + (win.x - mon.workLeft))
	}
	else if (direction == "right") {
		newX := win.x
		newY := win.y
		newH := win.height
		newW := (mon.workRight - win.x)
	}
	else {
		return
	}
	if (isWin10()) {
		if (direction == "left") {
			newX += -7
			newW += 7
		}
		else if (direction == "right") {
			newW += 6
		}
		else if (direction == "bottom") {
			; one less because otherwise it is impossible to reach the resize area of the window because the taskbar overlaps
			; TODO - this only works if the taskbar is at the bottom
			; more work needs to be done if the taskbar is on the left, right, or top
			; is it possible to detect where the taskbar is?
			; it seems so - class = "Shell_TrayWnd", then look at x,y,h,w (mine is w: 4096, height: 40, x: 0, y: 2120)
			newH += 6
		}
	}
	WinMove, ahk_id %hWnd%,, %newX%, %newY%, %newW%, %newH%
	SetWinDelay, %origDelay%
}

stripEol(str) {
	str := StrReplace(str, hs.const.EOL_MAC , "")
	str := StrReplace(str, hs.const.EOL_NIX , "")
	return str
}

tagifySelected() {
	selText := getSelectedText()
	if (selText == "") {
		SendInput, ^{Left}^+{Right}
		selText := getSelectedText()
	}
	if (selText != "") {
		isTagged := startsWith(selText, "<") && endsWith(selText, ">")
		if (isTagged) {
			pasteText(RegExReplace(selText, "(<[^>]+>)", ""))
		}
		else {
			moveLeft := "{Left " . (StrLen(selText) + 3) . "}"
			sendText("<" . selText . "></" . selText . ">", moveLeft)
		}
	}
}

templateHtml() {
	tmpl := new Template().text(FileRead(hs.config.user.templates.html)).keys(hs.config.user.templates.htmlKeys)
	if (tmpl._text == "") {
		text = `
		(Join`r`n
			<!DOCTYPE html>
			<html lang='en'>
				<head>
					<meta charset='UTF-8'/>
					<title>Quick HTML template</title>
					<style>
						table {
							border-collapse: collapse;
							margin-top: 20px;
						}
						table, td, th {
							border: 1px solid black;
						}
						tr:nth-child(even) {
							background: #c2d8f0;
						}
						tr:nth-child(odd) {
							background: #bbdabe;
						}
						tr:first-child {
							background: #dfc7c7;
						}
						td, th {
							padding: 10px;
						}
					</style>
				</head>
				<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
				<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
				<script>
					function test() {
						//
					}
				</script>
			<body>
				<h2>This is a simple HTML template. (generated by HotScript)</h2>
				<input type='button' value='Test' onclick='test()'/>
				<table>
					<tr>
						<th>Header 1</th>
						<th>Header 2</th>
						<th>Header 3</th>
					</tr>
					<tr>
						<td>C1-1</td>
						<td>C1-2</td>
						<td>C1-3</td>
					</tr>
					<tr>
						<td>C2-1</td>
						<td>C2-2</td>
						<td>C2-3</td>
					</tr>
					<tr>
						<td>C3-1</td>
						<td>C3-2</td>
						<td>C3-3</td>
					</tr>
				</table>
			</body>
			</html>

		)
		tmpl.text(text)
			.keys("{Up 3}{End}{Home}")
			.cutLeft(12)
			.linePrefix(getIndent())
			.trimRight()
	}
	pasteTemplate(tmpl)
}

templateJava() {
	tmpl := new Template().text(FileRead(hs.config.user.templates.java)).keys(hs.config.user.templates.javaKeys)
	if (tmpl._text == "") {
		text = `
		(Join`r`n
			import java.io.*;
			import java.util.*;

			public class Template {
				public static void main(String[] args) {
					System.out.println("This is a simple Java template. (generated by HotScript)");
				}
			}

		)
		tmpl.text(text)
			.keys("{Up 3}{End}{Home}")
			.cutLeft(12)
			.linePrefix(getIndent())
			.trimRight()
	}
	pasteTemplate(tmpl)
}

templatePerl() {
	tmpl := new Template().text(FileRead(hs.config.user.templates.perl)).keys(hs.config.user.templates.perlKeys)
	if (tmpl._text == "") {
		text = `
		(Join`r`n
			use strict;
			use warnings;
			use File::Basename;
			use File::Basename qw(dirname);
			use File::Cwd;
			use File::Cwd qw(abs_path);
			use File::Find;
			use File::Path;
			use File::Spec;
			use Getopt::Std;
			use IO::Handle qw(); # for flush
			use POSIX qw/strftime/;
			use Sys::Hostname;

			# ----------------------------------------------------------------------
			#  Constants
			# ----------------------------------------------------------------------
			my $EXIT_OK = 0;
			my $EXIT_GENERIC = 1;
			my $LOG_LINE = "----------------------------------------------------------------------";
			my $LOG_NAME = substr($0, 0, -3) . ".log";

			# ----------------------------------------------------------------------
			#  Variables
			# ----------------------------------------------------------------------
			my $doDebug = 0;

			# ----------------------------------------------------------------------
			#  Main
			# ----------------------------------------------------------------------
			init();

			# ----------------------------------------------------------------------
			# Functions
			# ----------------------------------------------------------------------
			sub debug {
				if ($doDebug) {
					logg($_[0]);
				}
			}

			sub dieCommon {
				my $logPath = File::Spec->rel2abs($LOG_NAME);
				my $msg = $_[0];
				my $exitCode = $EXIT_GENERIC;
				my $newCode = $_[1];
				if (defined($newCode)) {
					$exitCode = $newCode;
				}
				logg("$msg\n\nRefer to $logPath for more information.");
				exit $exitCode;
			}

			sub init {
				open(LOG, ">>$LOG_NAME") || dieCommon("Could not open log file: $LOG_NAME - $!");
				STDOUT->autoflush(1);
			}

			sub logg {
				print LOG $_[0]."\n";
				print $_[0]."\n";
			}

			sub now {
				return strftime('`%m/`%d/`%Y at `%H:`%M:`%S', localtime);
			}

			sub readFile {
				my $file = $_[0];
				my $contents = "";
				open("output", "<$file") || dieCommon("Unable to read file: $file - $!");
				chomp($contents = do { local $/; <output> });
				close("output");
				return $contents;
			}

			sub readProperties {
				my $propFile = $_[0];
				open my $in, "$propFile" or dieCommon("Unable to read properties from: $propFile - $!");
				my `%propMap;
				my `%tmpMap;
				for (<$in>) {
					#skip comment lines
					next if /^[\s]*#/;
					$tmpMap{$1}=$2 while m/([^=]*)(?:\s*?=\s*?)(.*)/g;
					if (defined $1 && $1 ne '') {
						my $name = trim($1);
						my $value = trim($2);
						$propMap{$name}=$value;
					}
				}
				close $in;
				return $propMap;
			}

			sub replace {
				my $str = $_[0];
				my $find = $_[1];
				my $replace = $_[2];
				$str ~= s/$find/$replace/g;
				return $str;
			}

			sub showMap {
				my $map = $_[0];
				my $key;
				my $value;
				while (($key, $value) = each($map)) {
					print "\t[".$key."] = [".$value."]\n";
				}
			}

			sub trace {
				my $caller = (caller(1))[3];
				my $now = now();
				if ($[0] == 1) {
					debug("$LOG_LINE\nBEGIN: $caller - $now");
				}
				else {
					debug("END: $caller - $now\n$LOG_LINE");
				}
			}

			sub trim {
				my $str = $_[0];
				$str ~= s/^\s+//;
				$str ~= s/\s+$//;
				return $str;
			}

		)
		tmpl.text(text)
			.keys("^{Home}")
			.cutLeft(12)
			.linePrefix(getIndent())
			.trimRight()
	}
	pasteTemplate(tmpl)
}

templateSql() {
	tmpl := new Template().text(FileRead(hs.config.user.templates.sql)).keys(hs.config.user.templates.sqlKeys)
	if (tmpl._text == "") {
		text = `
		(Join`r`n
			-- ----------------------------------------------------------------------
			-- This is a simple SQL template. (generated by HotScript)
			-- ----------------------------------------------------------------------
			SELECT *
			FROM%A_Space%
			WHERE

		)
		tmpl.text(text)
			.keys("{Up 2}{End}")
			.cutLeft(12)
			.linePrefix(getIndent())
	}
	pasteTemplate(tmpl)
}

toBool(value) {
	static trueList := "1,active,enabled,on,t,true,y,yes"
	value := Trim(setCase(value, "L"))
	result := false
	if (is(value, "Number") && value != 0) {
		result := true
	}
	else if value in %trueList%
	{
		result := true
	}
	return result
}

toComma(value) {
	value := RegExReplace(value, "(\d)(?=(?:\d{3})+(?:\.|$))", "$1,")
;	 value := RegExReplace(value, "[1-9](?:\d{0,2})((?:,\d{3})*)(?:\.\d*[0-9])?|0?\.\d*[0-9]|0", "$1,")
	return value
}

toggleAlwaysOnTop(hWnd:="") {
	hWnd := getHwnd(hWnd)
	WinGet, ExStyle, ExStyle, ahk_id %hWnd%
	; always-on-top
	currentModeAoT := (ExStyle & 0x8 ? "on" : "off")
	; click--through
	currentModeCT := (ExStyle & 0x20 ? "on" : "off")
	newState := (currentModeAoT == "off" ? "on" : currentModeCT)

	; remove any existing markers
	WinGetTitle, newTitle, ahk_id %hWnd%
	newTitle := StrReplace(newTitle, hs.const.MARKER.always_on_top)
	newTitle := StrReplace(newTitle, hs.const.MARKER.click_through)

	; force click-through to be turned off
	WinSet, ExStyle, -0x20, ahk_id %hWnd%

	WinSet, AlwaysOnTop, %newState%, ahk_id %hWnd%
	if (newState == "on") {
		newTitle := hs.const.MARKER.always_on_top . newTitle
	}
	else {
		WinSet, Transparent, 255, ahk_id %hWnd%
	}
	WinSetTitle, ahk_id %hWnd%, , %newTitle%
	splash("'Always-on-top' mode is " . newState . "...")
}

toggleClickThrough(hWnd:="") {
	hWnd := getHwnd(hWnd)
	WinGet, ExStyle, ExStyle, ahk_id %hWnd%
	currentModeAoT := (ExStyle & 0x8 ? "on" : "off")
	currentModeCT := (ExStyle & 0x20 ? "on" : "off")
	newState := (currentModeCT == "off" ? "on" : "off")

	; remove any existing markers
	WinGetTitle, newTitle, ahk_id %hWnd%
	newTitle := StrReplace(newTitle, hs.const.MARKER.always_on_top)
	newTitle := StrReplace(newTitle, hs.const.MARKER.click_through)

	if (newState == "on") {
		WinSet, Transparent, 127, ahk_id %hWnd%
		WinSet, ExStyle, +0x20, ahk_id %hWnd%
		WinSet, AlwaysOnTop, on, ahk_id %hWnd%
		; 50% transparent
		newTitle := hs.const.MARKER.click_through . newTitle
	}
	else {
		WinSet, ExStyle, -0x28, ahk_id %hWnd%
		WinSet, AlwaysOnTop, off, ahk_id %hWnd%
		WinSet, Transparent, 255, ahk_id %hWnd%
	}
	WinSetTitle, ahk_id %hWnd%, , %newTitle%
	splash("'Click-through' mode is " . newState . "...")
}

toggleDesktopIcons() {
	hWnd := ControlGet("hWnd", "", "SysListView321", "ahk_class Progman")
	if (hWnd == "") {
		hWnd := ControlGet("hWnd", "", "SysListView321", "ahk_class WorkerW")
	}
	if (isWindowVisible(hWnd)) {
		WinHide, ahk_id %hWnd%
	}
	else {
		WinShow, ahk_id %hWnd%
	}
}

toggleMinimized() {
	static allMinimized := false
	static lastWindow
	if (allMinimized) {
		WinMinimizeAllUndo
		Sleep(100)
		WinActivate, ahk_id %lastWindow%
	}
	else {
		lastWindow := getHwnd()
		WinMinimizeAll
	}
	allMinimized := !allMinimized
}

toggleTransparency(hWnd:="") {
	hWnd := getHwnd(hWnd)
	WinGet, curTrans, Transparent, ahk_id %hWnd%
	WinGetTitle, currentTitle, ahk_id %hWnd%
	if (curTrans) {
		WinSet, Transparent, off, ahk_id %hWnd%
		newTitle := RegExReplace(currentTitle, hs.const.MARKER.transparent . "\(\d{1,3}%\) ")
	}
	else {
		WinSet, Transparent, 127, ahk_id %hWnd%
		newTitle := hs.const.MARKER.transparent . "(50%) " + currentTitle
	}
	WinSetTitle, ahk_id %hWnd%, , %newTitle%
}

toHex(value, width:=0, lower:=false) {
	origFormat := A_FormatInteger
	SetFormat, Integer, Hex
	value += 0
	SetFormat, Integer, %origFormat%
	if (width > 0) {
		value := pad(SubStr(value, 3), width, "0", "L")
	}
	if (toBool(lower)) {
		value := setCase(value, "L")
	}
	return value
}

toSafeName(value) {
	return RegExReplace(value, "[\``\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\[\]\{\}\\\|\;\:\'\""\,\.\<\>\/\?\s\t\r\n]", "")
}

toString(obj, depth:=0, indent:="") {
	result := ""
	if (IsFunc(obj)) {
		result := "function " . (IsObject(obj) ? obj.name : obj) . "()"
	}
	else if (IsLabel(obj)) {
		result := "label " . obj.name . ":"
	}
	else if (IsObject(obj)) {
		keyWidth := 1
		for key, value in obj {
			tmpWidth := StrLen(key)
			if (tmpWidth > keyWidth) {
				keyWidth := tmpWidth
			}
		}
		pad := indent . hs.const.INDENT
		for key, value in obj {
			result .= (depth == 0 && StrLen(result) == 0 && getSize(obj) > 0 ? hs.const.EOL_WIN : "") . pad
			if (IsFunc(value)) {
				result .= pad(key, keyWidth) . " = <" . (isObject(value) ? value.name : value) . "> --> function()" . hs.const.EOL_WIN
			}
			else if (IsLabel(value)) {
				result .= pad(key, keyWidth) . " --> label " . value . ":" . hs.const.EOL_WIN
			}
			else if (IsObject(value)) {
				valStr := toString(value, depth + 1, pad)
				if (isDictionary(value) || isArray(value)) {
					ob := "["
					cb := "]"
				}
				else {
					ob := "{"
					cb := "}"
				}
				result .= key . " = " . ob . (valStr == "" ? "" : hs.const.EOL_WIN . valStr . pad) . cb . hs.const.EOL_WIN
			}
			else {
				if (isDictionary(obj)) {
					ob := "{"
					cb := "}"
					valStr := toString(obj.Item(key), depth + 1, pad)
					result .= key . " = " . ob . (valStr == "" ? "" : hs.const.EOL_WIN . valStr . pad) . cb . hs.const.EOL_WIN
				}
				else {
					result .= pad(key, keyWidth) . " = <" . value . ">" . hs.const.EOL_WIN
				}
			}
		}
	}
	else {
		result := obj
	}
	if (depth == 0) {
		if (isArray(obj)) {
			ob := "["
			cb := "]"
		}
		else if (IsObject(obj)) {
			ob := "{"
			cb := "}"
		}
		else {
			ob := ""
			cb := ""
		}
		result := ob . "" . result . cb
	}
	return result
}

transformSelected(type) {
	static types:="I|L|R|S|T|U"
	type := setCase(type, "L")
	if (!InStr(types, type)) {
		message("Illegal value for 'type' specified as: [" . type . "]", "transformSelected() - Invalid parameter", 16)
	}
	else {
		selText := getSelectedText()
		if (selText != "") {
			if (type == "r") {
				replaceSelected(reverse(selText))
			}
			else {
				replaceSelected(setCase(selText, type))
			}
		}
	}
}

trimLines() {
	selText := getSelectedText()
	if (selText == "") {
		SendInput, ^a
		selText := getSelectedText()
	}
	if (selText != "") {
		eol := getEol(selText)
		hasEol := endsWith(selText, eol)
		if (hasEol) {
			selText := SubStr(selText, 1, 0 - StrLen(eol))
		}
		newText := ""
		Loop, Parse, selText, % hs.const.EOL_NIX, % hs.const.EOL_MAC
		{
			newText .= Trim(A_LoopField) . eol
		}
		if (!hasEol) {
			newText := SubStr(newText, 1, 0 - StrLen(eol))
		}
		replaceSelected(newText)
	}
}

updateRegistry() {
	RegWrite("HKEY_CLASSES_ROOT\AutoHotkeyScript\Shell\Edit\Command",, """" . hs.config.user.editor . """ ""`%1""")
	RegWrite("HKEY_CLASSES_ROOT\Applications\AutoHotkey.exe", "IsHostApp")

	; IE_VERSIONS := {7:7000, 8:8888, 9:9999, 10:10001, 11:11001}
	SplitPath(A_AhkPath, exe)
	RegWrite("HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\MAIN\FeatureControl\FEATURE_BROWSER_EMULATION", exe, 11001, "REG_DWORD")
}

upperCaseMySql() {
	static mySqlWords := "ABS|ACCESSIBLE|ACCOUNT|ACOS|ACTION|ADD|ADDDATE|ADDTIME|AES_DECRYPT|AES_ENCRYPT|AFTER|AGAINST|AGGREGATE|ALGORITHM|ALL|ALTER|ALWAYS|ANALYSE|ANALYZE|AND|ANY|ANY_VALUE|AREA|AS|ASBINARY|ASC|ASCII|ASENSITIVE|ASIN|ASTEXT|ASWKB|ASWKT|ASYMMETRIC_DECRYPT|ASYMMETRIC_DERIVE|ASYMMETRIC_ENCRYPT|ASYMMETRIC_SIGN|ASYMMETRIC_VERIFY|AT|ATAN|ATAN2|AUTO_INCREMENT|AUTOEXTEND_SIZE|AVG|AVG_ROW_LENGTH|BACKUP|BEFORE|BEGIN|BENCHMARK|BETWEEN|BIGINT|BIN|BINARY|BINLOG|BIT|BIT_AND|BIT_COUNT|BIT_LENGTH|BIT_OR|BIT_XOR|BLOB|BLOCK|BOOL|BOOLEAN|BOTH|BTREE|BUFFER|BY|BYTE|CACHE|CALL|CASCADE|CASCADED|CASE|CAST|CATALOG_NAME|CEIL|CEILING|CENTROID|CHAIN|CHANGE|CHANGED|CHANNEL|CHAR|CHAR_LENGTH|CHARACTER|CHARACTER_LENGTH|CHARSET|CHECK|CHECKSUM|CIPHER|CLASS_ORIGIN|CLIENT|CLOSE|COALESCE|CODE|COERCIBILITY|COLLATE|COLLATION|COLUMN|COLUMN_FORMAT|COLUMN_NAME|COLUMNS|COMMENT|COMMIT|COMMITTED|COMPACT|COMPLETION|COMPRESS|COMPRESSED|COMPRESSION|CONCAT|CONCAT_WS|CONCURRENT|CONDITION|CONNECTION|CONNECTION_ID|CONSISTENT|CONSTRAINT|CONSTRAINT_CATALOG|CONSTRAINT_NAME|CONSTRAINT_SCHEMA|CONTAINS|CONTEXT|CONTINUE|CONV|CONVERT|CONVERT_TZ|CONVEXHULL|COS|COT|COUNT|CPU|CRC32|CREATE|CREATE_ASYMMETRIC_PRIV_KEY|CREATE_ASYMMETRIC_PUB_KEY|CREATE_DH_PARAMETERS|CREATE_DIGEST|CROSS|CROSSES|CUBE|CURDATE|CURRENT|CURRENT_DATE|CURRENT_TIME|CURRENT_TIMESTAMP|CURRENT_USER|CURSOR|CURSOR_NAME|CURTIME|DATA|DATABASE|DATABASES|DATAFILE|DATE|DATE_ADD|DATE_FORMAT|DATE_SUB|DATEDIFF|DATETIME|DAY|DAY_HOUR|DAY_MICROSECOND|DAY_MINUTE|DAY_SECOND|DAYNAME|DAYOFMONTH|DAYOFWEEK|DAYOFYEAR|DEALLOCATE|DEC|DECIMAL|DECLARE|DECODE|DEFAULT|DEFAULT_AUTH|DEFINER|DEGREES|DELAY_KEY_WRITE|DELAYED|DELETE|DES_DECRYPT|DES_ENCRYPT|DES_KEY_FILE|DESC|DESCRIBE|DETERMINISTIC|DIAGNOSTICS|DIMENSION|DIRECTORY|DISABLE|DISCARD|DISJOINT|DISK|DISTANCE|DISTINCT|DISTINCTROW|DIV|DO|DOUBLE|DROP|DUAL|DUMPFILE|DUPLICATE|DYNAMIC|EACH|ELSE|ELSEIF|ELT|ENABLE|ENCLOSED|ENCODE|ENCRYPT|ENCRYPTION|END|ENDPOINT|ENDS|ENGINE|ENGINES|ENUM|ENVELOPE|EQUALS|ERROR|ERRORS|ESCAPE|ESCAPED|EVENT|EVENTS|EVERY|EXCHANGE|EXECUTE|EXISTS|EXIT|EXP|EXPANSION|EXPIRE|EXPLAIN|EXPORT|EXPORT_SET|EXTENDED|EXTENT_SIZE|EXTERIORRING|EXTRACT|EXTRACTVALUE|FALSE|FAST|FAULTS|FETCH|FIELD|FIELDS|FILE|FILE_BLOCK_SIZE|FILTER|FIND_IN_SET|FIRST|FIXED|FLOAT|FLOAT4|FLOAT8|FLOOR|FLUSH|FOLLOWS|FOR|FORCE|FOREIGN|FORMAT|FOUND|FOUND_ROWS|FROM|FROM_BASE64|FROM_DAYS|FROM_UNIXTIME|FULL|FULLTEXT|FUNCTION|GENERAL|GENERATED|GEOMCOLLFROMTEXT|GEOMCOLLFROMWKB|GEOMETRY|GEOMETRYCOLLECTION|GEOMETRYCOLLECTIONFROMTEXT|GEOMETRYCOLLECTIONFROMWKB|GEOMETRYFROMTEXT|GEOMETRYFROMWKB|GEOMETRYN|GEOMETRYTYPE|GEOMFROMTEXT|GEOMFROMWKB|GET|GET_FORMAT|GET_LOCK|GLENGTH|GLOBAL|GRANT|GRANTS|GREATEST|GROUP|GROUP_CONCAT|GROUP_REPLICATION|GTID_SUBSET|GTID_SUBTRACT|HANDLER|HASH|HAVING|HELP|HEX|HIGH_PRIORITY|HOST|HOSTS|HOUR|HOUR_MICROSECOND|HOUR_MINUTE|HOUR_SECOND|IDENTIFIED|IF|IFNULL|IGNORE|IGNORE_SERVER_IDS|IMPORT|IN|INDEX|INDEXES|INET6_ATON|INET6_NTOA|INET_ATON|INET_NTOA|INFILE|INITIAL_SIZE|INNER|INOUT|INSENSITIVE|INSERT|INSERT_METHOD|INSTALL|INSTANCE|INSTR|INT|INT1|INT2|INT3|INT4|INT8|INTEGER|INTERIORRINGN|INTERSECTS|INTERVAL|INTO|INVOKER|IO|IO_AFTER_GTIDS|IO_BEFORE_GTIDS|IO_THREAD|IPC|IS|IS_FREE_LOCK|IS_IPV4|IS_IPV4_COMPAT|IS_IPV4_MAPPED|IS_IPV6|IS_USED_LOCK|ISCLOSED|ISEMPTY|ISNULL|ISOLATION|ISSIMPLE|ISSUER|ITERATE|JOIN|JSON|JSON_APPEND|JSON_ARRAY|JSON_ARRAY_APPEND|JSON_ARRAY_INSERT|JSON_CONTAINS|JSON_CONTAINS_PATH|JSON_DEPTH|JSON_EXTRACT|JSON_INSERT|JSON_KEYS|JSON_LENGTH|JSON_MERGE|JSON_OBJECT|JSON_QUOTE|JSON_REMOVE|JSON_REPLACE|JSON_SEARCH|JSON_SET|JSON_TYPE|JSON_UNQUOTE|JSON_VALID|KEY|KEY_BLOCK_SIZE|KEYS|KILL|LANGUAGE|LAST|LAST_DAY|LAST_INSERT_ID|LCASE|LEADING|LEAST|LEAVE|LEAVES|LEFT|LENGTH|LESS|LEVEL|LIKE|LIMIT|LINEAR|LINEFROMTEXT|LINEFROMWKB|LINES|LINESTRING|LINESTRINGFROMTEXT|LINESTRINGFROMWKB|LIST|LN|LOAD|LOAD_FILE|LOCAL|LOCALTIME|LOCALTIMESTAMP|LOCATE|LOCK|LOCKS|LOG|LOG2|LOG10|LOGFILE|LOGS|LONG|LONGBLOB|LONGTEXT|LOOP|LOW_PRIORITY|LOWER|LPAD|LTRIM|MAKE_SET|MAKEDATE|MAKETIME|MASTER|MASTER_AUTO_POSITION|MASTER_BIND|MASTER_CONNECT_RETRY|MASTER_DELAY|MASTER_HEARTBEAT_PERIOD|MASTER_HOST|MASTER_LOG_FILE|MASTER_LOG_POS|MASTER_PASSWORD|MASTER_PORT|MASTER_POS_WAIT|MASTER_RETRY_COUNT|MASTER_SERVER_ID|MASTER_SSL|MASTER_SSL_CA|MASTER_SSL_CAPATH|MASTER_SSL_CERT|MASTER_SSL_CIPHER|MASTER_SSL_CRL|MASTER_SSL_CRLPATH|MASTER_SSL_KEY|MASTER_SSL_VERIFY_SERVER_CERT|MASTER_TLS_VERSION|MASTER_USER|MATCH|MAX|MAX_CONNECTIONS_PER_HOUR|MAX_QUERIES_PER_HOUR|MAX_ROWS|MAX_SIZE|MAX_STATEMENT_TIME|MAX_UPDATES_PER_HOUR|MAX_USER_CONNECTIONS|MAXVALUE|MBRCONTAINS|MBRCOVEREDBY|MBRCOVERS|MBRDISJOINT|MBREQUAL|MBREQUALS|MBRINTERSECTS|MBROVERLAPS|MBRTOUCHES|MBRWITHIN|MD5|MEDIUM|MEDIUMBLOB|MEDIUMINT|MEDIUMTEXT|MEMORY|MERGE|MESSAGE_TEXT|MICROSECOND|MID|MIDDLEINT|MIGRATE|MIN|MIN_ROWS|MINUTE|MINUTE_MICROSECOND|MINUTE_SECOND|MLINEFROMTEXT|MLINEFROMWKB|MOD|MODE|MODIFIES|MODIFY|MONTH|MONTHNAME|MPOINTFROMTEXT|MPOINTFROMWKB|MPOLYFROMTEXT|MPOLYFROMWKB|MULTILINESTRING|MULTILINESTRINGFROMTEXT|MULTILINESTRINGFROMWKB|MULTIPOINT|MULTIPOINTFROMTEXT|MULTIPOINTFROMWKB|MULTIPOLYGON|MULTIPOLYGONFROMTEXT|MULTIPOLYGONFROMWKB|MUTEX|MYSQL_ERRNO|NAME|NAME_CONST|NAMES|NATIONAL|NATURAL|NCHAR|NDB|NDBCLUSTER|NEVER|NEW|NEXT|NO|NO_WAIT|NO_WRITE_TO_BINLOG|NODEGROUP|NONBLOCKING|NONE|NOT|NOW|NULL|NULLIF|NUMBER|NUMERIC|NUMGEOMETRIES|NUMINTERIORRINGS|NUMPOINTS|NVARCHAR|OCT|OCTET_LENGTH|OFFSET|OLD_PASSWORD|ON|ONE|ONLY|OPEN|OPTIMIZE|OPTIMIZER_COSTS|OPTION|OPTIONALLY|OPTIONS|OR|ORD|ORDER|OUT|OUTER|OUTFILE|OVERLAPS|OWNER|PACK_KEYS|PAGE|PARSE_GCOL_EXPR|PARSER|PARTIAL|PARTITION|PARTITIONING|PARTITIONS|PASSWORD|PERIOD_ADD|PERIOD_DIFF|PHASE|PI|PLUGIN|PLUGIN_DIR|PLUGINS|POINT|POINTFROMTEXT|POINTFROMWKB|POINTN|POLYFROMTEXT|POLYFROMWKB|POLYGON|POLYGONFROMTEXT|POLYGONFROMWKB|PORT|POSITION|POW|POWER|PRECEDES|PRECISION|PREPARE|PRESERVE|PREV|PRIMARY|PRIVILEGES|PROCEDURE|PROCESSLIST|PROFILE|PROFILES|PROXY|PURGE|QUARTER|QUERY|QUICK|QUOTE|RADIANS|RAND|RANDOM_BYTES|RANGE|READ|READ_ONLY|READ_WRITE|READS|REAL|REBUILD|RECOVER|REDO_BUFFER_SIZE|REDOFILE|REDUNDANT|REFERENCES|REGEXP|RELAY|RELAY_LOG_FILE|RELAY_LOG_POS|RELAY_THREAD|RELAYLOG|RELEASE|RELEASE_ALL_LOCKS|RELEASE_LOCK|RELOAD|REMOVE|RENAME|REORGANIZE|REPAIR|REPEAT|REPEATABLE|REPLACE|REPLICATE_DO_DB|REPLICATE_DO_TABLE|REPLICATE_IGNORE_DB|REPLICATE_IGNORE_TABLE|REPLICATE_REWRITE_DB|REPLICATE_WILD_DO_TABLE|REPLICATE_WILD_IGNORE_TABLE|REPLICATION|REQUIRE|RESET|RESIGNAL|RESTORE|RESTRICT|RESUME|RETURN|RETURNED_SQLSTATE|RETURNS|REVERSE|REVOKE|RIGHT|RLIKE|ROLLBACK|ROLLUP|ROTATE|ROUND|ROUTINE|ROW|ROW_COUNT|ROW_FORMAT|ROWS|RPAD|RTREE|RTRIM|SAVEPOINT|SCHEDULE|SCHEMA|SCHEMA_NAME|SCHEMAS|SEC_TO_TIME|SECOND|SECOND_MICROSECOND|SECURITY|SELECT|SENSITIVE|SEPARATOR|SERIAL|SERIALIZABLE|SERVER|SESSION|SESSION_USER|SET|SHA|SHA1|SHA2|SHARE|SHOW|SHUTDOWN|SIGN|SIGNAL|SIGNED|SIMPLE|SIN|SLAVE|SLEEP|SLOW|SMALLINT|SNAPSHOT|SOCKET|SOME|SONAME|SOUNDEX|SOUNDS|SOURCE|SPACE|SPATIAL|SPECIFIC|SQL|SQL_AFTER_GTIDS|SQL_AFTER_MTS_GAPS|SQL_BEFORE_GTIDS|SQL_BIG_RESULT|SQL_BUFFER_RESULT|SQL_CACHE|SQL_CALC_FOUND_ROWS|SQL_NO_CACHE|SQL_SMALL_RESULT|SQL_THREAD|SQL_TSI_DAY|SQL_TSI_HOUR|SQL_TSI_MINUTE|SQL_TSI_MONTH|SQL_TSI_QUARTER|SQL_TSI_SECOND|SQL_TSI_WEEK|SQL_TSI_YEAR|SQLEXCEPTION|SQLSTATE|SQLWARNING|SQRT|SRID|SSL|ST_AREA|ST_ASBINARY|ST_ASGEOJSON|ST_ASTEXT|ST_ASWKB|ST_ASWKT|ST_BUFFER|ST_BUFFER_STRATEGY|ST_CENTROID|ST_CONTAINS|ST_CONVEXHULL|ST_CROSSES|ST_DIFFERENCE|ST_DIMENSION|ST_DISJOINT|ST_DISTANCE|ST_DISTANCE_SPHERE|ST_ENDPOINT|ST_ENVELOPE|ST_EQUALS|ST_EXTERIORRING|ST_GEOHASH|ST_GEOMCOLLFROMTEXT|ST_GEOMCOLLFROMTXT|ST_GEOMCOLLFROMWKB|ST_GEOMETRYCOLLECTIONFROMTEXT|ST_GEOMETRYCOLLECTIONFROMWKB|ST_GEOMETRYFROMTEXT|ST_GEOMETRYFROMWKB|ST_GEOMETRYN|ST_GEOMETRYTYPE|ST_GEOMFROMGEOJSON|ST_GEOMFROMTEXT|ST_GEOMFROMWKB|ST_INTERIORRINGN|ST_INTERSECTION|ST_INTERSECTS|ST_ISCLOSED|ST_ISEMPTY|ST_ISSIMPLE|ST_ISVALID|ST_LATFROMGEOHASH|ST_LENGTH|ST_LINEFROMTEXT|ST_LINEFROMWKB|ST_LINESTRINGFROMTEXT|ST_LINESTRINGFROMWKB|ST_LONGFROMGEOHASH|ST_MAKEENVELOPE|ST_MLINEFROMTEXT|ST_MLINEFROMWKB|ST_MPOINTFROMTEXT|ST_MPOINTFROMWKB|ST_MPOLYFROMTEXT|ST_MPOLYFROMWKB|ST_MULTILINESTRINGFROMTEXT|ST_MULTILINESTRINGFROMWKB|ST_MULTIPOINTFROMTEXT|ST_MULTIPOINTFROMWKB|ST_MULTIPOLYGONFROMTEXT|ST_MULTIPOLYGONFROMWKB|ST_NUMGEOMETRIES|ST_NUMINTERIORRING|ST_NUMINTERIORRINGS|ST_NUMPOINTS|ST_OVERLAPS|ST_POINTFROMGEOHASH|ST_POINTFROMTEXT|ST_POINTFROMWKB|ST_POINTN|ST_POLYFROMTEXT|ST_POLYFROMWKB|ST_POLYGONFROMTEXT|ST_POLYGONFROMWKB|ST_SIMPLIFY|ST_SRID|ST_STARTPOINT|ST_SYMDIFFERENCE|ST_TOUCHES|ST_UNION|ST_VALIDATE|ST_WITHIN|ST_X|ST_Y|STACKED|START|STARTING|STARTPOINT|STARTS|STATS_AUTO_RECALC|STATS_PERSISTENT|STATS_SAMPLE_PAGES|STATUS|STD|STDDEV|STDDEV_POP|STDDEV_SAMP|STOP|STORAGE|STORED|STR_TO_DATE|STRAIGHT_JOIN|STRCMP|STRING|SUBCLASS_ORIGIN|SUBDATE|SUBJECT|SUBPARTITION|SUBPARTITIONS|SUBSTR|SUBSTRING|SUBSTRING_INDEX|SUBTIME|SUM|SUPER|SUSPEND|SWAPS|SWITCHES|SYSDATE|SYSTEM_USER|TABLE|TABLE_CHECKSUM|TABLE_NAME|TABLES|TABLESPACE|TAN|TEMPORARY|TEMPTABLE|TERMINATED|TEXT|THAN|THEN|TIME|TIME_FORMAT|TIME_TO_SEC|TIMEDIFF|TIMESTAMP|TIMESTAMPADD|TIMESTAMPDIFF|TINYBLOB|TINYINT|TINYTEXT|TO|TO_BASE64|TO_DAYS|TO_SECONDS|TOUCHES|TRAILING|TRANSACTION|TRIGGER|TRIGGERS|TRIM|TRUE|TRUNCATE|TYPE|TYPES|UCASE|UNCOMMITTED|UNCOMPRESS|UNCOMPRESSED_LENGTH|UNDEFINED|UNDO|UNDO_BUFFER_SIZE|UNDOFILE|UNHEX|UNICODE|UNINSTALL|UNION|UNIQUE|UNIX_TIMESTAMP|UNKNOWN|UNLOCK|UNSIGNED|UNTIL|UPDATE|UPDATEXML|UPGRADE|UPPER|USAGE|USE|USE_FRM|USER|USER_RESOURCES|USING|UTC_DATE|UTC_TIME|UTC_TIMESTAMP|UUID|UUID_SHORT|VALIDATE_PASSWORD_STRENGTH|VALIDATION|VALUE|VALUES|VAR_POP|VAR_SAMP|VARBINARY|VARCHAR|VARCHARACTER|VARIABLES|VARIANCE|VARYING|VERSION|VIEW|VIRTUAL|WAIT|WAIT_FOR_EXECUTED_GTID_SET|WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS|WARNINGS|WEEK|WEEKDAY|WEEKOFYEAR|WEIGHT_STRING|WHEN|WHERE|WHILE|WITH|WITHIN|WITHOUT|WORK|WRAPPER|WRITE|X509|XA|XID|XML|XOR|YEAR|YEAR_MONTH|YEARWEEK|ZEROFILL"
	upperCaseSqlWords(hs.config.user.options.mySqlTransformRemainderToLower, mySqlWords)
}

upperCaseOracle() {
	static oracleWords := "ABORT|ABS|ACCEPT|ACCESS|ACCOUNT|ACOS|ACTIVATE|ADD|ADD_MONTHS|ADJ_DATE|ADMIN|ADVISE|AFTER|AGENT|AGGREGATE|ALL|ALL_ROWS|ALLOCATE|ALTER|ANALYZE|AND|ANY|APPENDCHILDXML|ARCHIVE|ARCHIVELOG|ARRAY|ARRAYLEN|ARROW|AS|ASC|ASCII|ASCIISTR|ASIN|ASSERT|ASSIGN|AT|ATAN|ATAN2|ATTRIBUTE|AUDIT|AUTHENTICATED|AUTHID|AUTHORIZATION|AUTOEXTEND|AUTOMATIC|AVG|BACKUP|BASE_TABLE|BECOME|BEFORE|BEGIN|BETWEEN|BFILE|BFILE_BASE|BFILENAME|BIN_TO_NUM|BINARY|BINARY_INTEGER|BINARY2VARCHAR|BIT_COMPLEMENT|BIT_OR|BIT_XOR|BITAND|BITMAP|BLOB|BLOB_BASE|BLOCK|BODY|BOOL_TO_INT|BOOLEAN|BOTH|BOUND|BULK|BY|BYTE|CACHE|CACHE_INSTANCES|CALL|CALLING|CANCEL|CARDINALITY|CASCADE|CASE|CAST|CAST_FROM_BINARY|CAST_FROM_NUMBER|CAST_TO_BINARY|CAST_TO_BINARY_FLOAT|CAST_TO_NUMBER|CAST_TO_NVARCHAR2|CAST_TO_RAW|CAST_TO_VARCHAR|CEIL|CFILE|CHAINED|CHANGE|CHAR|CHAR_BASE|CHAR_CS|CHARACTER|CHARSET|CHARSETFORM|CHARSETID|CHARTOROWID|CHECK|CHECKPOINT|CHOOSE|CHR|CHUNK|CLEAR|CLOB|CLOB_BASE|CLONE|CLOSE|CLOSE_CACHED_OPEN_CURSORS|CLUSTER|CLUSTER_ID|CLUSTER_PROBABILITY|CLUSTER_SET|CLUSTERS|COALESCE|COBOL|COLAUTH|COLLECT|COLUMN|COLUMNS|COMMENT|COMMIT|COMMITTED|COMPATIBILITY|COMPILE|COMPILED|COMPLETE|COMPOSE|COMPOSITE_LIMIT|COMPRESS|COMPUTE|CONCAT|CONNECT|CONNECT_TIME|CONSTANT|CONSTRAINT|CONSTRAINTS|CONSTRUCTOR|CONTENTS|CONTEXT|CONTINUE|CONTROLFILE|CONVERT|CORR|CORR_K|CORR_S|COS|COSH|COST|COUNT|COVAR_POP|COVAR_SAMP|CPU_PER_CALL|CPU_PER_SESSION|CRASH|CREATE|CUME_DIST|CURRENT|CURRENT_DATE|CURRENT_SCHEMA|CURRENT_TIMESTAMP|CURRENT_USER|CURRVAL|CURSOR|CUSTOMDATUM|CV|CYCLE|DANGLING|DATA|DATA_BASE|DATABASE|DATAFILE|DATAFILES|DATAOBJNO|DATE|DATE_BASE|DAY|DBA|DBHIGH|DBLOW|DBMAC|DBTIMEZONE|DEALLOCATE|DEBUG|DEBUGOFF|DEBUGON|DEC|DECIMAL|DECLARE|DECODE|DECOMPOSE|DEFAULT|DEFERRABLE|DEFERRED|DEFINE|DEFINITION|DEGREE|DELAY|DELETE|DELETEXML|DELTA|DENSE_RANK|DEPTH|DEREF|DESC|DETERMINISTIC|DIGITS|DIRECTORY|DISABLE|DISCONNECT|DISMOUNT|DISPOSE|DISTINCT|DISTRIBUTED|DML|DO|DOUBLE|DROP|DUMP|DURATION|EACH|ELEMENT|ELSE|ELSIF|EMPTY|EMPTY_BLOB|EMPTY_CLOB|ENABLE|END|ENFORCE|ENTRY|ESCAPE|ESTIMATE_CPU_UNITS|EVENTS|EXCEPT|EXCEPTION|EXCEPTION_INIT|EXCEPTIONS|EXCHANGE|EXCLUDING|EXCLUSIVE|EXEC|EXECUTE|EXISTS|EXISTSNODE|EXIT|EXP|EXPIRE|EXPLAIN|EXTENT|EXTENTS|EXTERNAL|EXTERNALLY|EXTRACT|EXTRACTVALUE|FAILED_LOGIN_ATTEMPTS|FALSE|FAST|FEATURE_ID|FEATURE_SET|FEATURE_VALUE|FETCH|FILE|FINAL|FIRST|FIRST_ROWS|FIRST_VALUE|FIXED|FLAGGER|FLOAT|FLOB|FLOOR|FLUSH|FOR|FORALL|FORCE|FOREIGN|FORM|FORTRAN|FOUND|FREELIST|FREELISTS|FROM|FROM_TZ|FULL|FUNCTION|GENERAL|GENERIC|GET_CLOCK_TIME|GET_DDL|GET_DEPENDENT_DDL|GET_DEPENDENT_XML|GET_GRANTED_DDL|GET_GRANTED_XDL|GET_HASH|GET_REBUILD_COMMAND|GET_SCN|GET_XML|GLOBAL|GLOBAL_NAME|GLOBALLY|GO|GOTO|GRANT|GREATEST|GROUP|GROUP_ID|GROUPING|GROUPING_ID|GROUPS|HASH|HASHKEYS|HAVING|HEADER|HEAP|HEXTORAW|HIDDEN|HOUR|IDENTIFIED|IDGENERATORS|IDLE_TIME|IF|IMMEDIATE|IN|INCLUDING|INCREMENT|IND_PARTITION|INDEX|INDEXED|INDEXES|INDICATOR|INDICES|INFINITE|INITCAP|INITIAL|INITIALLY|INITRANS|INNER|INSERT|INSERTCHILDXML|INSERTXMLBEFORE|INSTANCE|INSTANCES|INSTANTIABLE|INSTEAD|INSTR|INSTR2|INSTR4|INSTRB|INSTRC|INT|INT_TO_BOOL|INTEGER|INTERFACE|INTERMEDIATE|INTERSECT|INTERVAL|INTO|INVALIDATE|IS|ISOLATION|ISOLATION_LEVEL|ITERATE|ITERATION_NUMBER|JAVA|JOIN|KEEP|KEY|KILL|LABEL|LAG|LANGUAGE|LARGE|LAST|LAST_DAY|LAST_VALUE|LAYER|LEAD|LEADING|LEAST|LEFT|LENGTH|LENGTH2|LENGTH4|LENGTHB|LENGTHC|LESS|LEVEL|LIBRARY|LIKE|LIKE2|LIKE4|LIKEC|LIMIT|LIMITED|LINK|LIST|LISTS|LN|LNNVL|LOB|LOCAL|LOCALTIMESTAMP|LOCK|LOCKED|LOG|LOGFILE|LOGGING|LOGICAL_READS_PER_CALL|LOGICAL_READS_PER_SESSION|LONG|LOOP|LOWER|LPAD|LTRIM|MAKE_REF|MAKEREF|MANAGE|MANUAL|MAP|MASTER|MAX|MAXARCHLOGS|MAXDATAFILES|MAXEXTENTS|MAXINSTANCES|MAXLEN|MAXLOGFILES|MAXLOGHISTORY|MAXLOGMEMBERS|MAXSIZE|MAXTRANS|MAXVALUE|MEDIAN|MEMBER|MERGE|MIN|MINEXTENTS|MINIMUM|MINUS|MINUTE|MINVALUE|MLS_LABEL_FORMAT|MLSLABEL|MOD|MODE|MODIFY|MODULE|MONTH|MONTHS_BETWEEN|MOUNT|MOVE|MTS_DISPATCHERS|MULTISET|NAN|NANVL|NATIONAL|NATIVE|NATURAL|NCHAR|NCHAR_CS|NCLOB|NEEDED|NESTED|NETWORK|NEW|NEW_TIME|NEXT|NEXT_DAY|NEXTVAL|NHEXTORAW|NLS_CHARSET_DECL_LEN|NLS_CHARSET_ID|NLS_CHARSET_NAME|NLS_INITCAP|NLS_LOWER|NLS_UPPER|NLSSORT|NOARCHIVELOG|NOAUDIT|NOCACHE|NOCOMPRESS|NOCOPY|NOCYCLE|NOFORCE|NOLOGGING|NOMAXVALUE|NOMINVALUE|NONE|NOORDER|NOOVERRIDE|NOPARALLEL|NORESETLOGS|NOREVERSE|NORMAL|NOSORT|NOT|NOTFOUND|NOTHING|NOWAIT|NTILE|NULL|NULLFN|NULLIF|NULLS FIRST|NULLS LAST|NUMBER|NUMBER_BASE|NUMERIC|NUMTODSINTERVAL|NUMTOHEX|NUMTOHEX2|NUMTOYMINTERVAL|NVARCHAR2|NVL|NVL2|OBJECT|OBJNO|OBJNO_REUSE|OCICOLL|OCIDATE|OCIDATETIME|OCIDURATION|OCIINTERVAL|OCILOBLOCATOR|OCINUMBER|OCIRAW|OCIREF|OCIREFCURSOR|OCIROWID|OCISTRING|OCITYPE|OF|OFF|OFFLINE|OID|OIDINDEX|OLD|ON|ONLINE|ONLY|OPAQUE|OPCODE|OPEN|OPERATOR|OPTIMAL|OPTIMIZER_GOAL|OPTION|OR|ORA_HASH|ORACLE|ORADATA|ORDER|ORGANIZATION|ORLANY|ORLVARY|OSLABEL|OTHERS|OUT|OUTER|OVERFLOW|OVERLAPS|OVERRIDING|OWN|PACKAGE|PARALLEL|PARALLEL_ENABLE|PARAMETER|PARAMETERS|PARTITION|PASCAL|PASSWORD|PASSWORD_GRACE_TIME|PASSWORD_LIFE_TIME|PASSWORD_LOCK_TIME|PASSWORD_REUSE_MAX|PASSWORD_REUSE_TIME|PASSWORD_VERIFY_FUNCTION|PATH|PCTFREE|PCTINCREASE|PCTTHRESHOLD|PCTUSED|PCTVERSION|PERCENT|PERCENT_RANK|PERCENTILE_CONT|PERCENTILE_DISC|PERMANENT|PIPE|PIPELINED|PIVOT|PLAN|PLI|PLSQL_DEBUG|POSITIVE|POST_TRANSACTION|POWER|POWERMULTISET|POWERMULTISET_BY_CARDINALITY|PRAGMA|PRECISION|PREDICTION|PREDICTION_BOUNDS|PREDICTION_COST|PREDICTION_DETAILS|PREDICTION_PROBABILITY|PREDICTION_SET|PRESENTNNV|PRESENTV|PRESERVE|PREVIOUS|PRIMARY|PRIOR|PRIVATE|PRIVATE_SGA|PRIVILEGE|PRIVILEGES|PROCEDURE|PROFILE|PUBLIC|PURGE|QUEUE|QUOTA|QUOTE DELIMITERS|RAISE|RANDOMBYTES|RANDOMINTEGER|RANDOMNUMBER|RANGE|RANK|RATIO_TO_REPORT|RAW|RAW_TO_CHAR|RAW_TO_NCHAR|RAW_TO_VARCHAR2|RAWTOHEX|RAWTONHEX|RAWTONUM|RAWTONUM2|RBA|READ|READUP|REAL|REBUILD|RECORD|RECOVER|RECOVERABLE|RECOVERY|REF|REFERENCE|REFERENCES|REFERENCING|REFRESH|REFTOHEX|REGEXP_COUNT|REGEXP_INSTR|REGEXP_REPLACE|REGEXP_SUBSTR|REGR_AVGX|REGR_AVGY|REGR_COUNT|REGR_INTERCEPT|REGR_R2|REGR_SLOPE|REGR_SXX|REGR_SXY|REGR_SYY|RELEASE|REM|REMAINDER|REMR|RENAME|REPLACE|RESET|RESETLOGS|RESIZE|RESOURCE|RESTRICTED|RESULT|RETURN|RETURNING|REUSE|REVERSE|REVOKE|RIGHT|ROLE|ROLES|ROLLBACK|ROUND|ROW|ROW_NUMBER|ROWID|ROWIDTOCHAR|ROWIDTONCHAR|ROWLABEL|ROWNUM|ROWS|ROWTYPE|RPAD|RTRIM|RULE|RUN|SAMPLE|SAVE|SAVEPOINT|SB1|SB2|SB4|SCAN_INSTANCES|SCHEMA|SCN|SCN_TO_TIMESTAMP|SCOPE|SD_ALL|SD_INHIBIT|SD_SHOW|SECOND|SECTION|SEG_BLOCK|SEG_FILE|SEGMENT|SELECT|SELF|SEPARATE|SEQUENCE|SERIALIZABLE|SESSION|SESSION_CACHED_CURSORS|SESSIONS_PER_USER|SESSIONTIMEZONE|SET|SHARE|SHARED|SHARED_POOL|SHORT|SHRINK|SIGN|SIN|SINH|SIZE|SIZE_T|SKIP|SKIP_UNUSABLE_INDEXES|SMALLINT|SNAPSHOT|SOME|SORT|SOUNDEX|SPACE|SPARSE|SPECIFICATION|SPLIT|SQL|SQL_TRACE|SQLBUF|SQLCODE|SQLDATA|SQLERRM|SQLERROR|SQLNAME|SQLSTATE|SQRT|STANDARD|STANDBY|START|STATEMENT|STATEMENT_ID|STATIC|STATISTICS|STATS_BINOMIAL_TEST|STATS_CROSSTAB|STATS_F_TEST|STATS_KS_TEST|STATS_MODE|STATS_MW_TEST|STATS_ONE_WAY_ANOVA|STATS_T_TEST|STATS_T_TEST_ONE|STATS_T_TEST_PAIRED|STATS_T_TEST_INDEP|STATS_T_TEST_INDEPU|STATS_WSR_TEST|STDDEV|STDDEV_POP|STDDEV_SAMP|STOP|STORAGE|STORE|STORED|STRING|STRING_TO_RAW|STRUCT|STRUCTURE|STYLE|SUBMULTISET|SUBPARTITION|SUBSTITUTABLE|SUBSTR|SUBSTR2|SUBSTR4|SUBSTRB|SUBSTRC|SUBTYPE|SUCCESSFUL|SUM|SWITCH|SYNONYM|SYS_CONNECT_BY_PATH|SYS_CONTEXT|SYS_DBURIGEN|SYS_EXTRACT_UTC|SYS_GUID|SYS_OP_COMBINED_HASH|SYS_OP_DESCEND|SYS_OP_DISTINCT|SYS_OP_GUID|SYS_OP_LBID|SYS_OP_MAP_NONNULL|SYS_OP_RAWTONUM|SYS_OP_RPB|SYS_OP_TOSETID|SYS_TYPEID|SYS_XMLAGG|SYS_XMLGEN|SYSDATE|SYSDBA|SYSOPER|SYSTEM|SYSTIMESTAMP|TABAUTH|TABLE|TABLES|TABLESPACE|TABLESPACE_NO|TABNO|TAN|TANH|TASK|TDO|TEMPORARY|TERMINATE|THAN|THE|THEN|THREAD|TIME|TIMESTAMP|TIMESTAMP_TO_SCN|TIMEZONE_ABBR|TIMEZONE_HOUR|TIMEZONE_MINUTE|TIMEZONE_REGION|TO|TO_BINARY_DOUBLE|TO_BINARY_FLOAT|TO_BINARYDOUBLE|TO_BINARYFLOAT|TO_CHAR|TO_CLOB|TO_DATE|TO_DSINTERVAL|TO_LOB|TO_MULTI_BYTE|TO_NCHAR|TO_NCLOB|TO_NUMBER|TO_SINGLE_BYTE|TO_TIMESTAMP|TO_TIMESTAMP_TZ|TO_YMINTERVAL|TOPLEVEL|TRACE|TRACING|TRAILING|TRANSAC|TRANSACTION|TRANSACTIONAL|TRANSITIONAL|TRANSLATE|TRANSLITERATE|TREAT|TRIGGER|TRIGGERS|TRIM|TRUE|TRUNC|TRUNCATE|TRUSTED|TX|TYPE|TZ_OFFSET|UB1|UB2|UB4|UBA|UID|UNBOUNDED FOLLOWING|UNBOUNDED PRECEDING|UNDER|UNION|UNIQUE|UNISTR|UNLIMITED|UNLOCK|UNRECOVERABLE|UNSIGNED|UNTIL|UNTRUSTED|UNUSABLE|UNUSED|UPDATABLE|UPDATE|UPDATEXML|UPPER|USAGE|USE|USER|USERENV|USING|VALIDATE|VALIDATION|VALIST|VALUE|VALUES|VAR_POP|VAR_SAMP|VARCHAR|VARCHAR2|VARIABLE|VARIANCE|VARRAY|VARYING|VERIFY_OWNER|VERIFY_TABLE|VERTICAL BARS|VIEW|VIEWS|VOID|VSIZE|WHEN|WHENEVER|WHERE|WHILE|WIDTH_BUCKET|WITH|WITHOUT|WORK|WRAPPED|WRITE|WRITEDOWN|WRITEUP|XID|XMLAGG|XMLCAST|XMLCDATA|XMLCOLATTVAL|XMLCOLLATVAL|XMLCOMMENT|XMLCONCAT|XMLDIFF|XMLELEMENT|XMLEXISTS|XMLFOREST|XMLISVALID|XMLPARSE|XMLPATCH|XMLPI|XMLQUERY|XMLROOT|XMLSEQUENCE|XMLSERIALIZE|XMLTABLE|XMLTRANSFORM|XOR|YEAR|ZONE"
	upperCaseSqlWords(hs.config.user.options.oracleTransformRemainderToLower, oracleWords)
}

upperCaseSqlWords(transformRemainderToLower, sqlWords) {
	selText := getSelectedText()
	if (selText != "") {
		if (transformRemainderToLower) {
			selText := setCase(selText, "L")
		}
		wordsRegex := "i)\b(" . sqlWords . ")\b"
		inComment := false
		upper := ""
		Loop, Parse, selText, % hs.const.EOL_NIX
		{
			if (inComment) {
				pos := InStr(A_LoopField, "*/")
				if (pos > 0) {
					line1 := Substr(A_LoopField, 1, (pos - 1))
					line2 := Substr(A_LoopField, pos)
					inComment := false
				}
				else {
					line1 := A_LoopField
					line2 := ""
				}
				upper .= line1 . RegExReplace(line2, wordsRegex, "$U{1}") . hs.const.EOL_NIX
			}
			else {
				pos := InStr(A_LoopField, "/*")
				if (pos > 0) {
					line1 := Substr(A_LoopField, 1, (pos - 1))
					line2 := Substr(A_LoopField, pos)
					inComment := true
				}
				else {
					pos := InStr(A_LoopField, "--")
					if (pos > 0) {
						line1 := Substr(A_LoopField, 1, (pos - 1))
						line2 := Substr(A_LoopField, pos)
					}
					else {
						line1 := A_LoopField
						line2 := ""
					}
				}
				upper .= RegExReplace(line1, wordsRegex, "$U{1}") . line2 . hs.const.EOL_NIX
			}
		}
		upper := SubStr(upper, 1, StrLen(upper) - 1)
		pasteText(upper)
	}
}

urlEncode(text) {
	text := StrReplace(text, "%", "%25") ; This needs to be first
	text := StrReplace(text, """", "%22")
	text := StrReplace(text, "#", "%23")
	text := StrReplace(text, "$", "%24")
	text := StrReplace(text, "&", "%26")
	text := StrReplace(text, "'", "%27")
	text := StrReplace(text, "(", "%28")
	text := StrReplace(text, ")", "%29")
	text := StrReplace(text, "+", "%2B")
	text := StrReplace(text, ",", "%2C")
	text := StrReplace(text, "/", "%2F")
	text := StrReplace(text, ":", "%3A")
	text := StrReplace(text, ";", "%3B")
	text := StrReplace(text, "<", "%3C")
	text := StrReplace(text, "=", "%3D")
	text := StrReplace(text, ">", "%3D")
	text := StrReplace(text, "?", "%3F")
	text := StrReplace(text, "@", "%40")
	text := StrReplace(text, "`", "%60")
	text := StrReplace(text, A_Tab, A_Space)
	text := StrReplace(text, A_Space, "%20")
	text := StrReplace(text, hs.const.EOL_WIN, A_Space)
	text := StrReplace(text, hs.const.EOL_MAC, A_Space)
	text := StrReplace(text, hs.const.EOL_NIX, A_Space)
	return text
}

urlToVar(url) {
	result := ""
	try {
		http := ComObjCreate("WinHttp.WinHttpRequest.5.1")
		http.Open("GET", url)
		http.Send()
		result := http.ResponseText
	}
	return result
}

varGroup(name, sub:="", values*) {
	group := {}
	group.name := name
	if (sub != "") {
		group.sub := sub
	}
	for i, value in values {
		group.values[value] := ""
	}
	return group
}

whichClipboard() {
	name := "Windows"
	if (hs.internal.isMultiClip) {
		name := "MultiClip " . whichMultiClip()
	}
	else if (hs.internal.isNumClip) {
		name := "NumClip #" . hs.internal.numClip
	}
	return name
}

whichMultiClip() {
;	 return (hs.internal.multiClipQueue ? "Queue (FIFO)" : "Stack (LIFO)")
	return (hs.internal.multiClipQueue ? "(queue)" : "(stack)")
}

wrapSelected(start, end) {
	selText := getSelectedText()
	if (selText == "") {
		SendInput, {End}{Home}+{End}
		selText := getSelectedText()
	}
	if (startsWith(selText, start) && endsWith(selText, end)) {
		lenSel := StrLen(selText)
		lenStart := StrLen(start)
		lenEnd := StrLen(end)
		newText := SubStr(selText, 1 + lenStart, 0 - lenEnd)
	}
	else {
		newText := start . selText . end
	}
	pair := start . end
	if (newText != pair) {
		replaceSelected(newText)
	}
}

wrapSelectedEach(start, end) {
	selText := getSelectedText()
	if (selText == "") {
		SendInput, {End}{Home}+{End}
		selText := getSelectedText()
	}
	eol := getEol(selText)
	hasEol := endsWith(selText, eol)
	if (hasEol) {
		selText := SubStr(selText, 1, 0 - StrLen(eol))
	}
	lenStart := StrLen(start)
	lenEnd := StrLen(end)
	newText := ""
	Loop, Parse, selText, % hs.const.EOL_NIX, % hs.const.EOL_MAC
	{
		lineText := A_LoopField
		if (startsWith(lineText, start) && endsWith(lineText, end)) {
			lenLine := StrLen(lineText)
			newText .= SubStr(lineText, 1 + lenStart, 0 - lenEnd)
		}
		else {
			newText .= start . lineText . end
		}
		newText .= eol
	}
	if (!hasEol) {
		newText := SubStr(newText, 1, 0 - StrLen(eol))
	}
	pair := start . end
	if (newText != pair) {
		replaceSelected(newText)
	}
}

writeHelpContent(tabVar, content) {
	tabVar.open()
	tabVar.write(content)
	tabVar.close()
}

zoomAdjust(direction) {
	static zoomFactor := 1.189207115 ; sqrt(sqrt(2))
	global zoomAmount
	if (direction == -1) {
		if (zoomAmount < 4) {
			zoomAmount *= zoomFactor
		}
	}
	else if (direction == 1) {
		if (zoomAmount > zoomFactor) {
			zoomAmount /= zoomFactor
		}
	}
}

zoomStart() {
	; TODO - refactor global variables into HS
	global zoomAmount := 2
	global zoomWindowDimension := 0
	global zoomWindowH := 100
	global zoomWindowW := 240
	global zoomFollow := true
	global zoomHdcFrame
	global zoomHddFrame

	Process("Priority", "", "High")
	Hotkey, Escape, zoomExit, On
	Hotkey, Space, zoomToggleFollow, On
	Hotkey, WheelDown, zoomChange, On
	Hotkey, !Down, zoomChange, On
	Hotkey, WheelUp, zoomChange, On
	Hotkey, !Up, zoomChange, On
	Hotkey, +WheelDown, zoomWindowChange, On
	Hotkey, +Down, zoomWindowChange, On
	Hotkey, +WheelUp, zoomWindowChange, On
	Hotkey, +Up, zoomWindowChange, On

	Gui, Zoom: +AlwaysOnTop +Owner -Resize -ToolWindow +E0x00000020
	Gui, Zoom: Show, NoActivate W%zoomWindowW% H%zoomWindowH% X-10000 Y-10000, zoomWindow
	WinSet, Transparent, 254, zoomWindow
	Gui, Zoom: -Caption
	Gui, Zoom: +Border
	WinGet, zoomId, id
	zoomHddFrame := DllCall("GetDC", UInt, zoomId)
	WinGet, zoomId, id, zoomWindow
	zoomHdcFrame := DllCall("GetDC", UInt, zoomId)
	DllCall("gdi32.dll\SetStretchBltMode", UInt, zoomHdcFrame, Int, 4)
	GoSub zoomRepaint
	return

	zoomChange:
		zcKey := setCase(A_ThisHotKey, "L")
		if (endsWith(zcKey, "wheelup") || zcKey == "!up") {
			direction := -1
		}
		else if (endsWith(zcKey, "wheeldown") || zcKey == "!down") {
			direction := 1
		}
		if (direction) {
			zoomAdjust(direction)
		}
		return

	zoomExit:
		SetTimer("zoomRepaint", "off")
		DllCall("gdi32.dll\DeleteDC", UInt, zoomHdcFrame)
		DllCall("gdi32.dll\DeleteDC", UInt, zoomHddFrame)
		Gui, Zoom: Destroy
		Process("Priority", "", "Normal")
		Hotkey, Escape,, Off
		Hotkey, Space,, Off
		Hotkey, WheelDown,, Off
		Hotkey, !Down,, Off
		Hotkey, WheelUp,, Off
		Hotkey, !Up,, Off
		Hotkey, +WheelDown,, Off
		Hotkey, +Down,, Off
		Hotkey, +WheelUp,, Off
		Hotkey, +Up,, Off
		return

	zoomRepaint:
		CoordMode("Mouse", "Screen")
		MouseGetPos(zoomMouseX, zoomMouseY)
		WinGetPos, tmpX, tmpY, zoomWindowW, zoomWindowH, zoomWindow
		if (zoomWindowDimension != 0)
		{
			zoomWindowW += zoomWindowDimension
			zoomWindowH += zoomWindowDimension
			zoomWindowDimension := 0
		}
		DllCall("gdi32.dll\StretchBlt"
			, UInt, zoomHdcFrame
			, Int , 2												; nXOriginDest
			, Int , 2												; nYOriginDest
			, Int , (zoomWindowW - 6)								; nWidthDest
			, Int , (zoomWindowH - 6)								; nHeightDest
			, UInt, zoomHddFrame									; hdcSrc
			, Int , (zoomMouseX - (zoomWindowW / 2 / zoomAmount))	; nXOriginSrc
			, Int , (zoomMouseY - (zoomWindowH / 2 / zoomAmount))	; nYOriginSrc
			, Int , (zoomWindowW / zoomAmount)						; nWidthSrc
			, Int , (zoomWindowH / zoomAmount)						; nHeightSrc
			, UInt, 0xCC0020)										; dwRop (raster operation)
		if (zoomFollow) {
			WinMove, zoomWindow,, (zoomMouseX - zoomWindowW / 2), (zoomMouseY - zoomWindowH / 2), %zoomWindowW%, %zoomWindowH%
		}
		SetTimer("zoomRepaint", 10)
		return

	zoomToggleFollow:
		zoomFollow := !zoomFollow
		return

	zoomWindowChange:
		zwcKey := setCase(A_ThisHotKey, "L")
		if (zwcKey == "+wheelup" || zwcKey == "+up") {
			zoomWindowDimension := 32
		}
		else if (zwcKey == "+wheeldown" || zwcKey == "+down") {
			zoomWindowDimension := -32
		}
		else {
			zoomWindowDimension := 0
		}
		GoSub zoomRepaint
		return
}


;__________________________________________________
;classes
class ArrayList {
	__New(values*) {
		this.values := []
		if (values.MaxIndex() > 0) {
			this.put(values*)
		}
		this.iterator := new ArrayList.Iterator(this)
	}

	class Iterator {
		__New(parent) {
			this.values := parent.values
			this.currentIdx := 0
		}

		current() {
			result := ""
			if (this.values.MinIndex() <= this.currentIdx && this.currentIdx <= this.values.MaxIndex()) {
				result := this.values[this.currentIdx]
			}
			return result
		}

		first() {
			this.currentIdx := 1
			return this.current()
		}

		hasNext() {
			return this.currentIdx < this.values.MaxIndex()
		}

		hasPrevious() {
			return this.values.MinIndex() < this.currentIdx
		}

		index() {
			return this.currentIdx
		}

		last() {
			this.currentIdx := this.values.MaxIndex()
			return this.current()
		}

		next() {
			result := ""
			if (this.hasNext()) {
				this.currentIdx++
				result := this.current()
			}
			else {
				this.currentIdx := this.values.MaxIndex() + 1
			}
			return result
		}

		previous() {
			result := ""
			if (this.hasPrevious()) {
				this.currentIdx--
				result := this.current()
			}
			else {
				this.reset()
			}
			return result
		}

		reset() {
			this.currentIdx := 0
		}
	}

	clear() {
		this.values := ""
		this.values := []
	}

	containsKey(key) {
		result := 0
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			if (key == k) {
				result := 1
				break
			}
		}
		return result
	}

	containsValue(value) {
		result := 0
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			if (value == v) {
				result := 1
				break
			}
		}
		return result
	}

	getAt(index, ByRef key, ByRef value) {
		kv := this.values[index]
		this.getKeyValue(kv, key, value)
	}

	getKey(value) {
		result := ""
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			if (value == v) {
				result := k
				break
			}
		}
		return result
	}

	getKeys() {
		result := []
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			result.insert(k)
		}
		return result
	}

	getKeyValue(keyValue, ByRef key, ByRef value) {
		key := ""
		value := ""
		for k, v in keyValue {
			key := k
			value := v
		}
	}

	getValue(key) {
		result := ""
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			if (key == k) {
				result := v
				break
			}
		}
		return result
	}

	getValues() {
		result := []
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			result.insert(v)
		}
		return result
	}

	indexOfKey(key) {
		result := ""
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			if (key == k) {
				result := i
				break
			}
		}
		return result
	}

	indexOfValue(value) {
		result := ""
		for i, kv in this.values {
			this.getKeyValue(kv, k, v)
			if (value == v) {
				result := i
				break
			}
		}
		return result
	}

	insert(values*) {
		idx := this.size() + 1
		this.insertAt(idx, values*)
	}

	insertAfterKey(key, values*) {
		idx := this.indexOfKey(key)
		idx := (idx != "" ? idx : this.size())
		this.insertAt(idx, values*)
	}

	insertAfterValue(value, values*) {
		idx := this.indexOfValue(value)
		idx := (idx != "" ? idx : this.size())
		this.insertAt(idx, values*)
	}

	insertAt(index, values*) {
		if (values.MaxIndex() > 0) {
			arr := this.toAssociativeArray(values*)
			if (index > this.values.MaxIndex()) {
				index := this.values.MaxIndex()
			}
			else if (index < 0) {
				index := 0
			}
			for i, kv in arr {
				this.values.Insert(index + i, kv)
			}
		}
	}

	insertBeforeKey(key, values*) {
		idx := this.indexOfKey(key)
		idx := (idx != "" ? idx - 1 : this.size())
		this.insertAt(idx, values*)
	}

	insertBeforeValue(value, values*) {
		idx := this.indexOfValue(value)
		idx := (idx != "" ? idx - 1 : this.size())
		this.insertAt(idx, values*)
	}

	isEmpty() {
		return (this.size() == 0)
	}

	put(values*) {
		if (values.MaxIndex() > 0) {
			arr := this.toAssociativeArray(values*)
			for i, kv in arr {
				for k, v in kv {
					idx := this.indexOfKey(k)
					if (idx != "") {
						this.values[idx] := kv
					}
					else {
						this.values.Insert(kv)
					}
				}
			}
		}
	}

	remove(index*) {
		indexes := []
		for i, idx in index {
			indexes[idx] := idx
		}
		max := indexes.MaxIndex()
		while (max != "") {
			this.values.RemoveAt(max)
			indexes.RemoveAt(max)
			max := indexes.MaxIndex()
		}
	}

	removeByKey(key*) {
		for i, k in key {
			idx := this.indexOfKey(k)
			if (idx != "") {
				this.values.RemoveAt(idx)
			}
		}
	}

	removeByValue(value*) {
		for i, v in value {
			idx := this.indexOfValue(v)
			if (idx != "") {
				this.values.RemoveAt(idx)
			}
		}
	}

	size() {
		count := 0
		for key, val in this.values {
			count++
		}
		return count
	}

	toAssociativeArray(values*) {
		arr := []
		if (values.MaxIndex() > 0) {
			if (Mod(values.MaxIndex(), 2) != 0) {
				values.Insert("")
			}
			while (values.MaxIndex() > 0) {
				kv := {values[1]:values[2]}
				arr.Insert(kv)
				values.RemoveAt(1, 2)
			}
		}
		return arr
	}
}

class BaseForm extends BaseProperty {
	setColor(fgColor:="", bgColor:="") {
		name := "_" . StrSplit(getSelf(1), ".")[2]
		this.setValue(getHexColor(fgColor), name . "Fg")
		this.setValue(getHexColor(bgColor), name . "Bg")
		return this
	}
	setFont(value) {
		selfParts := StrSplit(getSelf(1), ".")
		if (startsWith(selfParts[1], "Form")) {
			if (value.__Class != "Font") {
				message("Only values of type Font may be used for '" . selfParts[2] . "'.`n`nvalue: " . toString(value) . getStackTraceStr(), "Invalid parameter - " . selfParts[2] . "()", 16)
			}
			else {
				this.setValue(value, "_" . selfParts[2])
			}
		}
	}
}

class BaseProperty {
	__getName() {
		return "_" . StrSplit(getSelf(2), ".")[2]
	}
	copy() {
		return deepCopy(this)
	}
	getTokens() {
		tokens := {}
		for key, value in this {
			if (!IsObject(value) && !isArray(value)) {
				tokens[SubStr(key, 2)] := value
			}
		}
		return tokens
	}
	setBoolean(value:=true, name:="") {
		if (name == "") {
			name := this.__getName()
		}
		; TODO - this is never going to run - maybe just invert the current value instead?
		if (value == "" && !toBool(this[name])) {
			; the predominant intent when calling this is to turn it on (since it would be false by default), so don't force a parameter in order to become true
			value := true
		}
		this[name] := toBool(value)
	}
	setNumber(value:=0, name:="") {
		if (name == "") {
			name := this.__getName()
		}
		if (!is(value, "number")) {
			value := 0
			message("Value for '" . SubStr(name, 2) . "' must be a number.", "Invalid parameter", 48)
		}
		this[name] := value
	}
	setValue(value:="", name:="") {
		if (name == "") {
			name := this.__getName()
		}
		this[name] := value
	}
	toString(msg:="") {
		return msg . toString(this)
	}
}

class BaseSelect extends BaseProperty {
	_path := ""
	_readOnly := ""
	_title := ""

	getValue(hWnd) {
		GuiControlGet, all,, %hWnd%
		theList := ""
		Loop, Parse, all, `n
		{
			theList .= A_LoopField . "|"
		}
		return Trim(theList, "|")
	}
	path(value:="") {
		this.setValue(value)
		return this
	}
	readOnly(value:=true) {
		this.setBoolean(value)
		return this
	}
	title(value:="") {
		this.setValue(value)
		return this
	}
}

class Config {
	defaultHelpTab := 1
	lastHelpTab := 1
	editor := "notepad.exe"
	enableAutoStart := true
	enableAutoUpdate := true
	enableHkAutomation := true
	enableHkClipboard := true
	enableHkCommandLine := true
	enableHkEpp := true
	enableHkMisc := true
	enableHkMouse := true
	enableHkText := true
	enableHkTransform := true
	enableHkWindow := true
	enableHsAlias := true
	enableHsAutoCorrect := true
	enableHsCode := true
	enableHsDates := true
	enableHsDos := true
	enableHsJira := true
	enableHsVariables := true
	enableVersionCheck := true
	sortCase := false
	sortType := "Natural"
	shiftWindowPixels := 50
	file := ""
	hkSessionCount := 0
	hkTotalCount := 0
	hotKeys := {}
	hsSessionCount := 0
	hsTotalCount := 0
	jiraPanels := {
		(LTrim Comments Join,
			format: "borderStyle=solid|borderColor=#9EB6D4|titleBGColor=#C0CFDD|bgColor=#E0EFFF"
			formatBlue: "borderStyle=solid|borderColor=#99BCE8|titleBGColor=#C2D8F0|bgColor=#DFE9F6"
			formatGreen: "borderStyle=solid|borderColor=#9EC49F|titleBGColor=#BBDABE|bgColor=#DDFADE"
			formatRed: "borderStyle=solid|borderColor=#DF9898|titleBGColor=#DFC7C7|bgColor=#FFE7E7"
			formatYellow: "borderStyle=solid|borderColor=#F7DF92|titleBGColor=#DFDFBD|bgColor=#FFFFDD"
		)}
	lastUpdateCheck := ""
	options := {
		(LTrim Comments Join,
			mySqlTransformRemainderToLower: false
			oracleTransformRemainderToLower: false
			resolutions: ""
		)}
	quickLookupSites := ""
	version := ""
	__New(rootName:="") {
		base := A_ScriptDir . "\" . rootName . "-template."
		home := "^{Home}"
		this.templates := {
			(LTrim Comments Join,
				html: base . "html"
				htmlKeys: home
				java: base . "java"
				javaKeys: home
				perl: base . "pl"
				perlKeys: home
				sql: base . "sql"
				sqlKeys: home
			)}
	}
}

class CtrlColors {
	static _attached := {}
	static _error := ""
	static HandledMessages := {Edit: 0, ListBox: 0, Static: 0}
	static NULL_BRUSH := DllCall("GetStockObject", "Int", 5, "UPtr")
	static SYS_COLORS := {Edit: "", ListBox: "", Static: ""}
	static WM_CTLCOLOR := {Edit: 0x0133, ListBox: 0x134, Static: 0x0138}

	__Delete() {
		for i, v in this._attached {
			if (v.brush && v.brush != this.NULL_BRUSH) {
				DllCall("Gdi32.dll\DeleteObject", "Ptr", v.brush)
			}
		}
		for i, v in this.HandledMessages {
			if (v > 0) {
				OnMessage(this.WM_CTLCOLOR[i], "")
				this.HandledMessages[i] := 0
			 }
		}
		this._attached := {}
	}
	attach(hWnd, bgColor, fgColor := "") {
		static classNames := {Button: "", ComboBox: "", Edit: "", ListBox: "", Static: ""}
		static BS_CHECKBOX := 0x2
		static BS_RADIOBUTTON := 0x8
		static ES_READONLY := 0x800
		static COLOR_3DFACE := 15
		static COLOR_WINDOW := 5
		if (this.SYS_COLORS.Edit == "") {
			this.SYS_COLORS.Static := DllCall("GetSysColor", "Int", COLOR_3DFACE, "UInt")
			this.SYS_COLORS.Edit := DllCall("GetSysColor", "Int", COLOR_WINDOW, "UInt")
			this.SYS_COLORS.ListBox := this.SYS_COLORS.Edit
		}
		this._error := ""
		if (bgColor == "" && fgColor == "") {
			this._error := "Both parameters bgColor and fgColor are empty."
			return false
		}
		if (!(ctrlHwnd := hWnd + 0) || !DllCall("IsWindow", "UPtr", hWnd, "UInt")) {
			this._error := "Invalid parameter hWnd: " . hWnd
			return false
		}
		if (this._attached.HasKey(hWnd)) {
			this._error := "Control " . hWnd . " is already registered."
			return false
		}
		hWnds := [ctrlHwnd]
		classes := ""
		WinGetClass, ctrlClass, ahk_id %ctrlHwnd%
		if (!classNames.HasKey(ctrlClass)) {
			this._error := "Unsupported control class: " . ctrlClass
			return false
		}
		ControlGet, ctrlStyle, Style,,, ahk_id %ctrlHwnd%
		if (ctrlClass == "Edit") {
			classes := ["Edit", "Static"]
		}
		else if (ctrlClass == "Button") {
			if ((ctrlStyle & BS_RADIOBUTTON) || (ctrlStyle & BS_CHECKBOX)) {
				classes := ["Static"]
			}
			else {
				return false
			}
		}
		else if (ctrlClass == "ComboBox") {
			VarSetCapacity(cbbi, 40 + (A_PtrSize * 3), 0)
			NumPut(40 + (A_PtrSize * 3), cbbi, 0, "UInt")
			DllCall("GetComboBoxInfo", "Ptr", ctrlHwnd, "Ptr", &cbbi)
			hWnds.Insert(NumGet(cbbi, 40 + (A_PtrSize * 2, "UPtr")) + 0)
			hWnds.Insert(Numget(cbbi, 40 + A_PtrSize, "UPtr") + 0)
			classes := ["Edit", "Static", "ListBox"]
		}
		if (!IsObject(classes)) {
			classes := [ctrlClass]
		}
		if (bgColor != "Trans") {
			if (!this.checkBgColor(bgColor, classes[1])) {
				return false
			}
		}
		if (!this.checkFgColor(fgColor)) {
			return false
		}
		for i, v in classes {
			if (this.HandledMessages[v] == 0) {
				OnMessage(this.WM_CTLCOLOR[v], "CtrlColors_OnMessage")
			}
			this.HandledMessages[v] += 1
		}
		brush := (bgColor == "Trans" ? this.NULL_BRUSH : DllCall("Gdi32.dll\CreateSolidBrush", "UInt", bgColor, "UPtr"))
		for i, v in hWnds {
			this._attached[v] := {brush: brush, fgColor: fgColor, bgColor: bgColor, classes: classes, hWnds: hWnds}
		}
		DllCall("InvalidateRect", "Ptr", hWnd, "Ptr", 0, "Int", 1)
		this._error := ""
		return true
	}
	change(hWnd, bgColor, fgColor:="") {
		this._error := ""
		hWnd += 0
		if (!this._attached.HasKey(hWnd)) {
			return this.attach(hWnd, bgColor, fgColor)
		}
		ctrl := this._attached[hWnd]
		if (bgColor != "Trans") {
			if (!this.checkBgColor(bgColor, ctrl.classes[1])) {
				return false
			}
		}
		if (!this.checkFgColor(fgColor)) {
			return false
		}
		if (bgColor != ctrl.bgColor) {
			if (ctrl.brush) {
				if (ctrl.brush != this.NULL_BRUSH) {
					DllCall("Gdi32.dll\DeleteObject", "Prt", ctrl.brush)
				}
				this._attached[hWnd].brush := 0
			}
			brush := (bgColor == "Trans" ? this.NULL_BRUSH : DllCall("Gdi32.dll\CreateSolidBrush", "UInt", bgColor, "UPtr"))
			for I, V in ctrl.hWnds {
				this._attached[V].brush := brush
				this._attached[V].bgColor := bgColor
			}
		}
		for i, v in ctrl.hWnds {
			this._attached[v].fgColor := fgColor
		}
		this._error := ""
		DllCall("InvalidateRect", "Ptr", hWnd, "Ptr", 0, "Int", 1)
		return true
	}
	checkBgColor(ByRef bgColor, ctrlClass) {
		this._error := ""
		if (bgColor != "" && !hs.const.HTML_COLORS.HasKey(bgColor) && !RegExMatch(bgColor, "i)^[[:xdigit:]]{6}$")) {
			this._error := "Invalid parameter for bgColor: " . bgColor
			return false
		}
		bgColor := (bgColor == "" ? this.SYS_COLORS[ctrlClass] : bgr(bgColor))
		return true
	}
	checkFgColor(ByRef fgColor) {
		this._error := ""
		if (fgColor != "" && !hs.const.HTML_COLORS.HasKey(fgColor) && !RegExMatch(fgColor, "i)^[[:xdigit:]]{6}$")) {
			this._error := "Invalid parameter fgColor: " . fgColor
			return false
		}
		fgColor := (fgColor == "" ? "" : bgr(fgColor))
		return true
	}
	detach(hWnd) {
		this._error := ""
		hWnd += 0
		if (this._attached.HasKey(hWnd)) {
			ctrl := this._attached[hWnd].Clone()
			if (ctrl.brush && ctrl.brush != this.NULL_BRUSH) {
				DllCall("Gdi32.dll\DeleteObject", "Prt", ctrl.brush)
			}
			for i, v in ctrl.classes {
				if (this.HandledMessages[v] > 0) {
					this.HandledMessages[v] -= 1
					if (this.HandledMessages[v] == 0) {
						OnMessage(this.WM_CTLCOLOR[v], "")
					}
				}
			}
			for i, v in ctrl.hWnds {
				this._attached.Delete(v)
			}
			DllCall("InvalidateRect", "Ptr", hWnd, "Ptr", 0, "Int", 1)
			ctrl := ""
			return true
		}
		this._error := "Control " . hWnd . " is not registered."
		return false
	}
	isAttached(hWnd) {
		return this._attached.HasKey(hWnd)
	}
}

CtrlColors_OnMessage(HDC, hWnd) {
	Critical
	if (CtrlColors.isAttached(hWnd)) {
		ctrl := CtrlColors._attached[hWnd]
		if (ctrl.fgColor != "") {
			DllCall("Gdi32.dll\SetTextColor", "Ptr", HDC, "UInt", ctrl.fgColor)
		}
		if (ctrl.bgColor == "Trans") {
			DllCall("Gdi32.dll\SetBkMode", "Ptr", HDC, "UInt", 1) ; TRANSPARENT = 1
		}
		else {
			DllCall("Gdi32.dll\SetBkColor", "Ptr", HDC, "UInt", ctrl.bgColor)
		}
		return ctrl.brush
	}
}

class FileSelect extends BaseSelect {
	_filter := ""

	filter(value:="") {
		this.setValue(value)
		return this
	}
	prompt(hWnd, isMulti) {
		files := FileSelectFile(isMulti ? "M" : "" . "3", this._path, this._title, this._filter)
		if (files != "") {
			path := ""
			result := ""
			if (isMulti) {
				Loop, Parse, files, `n
				{
					if (A_Index == 1) {
						path := StrReplace(A_LoopField . "\", "\\", "\")
					}
					else {
						result .= path . A_LoopField . "`n"
					}
				}
			}
			else {
				result := files
			}
			result := Trim(result, "`n")
			if (hWnd) {
				GuiControl,, % hWnd, % result
			}
			return result
		}
	}
}

class FolderSelect extends BaseSelect {
	prompt(hWnd) {
		dirs := FileSelectFolder("*" . this._path, 3, this._title)
		if (dirs != "") {
			result := Trim(dirs, "`n")
			if (hWnd) {
				GuiControl,, % hWnd, % result
			}
			return result
		}
	}
}

class Font extends BaseProperty {
	_color := ""
	_name := ""
	_options := ""
	_size := 14
	_weight := 0

	bold() {
		this._options .= " bold"
		return this
	}
	color(value:="") {
		this.setValue(getHexColor(value))
		return this
	}
	getOptions() {
		opts := ""
		opts .= (this._color == "" ? "" : " c" . this._color)
		opts .= (this._size == "" || this._size < 1 ? "" : " s" . this._size)
		opts .= (this._weight == "" || this._weight < 1 ? "" : " w" . this._weight)
		opts .= (this._options == "" ? "" : " " . this._options)
		return opts
	}
	italic() {
		this._options .= " italic"
		return this
	}
	isUsable() {
		return (this._color != "" || this._name != "" || this._options != "" || this._size > 0 || this._weight > 0)
	}
	name(value:="") {
		this.setValue(value)
		return this
	}
	norm() {
		this._options .= " norm"
		return this
	}
	options(value:="") {
		matches := ""
		match := ""
		pos := 1
		while (pos := RegExMatch(value, "i)\b(norm|bold|italic|strike|underline)\b", match, pos + StrLen(match))) {
			matches .= (" " . match)
		}
		this.setValue(matches)
		return this
	}
	size(value:=0) {
		if (value < 0) {
			value := 0
		}
		this.setNumber(value)
		return this
	}
	strike() {
		this._options .= " strike"
		return this
	}
	underline() {
		this._options .= " underline"
		return this
	}
	weight(value:=0) {
		if (value < 0) {
			value := 0
		}
		else if (value > 1000) {
			value := 1000
		}
		this.setNumber(value)
		return this
	}
}

class Form extends BaseForm {
	_color := ""
	_buttons := []
	_debug := false
	_fields := []
	_focus := 1
	_footer := ""
	_footerAlign := "left"
	_footerColorBg := ""
	_footerColorFg := ""
	_footerFont := ""
	_header := ""
	_headerAlign := "left"
	_headerColorBg := ""
	_headerColorFg := ""
	_headerFont := ""
	_horizontal := true
	_hWnd := -1
	_inputColorBg := ""
	_inputColorFg := ""
	_inputFont := ""
	_inputWidth := 250
	_keys := ""
	_labelColorBg := ""
	_labelColorFg := ""
	_labelFont := ""
	_labelWidth := 100
	_name := ""
	_noWait := false
	_onCancel := ""
	_onShow := ""
	_onSubmit := ""
	_options := ""
	_requiredInputBg := ""
	_requiredInputFg := ""
	_requiredInputFont := ""
	_requiredLabelBg := ""
	_requiredLabelFg := ""
	_requiredLabelFont := ""
	_showCancel := true
	_showOK := true
	_title := ""

	addField(field) {
		if (field.__Class != "FormField") {
			func := A_ThisFunc . "()"
			message("Only values of type FormField may be added as a 'field'.`n`nvalue: " . toString(field) . getStackTraceStr(), "Invalid parameter - " . func, 16)
		}
		else {
			this._fields.push(field.copy())
		}
		return this
	}
	buttonCount() {
		count := (this._showOK ? 1 : 0)
		count += (this._showCancel ? 1 : 0)
		count += (this._buttons.MaxIndex() / 2)
		return count
	}
	buttons(buttons) {
		this.noButtons()
		this.setValue(buttons)
		return this
	}
	color(value:="") {
		this.setValue(getHexColor(value))
		return this
	}
	debug(value:=true) {
		this.setBoolean(value)
		return this
	}
	fields(value) {
		if (!isArray(value) && (!IsObject(value) || getSize(value) > 0)) {
			func := A_ThisFunc . "()"
			message("Only values of type Array may be used for 'fields'.`n`nvalue: " . toString(value) . getStackTraceStr(), "Invalid parameter - " . func, 16)
		}
		else {
			if (getSize(value) == 0) {
				this.setValue([])
			}
			else {
				for k, field in value {
					this.addField(field)
				}
			}
		}
		return this
	}
	focus(value:=1) {
		if (value < 1) {
			value := 1
		}
		this.setNumber(value)
		return this
	}
	footer(value:="") {
		this.setValue(value)
		return this
	}
	footerAlign(value:="left") {
		value := setCase(value, "L")
		if (value == "right" || value == "r") {
			value := "right"
		}
		else if (value == "center" || value == "c") {
			value := "center"
		}
		else {
			value := "left"
		}
		this.setValue(value)
		return this
	}
	footerColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	footerFont(value:="") {
		this.setFont(value)
		return this
	}
	header(value:="") {
		this.setValue(value)
		return this
	}
	headerAlign(value:="left") {
		value := setCase(value, "L")
		if (value == "right" || value == "r") {
			value := "right"
		}
		else if (value == "center" || value == "c") {
			value := "center"
		}
		else {
			value := "left"
		}
		this.setValue(value)
		return this
	}
	headerColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	headerFont(value:="") {
		this.setFont(value)
		return this
	}
	horizontal(value:=true) {
		this.setBoolean(value)
		return this
	}
	inputColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	inputFont(value:="") {
		this.setFont(value)
		return this
	}
	inputWidth(value:=250) {
		if (value < 25) {
			value := 25
		}
		this.setNumber(value)
		return this
	}
	labelColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	labelFont(value:="") {
		this.setFont(value)
		return this
	}
	labelWidth(value:=100) {
		if (value < 25) {
			value := 25
		}
		this.setNumber(value)
		return this
	}
	noButtons() {
		this.showCancel(false)
		this.showOK(false)
		this._buttons := []
		return this
	}
	noWait(value:=true) {
		this.setBoolean(value)
		return this
	}
	onCancel(value:="") {
		if (IsFunc(value)) {
			this.setValue(value)
		}
		else {
			message("Unknown function name: " . value, A_ThisFunc . "()", 48)
		}
		return this
	}
	onShow(value:="") {
		if (IsFunc(value)) {
			this.setValue(value)
		}
		else {
			message("Unknown function name: " . value, A_ThisFunc . "()", 48)
		}
		return this
	}
	onSubmit(value:="") {
		if (IsFunc(value)) {
			this.setValue(value)
		}
		else {
			message("Unknown function name: " . value, A_ThisFunc . "()", 48)
		}
		return this
	}
	options(value:=true) {
		this.setValue(value)
		return this
	}
	requiredInputColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	requiredInputFont(value:="") {
		this.setFont(value)
		return this
	}
	requiredLabelColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	requiredLabelFont(value:="") {
		this.setFont(value)
		return this
	}
	send(keys) {
		this._keys := keys
		return this
	}
	showCancel(value:=true) {
		this.setBoolean(value)
		return this
	}
	showOK(value:=true) {
		this.setBoolean(value)
		return this
	}
	title(value:="") {
		this.setValue(value)
		return this
	}
	vertical(value:=true) {
		this.horizontal(!toBool(value))
		return this
	}
}

class FormField extends BaseForm {
	_cue := ""
	_cueOnFocus := true
	_default := ""
	_hideLabel := false
	_inputColorBg := ""
	_inputColorFg := ""
	_inputFont := ""
	_items := ""
	_label := ""
	_labelColorBg := ""
	_labelColorFg := ""
	_labelFont := ""
	_lower := false
	_max := ""
	_maxDecimals := -1
	_min := ""
	_minDecimals := -1
	_multi := false
	_name := ""
	_password := false
	_readOnly := ""
	_regex := ""
	_required := false
	_rows := ""
	_select := ""
	_sort := false
	_textAlign := "left"
	_textSpan := false
	_toolTip := ""
	_type := ""
	_upper := false
	_whenInvalid := ""
	_wrap := false

	__New(type:="") {
		type := Trim(type)
		type := (type == "" ? "edit" : setCase(type, "L"))
		if (type == "alpha" || type == "alphanumeric") {
			nums := (type == "alphanumeric" ? "0-9" : "")
			this.regex("i)[" . nums . "a-z ]*")
			type := "edit"
		}
		if (type != "checkbox" && type != "combobox" && type != "dropdown" && type != "edit" && type != "file" && type != "folder" && type != "listbox" && type != "number" && type != "text" && type != "updown") {
			message("Unsupported data type for FormField: " . type, "Invalid data type", 48)
			return
		}
		this._rows := (type == "combobox" || type == "dropdown" || type == "listbox" ? 4 : 1)
		this._type := type
	}
	cue(value:="") {
		this.setValue(value)
		return this
	}
	cueOnFocus(value:=true) {
		this.setBoolean(value)
		return this
	}
	decimals(min:=-1,max:=-1) {
		min += 0
		max += 0
		if (max < min) {
			message("Max decimals (" . max . ") cannot be less than Min decimals (" . min . ").", "Invalid decimals", 48)
			return
		}
		this.setNumber(min, "_minDecimals")
		this.setNumber(max, "_maxDecimals")
		return this
	}
	default(value:="") {
		this.setValue(value)
		return this
	}
	hideLabel() {
		this.setBoolean(true)
		return this
	}
	inputColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	inputFont(value:="") {
		this.setFont(value)
		return this
	}
	items(values:="", delim:="") {
		if (this._type != "combobox" && this._type != "dropdown" && this._type != "listbox") {
			message("Unable to set 'items' on input type: " . this._type, "Invalid option", 48)
		}
		else {
			items := ""
			if (!IsObject(values)) {
				if (delim == "") {
					delim := "|"
					if (!InStr(values, delim)) {
						delim := ","
						if (!InStr(values, delim)) {
							delim := ";"
							if (!InStr(values, delim)) {
								delim := " "
								if (!InStr(values, delim)) {
									delim := " "
								}
							}
						}
					}
				}
				values := StrSplit(values, delim)
			}
			for k, v in values {
				items .= v . "|"
			}
			this.setValue(items)
		}
		return this
	}
	label(value:="") {
		if (value ~= "\w$") {
			value .= ":"
		}
		this.setValue(value)
		this._hideLabel := false
		return this
	}
	labelColor(fgColor:="", bgColor:="") {
		this.setColor(fgColor, bgColor)
		return this
	}
	labelFont(value:="") {
		this.setFont(value)
		return this
	}
	lower(value:=true) {
		this._upper := false
		this.setBoolean(value)
		return this
	}
	max(value:=0) {
		this.setNumber(value)
		return this
	}
	min(value:=0) {
		this.setNumber(value)
		return this
	}
	multi(value:=true) {
		if (this._type != "file" && this._type != "listbox") {
			message("Unable to set 'multi' on input type: " . this._type, "Invalid option", 48)
		}
		else {
			this.setBoolean(value)
		}
		return this
	}
	name(value:="") {
		this.setValue(value)
		if (this._label == "") {
			this.label(convertToWords(value))
		}
		return this
	}
	password(value:=true) {
		this.setBoolean(value)
		return this
	}
	readOnly(value:=true) {
		this.setBoolean(value)
		return this
	}
	regex(value:="") {
		this.setValue(value)
		return this
	}
	required(value:=true) {
		this.setBoolean(value)
		return this
	}
	rows(value:=1) {
		if (this._type != "combobox" && this._type != "dropdown" && this._type != "edit" && this._type != "listbox") {
			message("Unable to set 'rows' on input type: " . this._type, "Invalid option", 48)
		}
		else if (value != -1) {
			if (value < 1) {
				value := 1
			}
			this.setNumber(value)
		}
		return this
	}
	select(value) {
		if (value.__Class != "FileSelect" && value.__Class != "FolderSelect") {
			message("Only values of type FileSelect or FolderSelect may be specified.`n`nvalue: " . value.__Class . " --> " . toString(value) . getStackTraceStr(), "Invalid parameter - " . A_ThisFunc . "()", 16)
		}
		else {
			this.setValue(value.copy())
		}
		return this
	}
	sort(value:=true) {
		this.setBoolean(value)
		return this
	}
	textAlign(value:="left") {
		value := setCase(value, "L")
		if (value == "right" || value == "r") {
			value := "right"
		}
		else if (value == "center" || value == "c") {
			value := "center"
		}
		else {
			value := "left"
		}
		this.setValue(value)
		return this
	}
	textSpan(value:=true) {
		this.setBoolean(value)
		return this
	}
	toolTip(value:="") {
		this.setValue(value)
		return this
	}
	upper(value:=true) {
		this._lower := false
		this.setBoolean(value)
		return this
	}
	validate(isLive:=true) {
		isValid := true
		ctrlHwnd := this._hWnd
		if (this._type == "edit" && this._rows > 1) {
			ControlGetText, value,, ahk_id %ctrlHwnd%
		}
		else {
			GuiControlGet, value,, %ctrlHwnd%
		}
		valLen := StrLen(value)
		if (isLive && valLen == 0) {
			balloonTipHide(ctrlHwnd)
			return true
		}
		invalidMessage := ""
		; REQUIRED
		if (!isLive && this._required && (this._type == "edit" || this._type == "number")) {
			if (Trim(value) == "") {
				icon := "info"
				invalidMessage := "A non-blank value is required."
				isValid := false
			}
		}
		; NUMERIC/DECIMAL
		if (isValid && (this._type == "number" || this._type == "updown")) {
			if (valLen > 0 && !RegexMatch(value, "^-?\d*\.{0,1}\d+$")) {
				icon := "error"
				invalidMessage := "Only numeric values may be entered."
				isValid := false
			}
		}
		; MIN/MAX
		if (!isLive && isValid) {
			if (this._type == "edit") {
				icon := "info"
				if (this._min != "" && valLen < this._min) {
					invalidMessage := "Input length cannot be less than " . this._min . ".`nCurrent length is: " . valLen
					isValid := false
				}
				else if (this._max != "" && valLen > this._max) {
					invalidMessage := "Input length cannot be greater than " . this._max . ".`nCurrent length is: " . valLen
					isValid := false
				}
			}
			else if (this._type == "number" || this._type == "updown") {
				icon := "warn"
				if (this._min != "" && value < this._min) {
					invalidMessage := "Input value cannot be less than " . this._min . "."
					isValid := false
				}
				else if (this._max != "" && value > this._max) {
					invalidMessage := "Input value cannot be greater than " . this._max . "."
					isValid := false
				}
				pos := InStr(value, ".")
				decimals := (pos > 0 ? StrLen(SubStr(value, pos + 1)) : 0)
				if (this._minDecimals > -1 && decimals < this._minDecimals) {
					invalidMessage := "Input value must have at least " . this._minDecimals . " decimals.`nCurrent decimals is: " . decimals
					isValid := false
				}
				else if (this._maxDecimals > -1 && decimals > this._maxDecimals) {
					invalidMessage := "Input value can have at most " . this._maxDecimals . " decimals.`nCurrent decimals is: " . decimals
					isValid := false
				}
			}
		}
		; REGEX
		if (!isLive && isValid) {
			if (this._regex != "" && !RegexMatch(value, this._regex)) {
				icon := "error"
				invalidMessage := "Input value does not conform to expected pattern: " . this._regex
				isValid := false
			}
		}
		if (!isValid) {
			balloonTipShow(ctrlHwnd, "Invalid Value", (this._whenInvalid != "" ? this._whenInvalid : invalidMessage), icon)
			; info - E7E7FF
			; warning - FFFEE7
			; error - FFE7E7
		}
		return isValid
	}
	whenInvalid(value:="") {
		this.setValue(value)
		return this
	}
	wrap(value:=true) {
		this.setBoolean(value)
		return this
	}
}

class GuiControlTips {
	hTip := 0
	hGui := 0
	ctrls := {}

	__New(hGui) {
		static CLASS_TOOLTIP := "tooltips_class32"
		static CW_USEDEFAULT := 0x80000000
		static TTM_SETMAXTIPWIDTH := 0x0418
		static TTM_SETMARGIN := 0x041A
		static WS_EX_TOPMOST := 0x00000008
		static WS_STYLES := 0x80000002 ; WS_POPUP | TTS_NOPREFIX
		hTip := DllCall("User32.dll\CreateWindowEx", "UInt", WS_EX_TOPMOST, "Str", CLASS_TOOLTIP
			, "Ptr", 0, "UInt", WS_STYLES
			, "Int", CW_USEDEFAULT, "Int", CW_USEDEFAULT, "Int", CW_USEDEFAULT, "Int", CW_USEDEFAULT
			, "Ptr", hGui, "Ptr", 0, "Ptr", 0, "Ptr", 0, "Ptr")
		if (ErrorLevel || !hTip) {
			return false
		}
		DllCall("SendMessage", "Ptr", hTip, "Int", TTM_SETMAXTIPWIDTH, "Ptr", 0, "Ptr", 0)
		this.hTip := hTip
		this.hGui := hGui
		if ((DllCall("Kernel32.dll\GetVersion", "UInt") & 0xFF) < 6) {
			this.attach(hGui, "")
		}
	}
	__Delete() {
		if (this.hTip) {
			DllCall("User32.dll\DestroyWindow", "Ptr", this.hTip)
		}
	}
	attach(hCtrl, TipText, CenterTip:=false) {
		static TTM_ADDTOOL := A_IsUnicode ? 0x0432 : 0x0404 ; TTM_ADDTOOLW : TTM_ADDTOOLA
		if (!this.hTip || this.ctrls.HasKey(hCtrl)) {
			return false
		}
		toolInfo := ""
		this.SetToolInfo(toolInfo, hCtrl, &TipText, CenterTip)
		if DllCall("SendMessage", "Ptr", this.hTip, "Int", TTM_ADDTOOL, "Ptr", 0, "Ptr", &toolInfo) {
			this.ctrls[hCtrl] := 1
			return true
		}
		return false
	}
	detach(hCtrl) {
		static TTM_DELTOOL := A_IsUnicode ? 0x0433 : 0x0405 ; TTM_DELTOOLW : TTM_DELTOOLA
		if (!this.ctrls.HasKey(hCtrl)) {
			return false
		}
		toolInfo := ""
		this.SetToolInfo(toolInfo, hCtrl, 0)
		DllCall("SendMessage", "Ptr", this.hTip, "Int", TTM_DELTOOL, "Ptr", 0, "Ptr", &toolInfo)
		this.ctrls.Delete(hCtrl)
		return true
	}
	setDelayTimes(init:=-1, popUp:=-1, reShow:=-1) {
		static TTM_SETDELAYTIME := 0x0403
		static TTDT_RESHOW := 1
		static TTDT_AUTOPOP := 2
		static TTDT_INITIAL := 3
		DllCall("SendMessage", "Ptr", this.hTip, "Int", TTM_SETDELAYTIME, "Ptr", TTDT_INITIAL, "Ptr", init)
		DllCall("SendMessage", "Ptr", this.hTip, "Int", TTM_SETDELAYTIME, "Ptr", TTDT_AUTOPOP, "Ptr", popUp)
		DllCall("SendMessage", "Ptr", this.hTip, "Int", TTM_SETDELAYTIME, "Ptr", TTDT_RESHOW , "Ptr", reShow)
	}
	setToolInfo(ByRef toolInfo, hCtrl, tipTextAddr, centerTip:=false) {
		static TTF_IDISHWND := 0x0001
		static TTF_CENTERTIP := 0x0002
		static TTF_SUBCLASS := 0x0010
		static offsetSize := 0
		static offsetFlags := 4
		static offsetHwnd := 8
		static offsetID := offsetHwnd + A_PtrSize
		static offsetRect := offsetID + A_PtrSize
		static offsetInst := offsetRect + 16
		static offsetText := offsetInst + A_PtrSize
		static structSize := (4 * 6) + (A_PtrSize * 6)
		flags := (TTF_IDISHWND | TTF_SUBCLASS)
		if (centerTip) {
			flags |= TTF_CENTERTIP
		}
		VarSetCapacity(toolInfo, structSize, 0)
		NumPut(structSize, toolInfo, offsetSize, "UInt")
		NumPut(flags, toolInfo, offsetFlags, "UInt")
		NumPut(this.hGui, toolInfo, offsetHwnd, "Ptr")
		NumPut(hCtrl, toolInfo, offsetID, "Ptr")
		NumPut(tipTextAddr, toolInfo, offsetText, "Ptr")
		return true
	}
	suspend(mode:=true) {
		static TTM_ACTIVATE := 0x0401
		if (!this.hTip) {
			return false
		}
		DllCall("SendMessage", "Ptr", this.hTip, "Int", TTM_ACTIVATE, "Ptr", !mode, "Ptr", 0)
		return true
	}
	update(hCtrl, tipText) {
		static TTM_UPDATETIPTEXT := A_IsUnicode ? 0x0439 : 0x040C ; TTM_UPDATETIPTEXTW : TTM_UPDATETIPTEXTA
		if (!this.ctrls.HasKey(hCtrl)) {
			return false
		}
		toolInfo := ""
		this.SetToolInfo(toolInfo, hCtrl, &tipText)
		DllCall("SendMessage", "Ptr", this.hTip, "Int", TTM_UPDATETIPTEXT, "Ptr", 0, "Ptr", &toolInfo)
		return true
	}
}

class Template extends BaseProperty {
	_append := ""
	_cutLeft := 0
	_cutRight := 0
	_eol := "`r`n"
	_keys := ""
	_linePrefix := ""
	_lineSuffix := ""
	_prepend := ""
	_text := ""
	_tokens := ""
	_trimLeft := false
	_trimRight := false

	append(value:="") {
		this.setValue(value)
		return this
	}
	cutLeft(value:=0) {
		this.setNumber(value)
		return this
	}
	cutRight(value:=0) {
		this.setNumber(value)
		return this
	}
	delay(value:="deprecated") {
		deprecatedFunc()
		return this
	}
	eol(value:="`r`n") {
		this.setValue(value)
		return this
	}
	keys(value:="") {
		this.setValue(value)
		return this
	}
	linePrefix(value:="") {
		this.setValue(value)
		return this
	}
	lineSuffix(value:="") {
		this.setValue(value)
		return this
	}
	prepend(value:="") {
		this.setValue(value)
		return this
	}
	text(value:="") {
		this.setValue(value)
		return this
	}
	tokens(value:="") {
		this.setValue(value)
		return this
	}
	trimLeft(value:=true) {
		this.setBoolean(value)
		return this
	}
	trimRight(value:=true) {
		this.setBoolean(value)
		return this
	}
}
